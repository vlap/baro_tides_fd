[H[2JSaving data as 2012_11_24__16_40
Loading topography file:  done.
Interpolating topo to  7.50 min resolution global grid:  done.
****** Ocean is in the first/last tau index of H_hg. Removed ******
Removing bays and inlets: 4022 + 767 + 266 + 101 + 34 + 13 + 8 + 3 + 2 + 0.
Removing inland seas/lakes: found 143 connected components; removed 139 of size < 288 cells.
Smoothing topography for the linear ITD scheme: Loading topography file: At line 1125 of file src/misc/save_load.f90 (unit = 10, file = '')
Fortran runtime error: File '/home/amt6/amtvl/Desktop/scratch/Tides/data/LAG/baro_fd/in/topo/nocs/smoothed_t1_trunc180_topo_rot_2.0min_pole_15_-40.dat' does not exist

Backtrace for this error:
  + function __save_load_MOD_load_alloc_topo_real (0x4DE58C)
    at line 1127 of file save_load.f90
  + function __generate_grid_MOD_generate_global_grid (0x487189)
    at line 128 of file generate_global_grid.f90
  + in the main program
    at line 79 of file baro_v1.f90
  + /lib64/libc.so.6(__libc_start_main+0xfd) [0x3c4081ecdd]
[H[2JSaving data as 2012_11_24__22_12
Loading topography file:  done.
Interpolating topo to  7.50 min resolution global grid:  done.
****** Ocean is in the first/last tau index of H_hg. Removed ******
Removing bays and inlets: 4022 + 767 + 266 + 101 + 34 + 13 + 8 + 3 + 2 + 0.
Removing inland seas/lakes: found 143 connected components; removed 139 of size < 288 cells.
Smoothing topography for the linear ITD scheme: Loading topography file:  done.
done (CPU: 2.278, Wall: 6.037)
Allocating grid points: 5217987 for u, 5218301 for v, 5194418  for h.
Making vectors: tau, H, evaluating on the u-, v-, h-grid (CPU: 1.1s, Wall:1.1s)
Making matrices:
 - d/dph and 1 for h-grid functions, evaluating on the u-grid (CPU: 0.7s, Wall:0.7s)
 - d/dta and 1 for h grid functions, evaluating on the v-grid (CPU: 0.6s, Wall:0.6s)
 - d/dph and 1 for u-grid functions, evaluating on the h-grid (CPU: 0.7s, Wall:0.7s)
 - d/dta and 1 for v-grid functions, evaluating on the h-grid (CPU: 0.7s, Wall:0.7s)
 - v & fv,     			     evaluating on the u-grid (CPU: 4.4s, Wall:4.4s)
 - u & fu,     			     evaluating on the v-grid (CPU: 4.5s, Wall:4.5s)
Saving matrices: done.
Preparing matrices: GHU, GHV, KU, KV, v2uf, u2vf, Linear BBL, Linear ITD (1 matrix per constituent), b.c.  Done.
====================================
Welcome to baro_solver (nonlinear)
====================================
==============
 Iteration 1
==============
Have [1.56E+07 x 1.56E+07] sparse matrix (nnz = 9.85E+07). Solve with pardiso.
 1. for m2: assembling the matrix and rhs, implementing b.c. 
   a) Reordering... done (peak-12.0Gb; permanent-10.0Gb) 
      Size of matrix factors 25.5Gb > 18.0Gb RAM+Swap. Running out-of-core with peak memory usage: 12.0Gb. 
   b) Factorization... done (8.2Gb).    c) Solve... done (CPU: 2:01:05, Wall: 36:47.888)
 2. for k1: assembling the matrix and rhs, implementing b.c. 
   b) Factorization... done (8.2Gb).    c) Solve... done (CPU: 1:27:23, Wall: 20:41.046)
	-----------------------------------------------------------
	 | Convg |   du   |   dv   |  duv%  |  dh  | dhbar |  dh%  | 	
	 | ----- | ------ | ------ | ------ | ---- | ----- | ----- |  
	 | m2    | 893.18 | 587.05 | 59.717 | 7.00 | 0.533 | 0.533 |  
	 | k1    | 581.15 | 512.75 | 13.193 | 3.65 | 0.120 | 0.120 |  
	-----------------------------------------------------------
 
Calculate hsal and beta. 
   a) Interpolate h to the reg [1440 x 720] lat-lon grid...   done (CPU: 0.38184, Wall: 0.382)
   b) Spherical harmonic analysis... done (CPU: 4.8086, Wall: 4.86)
   c) Spherical harmonic synthesis... done (CPU: 2.583, Wall: 2.67)
   d) Interpolate hsal onto the original grid... done (CPU: 0.72168, Wall: 1.349)
   e) Calculate beta (averaged over 5ยบ)... matgen   done (CPU: 0.64063, Wall: 1.135)
   e) coo_mat_mul 5ยบ)...   done (CPU: 147.59, Wall: 147.61)
done (CPU: 157.82, Wall: 160.05)
   a) Interpolate h to the reg [1440 x 720] lat-lon grid...   done (CPU: 0.38379, Wall: 0.384)
   b) Spherical harmonic analysis... done (CPU: 0.96875, Wall: 0.969)
   c) Spherical harmonic synthesis... done (CPU: 1.1133, Wall: 1.113)
   d) Interpolate hsal onto the original grid... done (CPU: 0.71875, Wall: 0.755)
   e) Calculate beta (averaged over 5ยบ)... matgen   done (CPU: 0.59668, Wall: 0.597)
   e) coo_mat_mul 5ยบ)...   done (CPU: 147.52, Wall: 147.53)
done (CPU: 152.37, Wall: 152.42)
  Welcome to calc_dhat: Projecting: ******** done (CPU: 1:18.287, Wall: 1:18.385)
  Storing: ** done (CPU: 2.765, Wall: 3.398)
===>>> Total time spent on Iteration 1:  3:36:37 CPU,  1:06:03  Wall
==============
 Iteration 2
==============
 1. for m2: assembling the matrix and rhs, implementing b.c. 
   b) Factorization... done (8.2Gb).    c) Solve... done (CPU: 1:26:18, Wall: 20:29.907)
 2. for k1: assembling the matrix and rhs, implementing b.c. 
   b) Factorization... done (8.2Gb).    c) Solve... done (CPU: 1:26:50, Wall: 20:46.102)
	-----------------------------------------------------------
	 | Convg |   du   |   dv   |  duv% |  dh  | dhbar |  dh%  | 	
	 | ----- | ------ | ------ | ----- | ---- | ----- | ----- |  
	 | m2    |  67.81 | 107.33 | 3.742 | 4.60 | 0.083 | 2.291 |  
	 | k1    | 173.10 | 193.42 | 1.100 | 1.28 | 0.021 | 0.553 |  
	-----------------------------------------------------------
 
Calculate hsal and beta. 
   a) Interpolate h to the reg [1440 x 720] lat-lon grid...   done (CPU: 0.38281, Wall: 0.398)
   b) Spherical harmonic analysis... done (CPU: 1.6133, Wall: 9.22)
   c) Spherical harmonic synthesis... done (CPU: 1.7324, Wall: 10.943)
   d) Interpolate hsal onto the original grid... done (CPU: 0.71484, Wall: 0.75)
   e) Calculate beta (averaged over 5ยบ)... matgen   done (CPU: 0.62695, Wall: 1.139)
   e) coo_mat_mul 5ยบ)...   done (CPU: 147.7, Wall: 147.82)
done (CPU: 153.87, Wall: 172.58)
   a) Interpolate h to the reg [1440 x 720] lat-lon grid...   done (CPU: 0.38086, Wall: 0.382)
   b) Spherical harmonic analysis... done (CPU: 0.96875, Wall: 0.97)
   c) Spherical harmonic synthesis... done (CPU: 1.1016, Wall: 1.102)
   d) Interpolate hsal onto the original grid... done (CPU: 0.71289, Wall: 0.715)
   e) Calculate beta (averaged over 5ยบ)... matgen   done (CPU: 0.59375, Wall: 0.6)
   e) coo_mat_mul 5ยบ)...   done (CPU: 147.78, Wall: 148.02)
done (CPU: 152.6, Wall: 152.85)
  Welcome to calc_dhat: Projecting: ******** done (CPU: 1:18.314, Wall: 1:18.389)
  Storing: ** done (CPU: 3.925, Wall: 10.715)
===>>> Total time spent on Iteration 2:  3:01:17 CPU, 51:01.620  Wall
==============
 Iteration 3
==============
 1. for m2: assembling the matrix and rhs, implementing b.c. 
   b) Factorization... done (8.2Gb).    c) Solve... done (CPU: 1:33:47, Wall: 21:56.397)
 2. for k1: assembling the matrix and rhs, implementing b.c. 
   b) Factorization... done (8.2Gb).    c) Solve... done (CPU: 1:37:27, Wall: 22:37.723)
	-----------------------------------------------------------
	 | Convg |   du  |   dv  |  duv% |  dh  | dhbar |  dh%  | 	
	 | ----- | ----- | ----- | ----- | ---- | ----- | ----- |  
	 | m2    | 43.78 | 34.88 | 0.084 | 2.01 | 0.027 | 0.075 |  
	 | k1    | 52.19 | 58.62 | 0.082 | 0.50 | 0.007 | 0.077 |  
	-----------------------------------------------------------
 
Calculate hsal and beta. 
   a) Interpolate h to the reg [1440 x 720] lat-lon grid...   done (CPU: 0.39063, Wall: 0.397)
   b) Spherical harmonic analysis... done (CPU: 1.625, Wall: 9.194)
   c) Spherical harmonic synthesis... done (CPU: 1.7188, Wall: 12.927)
   d) Interpolate hsal onto the original grid... done (CPU: 0.73828, Wall: 0.767)
   e) Calculate beta (averaged over 5ยบ)... matgen   done (CPU: 0.65625, Wall: 1.144)
   e) coo_mat_mul 5ยบ)...   done (CPU: 150.46, Wall: 150.77)
done (CPU: 156.72, Wall: 177.14)
   a) Interpolate h to the reg [1440 x 720] lat-lon grid...   done (CPU: 0.38672, Wall: 0.394)
   b) Spherical harmonic analysis... done (CPU: 0.98828, Wall: 0.999)
   c) Spherical harmonic synthesis... done (CPU: 1.1406, Wall: 1.157)
   d) Interpolate hsal onto the original grid... done (CPU: 0.73828, Wall: 0.748)
   e) Calculate beta (averaged over 5ยบ)... matgen   done (CPU: 0.61719, Wall: 0.621)
   e) coo_mat_mul 5ยบ)...   done (CPU: 147.74, Wall: 147.84)
done (CPU: 152.68, Wall: 152.84)
  Welcome to calc_dhat: Projecting: ******** done (CPU: 1:18.101, Wall: 1:18.195)
  Storing: ** done (CPU: 3.933, Wall: 10.734)
===>>> Total time spent on Iteration 3:  3:19:23 CPU, 54:12.620  Wall
==============
 Iteration 4
==============
 1. for m2: assembling the matrix and rhs, implementing b.c. 
   b) Factorization... done (8.2Gb).    c) Solve... done (CPU: 1:25:28, Wall: 20:54.048)
 2. for k1: assembling the matrix and rhs, implementing b.c. 
   b) Factorization... done (8.2Gb).    c) Solve... done (CPU: 1:44:17, Wall: 28:43.229)
	-----------------------------------------------------------
	 | Convg |   du  |   dv  |  duv% |  dh  | dhbar |  dh%  | 	
	 | ----- | ----- | ----- | ----- | ---- | ----- | ----- |  
	 | m2    | 18.45 | 14.19 | 0.042 | 0.81 | 0.013 | 0.038 |  
	 | k1    | 18.22 | 20.63 | 0.038 | 0.17 | 0.003 | 0.034 |  
	-----------------------------------------------------------
 
Calculate hsal and beta. 
   a) Interpolate h to the reg [1440 x 720] lat-lon grid...   done (CPU: 0.37891, Wall: 0.393)
   b) Spherical harmonic analysis... done (CPU: 1.625, Wall: 9.146)
   c) Spherical harmonic synthesis... done (CPU: 1.7383, Wall: 12.835)
   d) Interpolate hsal onto the original grid... done (CPU: 0.71484, Wall: 0.727)
   e) Calculate beta (averaged over 5ยบ)... matgen   done (CPU: 0.62109, Wall: 1.125)
   e) coo_mat_mul 5ยบ)...   done (CPU: 147.18, Wall: 147.21)
done (CPU: 153.36, Wall: 173.23)
   a) Interpolate h to the reg [1440 x 720] lat-lon grid...   done (CPU: 0.37891, Wall: 0.38)
   b) Spherical harmonic analysis... done (CPU: 0.96484, Wall: 0.966)
   c) Spherical harmonic synthesis... done (CPU: 1.0742, Wall: 1.072)
   d) Interpolate hsal onto the original grid... done (CPU: 0.71875, Wall: 0.72)
   e) Calculate beta (averaged over 5ยบ)... matgen   done (CPU: 0.59375, Wall: 0.594)
   e) coo_mat_mul 5ยบ)...   done (CPU: 146.94, Wall: 146.95)
done (CPU: 151.73, Wall: 151.75)
  Welcome to calc_dhat: Projecting: ******** done (CPU: 1:18.191, Wall: 1:18.211)
  Storing: ** done (CPU: 4.125, Wall: 10.652)
===>>> Total time spent on Iteration 4:  3:17:51 CPU, 59:06.787  Wall
==============
 Iteration 5
==============
 1. for m2: assembling the matrix and rhs, implementing b.c. 
   b) Factorization... done (8.2Gb).    c) Solve... done (CPU: 1:27:46, Wall: 21:30.897)
 2. for k1: assembling the matrix and rhs, implementing b.c. 
   b) Factorization... done (8.2Gb).    c) Solve... done (CPU: 1:25:54, Wall: 21:22.459)
	-----------------------------------------------------------
	 | Convg |  du  |  dv  |  duv% |  dh  | dhbar |  dh%  | 	
	 | ----- | ---- | ---- | ----- | ---- | ----- | ----- |  
	 | m2    | 7.51 | 6.82 | 0.021 | 0.42 | 0.006 | 0.020 |  
	 | k1    | 7.76 | 8.21 | 0.020 | 0.07 | 0.001 | 0.018 |  
	-----------------------------------------------------------
 
Calculate hsal and beta. 
   a) Interpolate h to the reg [1440 x 720] lat-lon grid...   done (CPU: 0.38281, Wall: 0.382)
   b) Spherical harmonic analysis... done (CPU: 1.5703, Wall: 9.138)
   c) Spherical harmonic synthesis... done (CPU: 1.7344, Wall: 10.521)
   d) Interpolate hsal onto the original grid... done (CPU: 0.71484, Wall: 0.717)
   e) Calculate beta (averaged over 5ยบ)... matgen   done (CPU: 0.61328, Wall: 1.928)
   e) coo_mat_mul 5ยบ)...   done (CPU: 146.91, Wall: 147.11)
done (CPU: 153.02, Wall: 171.55)
   a) Interpolate h to the reg [1440 x 720] lat-lon grid...   done (CPU: 0.37891, Wall: 0.381)
   b) Spherical harmonic analysis... done (CPU: 0.96875, Wall: 0.97)
   c) Spherical harmonic synthesis... done (CPU: 1.1289, Wall: 1.132)
   d) Interpolate hsal onto the original grid... done (CPU: 0.71484, Wall: 0.714)
   e) Calculate beta (averaged over 5ยบ)... matgen   done (CPU: 0.59375, Wall: 0.592)
   e) coo_mat_mul 5ยบ)...   done (CPU: 146.87, Wall: 147.07)
done (CPU: 151.72, Wall: 151.92)
  Welcome to calc_dhat: Projecting: ******** done (CPU: 1:18.167, Wall: 1:18.289)
  Storing: ** done (CPU: 3.843, Wall: 10.630)
===>>> Total time spent on Iteration 5:  3:01:41 CPU, 52:19.301  Wall
==============
 Iteration 6
==============
 1. for m2: assembling the matrix and rhs, implementing b.c. 
   b) Factorization... done (8.2Gb).    c) Solve... done (CPU: 1:27:11, Wall: 21:51.937)
 2. for k1: assembling the matrix and rhs, implementing b.c. 
   b) Factorization... done (8.2Gb).    c) Solve... done (CPU: 1:29:36, Wall: 22:56.741)
	-----------------------------------------------------------
	 | Convg |  du  |  dv  |  duv% |  dh  | dhbar |  dh%  | 	
	 | ----- | ---- | ---- | ----- | ---- | ----- | ----- |  
	 | m2    | 3.51 | 3.97 | 0.010 | 0.22 | 0.003 | 0.010 |  
	 | k1    | 3.59 | 3.52 | 0.010 | 0.04 | 0.001 | 0.008 |  
	-----------------------------------------------------------
 
Calculate hsal and beta. 
   a) Interpolate h to the reg [1440 x 720] lat-lon grid...   done (CPU: 0.375, Wall: 0.381)
   b) Spherical harmonic analysis... done (CPU: 1.6094, Wall: 9.157)
   c) Spherical harmonic synthesis... done (CPU: 1.6797, Wall: 9.448)
   d) Interpolate hsal onto the original grid... done (CPU: 0.71875, Wall: 0.716)
   e) Calculate beta (averaged over 5ยบ)... matgen   done (CPU: 0.61719, Wall: 1.832)
   e) coo_mat_mul 5ยบ)...   done (CPU: 146.52, Wall: 146.64)
done (CPU: 152.62, Wall: 169.91)
   a) Interpolate h to the reg [1440 x 720] lat-lon grid...   done (CPU: 0.375, Wall: 0.379)
   b) Spherical harmonic analysis... done (CPU: 0.96875, Wall: 0.973)
   c) Spherical harmonic synthesis... done (CPU: 1.1172, Wall: 1.123)
   d) Interpolate hsal onto the original grid... done (CPU: 0.71094, Wall: 0.715)
   e) Calculate beta (averaged over 5ยบ)... matgen   done (CPU: 0.58594, Wall: 0.592)
   e) coo_mat_mul 5ยบ)...   done (CPU: 146.92, Wall: 146.99)
done (CPU: 151.76, Wall: 151.83)
  Welcome to calc_dhat: Projecting: ******** done (CPU: 1:18.117, Wall: 1:18.203)
  Storing: ** done (CPU: 4.140, Wall: 10.666)
===>>> Total time spent on Iteration 6:  3:04:47 CPU, 54:04.843  Wall
==============
 Iteration 7
==============
 1. for m2: assembling the matrix and rhs, implementing b.c. 
   b) Factorization... done (8.2Gb).    c) Solve... done (CPU: 1:30:15, Wall: 23:42.663)
 2. for k1: assembling the matrix and rhs, implementing b.c. 
   b) Factorization... done (8.2Gb).    c) Solve... done (CPU: 1:32:34, Wall: 24:36.873)
	-----------------------------------------------------------
	 | Convg |  du  |  dv  |  duv% |  dh  | dhbar |  dh%  | 	
	 | ----- | ---- | ---- | ----- | ---- | ----- | ----- |  
	 | m2    | 1.88 | 2.21 | 0.005 | 0.09 | 0.001 | 0.005 |  
	 | k1    | 2.09 | 3.63 | 0.005 | 0.02 | 0.000 | 0.004 |  
	-----------------------------------------------------------
 
Calculate hsal and beta. 
   a) Interpolate h to the reg [1440 x 720] lat-lon grid...   done (CPU: 0.375, Wall: 0.38)
   b) Spherical harmonic analysis... done (CPU: 1.5547, Wall: 9.221)
   c) Spherical harmonic synthesis... done (CPU: 1.7344, Wall: 9.472)
   d) Interpolate hsal onto the original grid... done (CPU: 0.71094, Wall: 0.715)
   e) Calculate beta (averaged over 5ยบ)... matgen   done (CPU: 0.61719, Wall: 2.021)
   e) coo_mat_mul 5ยบ)...   done (CPU: 146.89, Wall: 147.03)
done (CPU: 152.99, Wall: 170.59)
   a) Interpolate h to the reg [1440 x 720] lat-lon grid...   done (CPU: 0.38281, Wall: 0.38)
   b) Spherical harmonic analysis... done (CPU: 0.96094, Wall: 0.962)
   c) Spherical harmonic synthesis... done (CPU: 1.0625, Wall: 1.062)
   d) Interpolate hsal onto the original grid... done (CPU: 0.71094, Wall: 0.718)
   e) Calculate beta (averaged over 5ยบ)... matgen   done (CPU: 0.58594, Wall: 0.591)
   e) coo_mat_mul 5ยบ)...   done (CPU: 146.88, Wall: 146.96)
done (CPU: 151.66, Wall: 151.74)
  Welcome to calc_dhat: Projecting: ******** done (CPU: 1:18.070, Wall: 1:18.216)
  Storing: ** done (CPU: 3.414, Wall: 10.774)
===>>> Total time spent on Iteration 7:  3:10:45 CPU, 57:35.241  Wall
========================================================================
========================================================================
 
===>>> Total time spent on solving the system: 22:32:25 CPU, 6:34:23  Wall
 
-----------------------------------------------------------------------------
m2:	KE = 363.1 PJ, PE = 321.9 PJ, D = 3.318 TW.
	D_BL = 2.741 TW, D_IT = 0.566 TW, D_SAL = -0.154 GW, D_f = -0.000 GW.
	---------------------------------------------------------------------
	 | **** | Total | Shallow |  Deep | Coastal |  Open | 	
	 | ---- | ----- | ------- | ----- | ------- | ----- |  
	 | D_BL | 2.741 |  2.723  | 0.018 |  2.712  | 0.029 |  
	 | D_IT | 0.566 |  0.353  | 0.213 |  0.449  | 0.117 |  
	 | D    | 3.307 |  3.076  | 0.231 |  3.161  | 0.146 |  
-----------------------------------------------------------------------------
k1:	KE = 41.0 PJ, PE = 24.0 PJ, D = 0.322 TW.
	D_BL = 0.266 TW, D_IT = 0.055 TW, D_SAL = -0.017 GW, D_f = -0.000 GW.
	---------------------------------------------------------------------
	 | **** | Total | Shallow |  Deep | Coastal |  Open | 	
	 | ---- | ----- | ------- | ----- | ------- | ----- |  
	 | D_BL | 0.266 |  0.264  | 0.003 |  0.257  | 0.010 |  
	 | D_IT | 0.055 |  0.029  | 0.026 |  0.044  | 0.011 |  
	 | D    | 0.322 |  0.293  | 0.029 |  0.301  | 0.021 |  
Cleaning up temporary files 
[H[2JSaving data as 2012_11_26__01_00
Loading topography file:  done.
Interpolating topo to  7.50 min resolution global grid:  done.
****** Ocean is in the first/last tau index of H_hg. Removed ******
Removing bays and inlets: 4022 + 767 + 266 + 101 + 34 + 13 + 8 + 3 + 2 + 0.
Removing inland seas/lakes: found 143 connected components; removed 139 of size < 288 cells.
Allocating grid points: 5217987 for u, 5218301 for v, 5194418  for h.
Making vectors: tau, H, evaluating on the u-, v-, h-grid (CPU: 0.9s, Wall:0.9s)
Making matrices:
 - d/dph and 1 for h-grid functions, evaluating on the u-grid (CPU: 0.7s, Wall:0.7s)
 - d/dta and 1 for h grid functions, evaluating on the v-grid (CPU: 0.6s, Wall:0.6s)
 - d/dph and 1 for u-grid functions, evaluating on the h-grid (CPU: 0.7s, Wall:0.7s)
 - d/dta and 1 for v-grid functions, evaluating on the h-grid (CPU: 0.7s, Wall:0.7s)
 - v & fv,     			     evaluating on the u-grid (CPU: 4.3s, Wall:4.3s)
 - u & fu,     			     evaluating on the v-grid (CPU: 4.4s, Wall:4.4s)
Saving matrices: done.
Preparing matrices: GHU, GHV, KU, KV, v2uf, u2vf, Linear BBL, Linear ITD (1 matrix per constituent), b.c.  Done.
====================================
Welcome to baro_solver (nonlinear)
====================================
==============
 Iteration 1
==============
Have [1.56E+07 x 1.56E+07] sparse matrix (nnz = 9.85E+07). Solve with pardiso.
 1. for m2: assembling the matrix and rhs, implementing b.c. 
   a) Reordering... done (peak-12.0Gb; permanent-10.0Gb) 
      Size of matrix factors 25.4Gb > 20.0Gb RAM+Swap. Running out-of-core with peak memory usage: 12.0Gb. 
   b) Factorization... done (10.2Gb).    c) Solve... done (CPU: 1:59:35, Wall: 44:14.112)
 2. for k1: assembling the matrix and rhs, implementing b.c. 
   b) Factorization... done (10.2Gb).    c) Solve... done (CPU: 1:29:06, Wall: 19:43.735)
	-----------------------------------------------------------
	 | Convg |   du   |   dv   |  duv%  |  dh  | dhbar |  dh%  | 	
	 | ----- | ------ | ------ | ------ | ---- | ----- | ----- |  
	 | m2    | 582.35 | 394.19 | 40.922 | 4.45 | 0.351 | 0.351 |  
	 | k1    | 555.12 | 566.32 | 11.443 | 3.33 | 0.102 | 0.102 |  
	-----------------------------------------------------------
 
Calculate hsal and beta. 
   a) Interpolate h to the reg [1440 x 720] lat-lon grid...   done (CPU: 0.38184, Wall: 0.382)
   b) Spherical harmonic analysis... done (CPU: 4.7803, Wall: 4.831)
   c) Spherical harmonic synthesis... done (CPU: 2.5371, Wall: 2.538)
   d) Interpolate hsal onto the original grid... done (CPU: 0.71387, Wall: 0.758)
   e) Calculate beta (averaged over 5ยบ)... matgen   done (CPU: 0.61621, Wall: 1.118)
   e) coo_mat_mul 5ยบ)...   done (CPU: 147.44, Wall: 147.48)
done (CPU: 157.58, Wall: 158.89)
   a) Interpolate h to the reg [1440 x 720] lat-lon grid...   done (CPU: 0.38281, Wall: 0.383)
   b) Spherical harmonic analysis... done (CPU: 0.9502, Wall: 0.952)
   c) Spherical harmonic synthesis... done (CPU: 1.123, Wall: 1.123)
   d) Interpolate hsal onto the original grid... done (CPU: 0.71484, Wall: 0.743)
   e) Calculate beta (averaged over 5ยบ)... matgen   done (CPU: 0.59473, Wall: 0.594)
   e) coo_mat_mul 5ยบ)...   done (CPU: 147.21, Wall: 147.23)
done (CPU: 152.04, Wall: 152.1)
  Welcome to calc_dhat: Projecting: ******** done (CPU: 1:18.038, Wall: 1:18.072)
  Storing: ** done (CPU: 2.777, Wall: 3.395)
===>>> Total time spent on Iteration 1:  3:36:51 CPU,  1:13:21  Wall
==============
 Iteration 2
==============
 1. for m2: assembling the matrix and rhs, implementing b.c. 
   b) Factorization... done (10.2Gb).    c) Solve... done (CPU: 1:24:56, Wall: 19:17.642)
 2. for k1: assembling the matrix and rhs, implementing b.c. 
   b) Factorization... done (10.2Gb).    c) Solve... done (CPU: 1:23:19, Wall: 19:11.506)
	-----------------------------------------------------------
	 | Convg |   du   |   dv   |  duv% |  dh  | dhbar |  dh%  | 	
	 | ----- | ------ | ------ | ----- | ---- | ----- | ----- |  
	 | m2    |  61.79 |  88.03 | 3.516 | 4.58 | 0.048 | 2.354 |  
	 | k1    | 189.96 | 212.64 | 1.533 | 1.21 | 0.016 | 0.747 |  
	-----------------------------------------------------------
 
Calculate hsal and beta. 
   a) Interpolate h to the reg [1440 x 720] lat-lon grid...   done (CPU: 0.39648, Wall: 0.773)
   b) Spherical harmonic analysis... done (CPU: 1.4844, Wall: 8.117)
   c) Spherical harmonic synthesis... done (CPU: 1.7773, Wall: 8.306)
   d) Interpolate hsal onto the original grid... done (CPU: 0.71289, Wall: 0.747)
   e) Calculate beta (averaged over 5ยบ)... matgen   done (CPU: 0.61523, Wall: 1.735)
   e) coo_mat_mul 5ยบ)...   done (CPU: 147.34, Wall: 147.42)
done (CPU: 153.44, Wall: 169.16)
   a) Interpolate h to the reg [1440 x 720] lat-lon grid...   done (CPU: 0.38281, Wall: 0.383)
   b) Spherical harmonic analysis... done (CPU: 0.95313, Wall: 0.952)
   c) Spherical harmonic synthesis... done (CPU: 1.1172, Wall: 1.117)
   d) Interpolate hsal onto the original grid... done (CPU: 0.71484, Wall: 0.722)
   e) Calculate beta (averaged over 5ยบ)... matgen   done (CPU: 0.59375, Wall: 0.594)
   e) coo_mat_mul 5ยบ)...   done (CPU: 147.24, Wall: 147.29)
done (CPU: 152.06, Wall: 152.12)
  Welcome to calc_dhat: Projecting: ******** done (CPU: 1:17.917, Wall: 1:17.977)
  Storing: ** done (CPU: 3.681, Wall: 10.237)
===>>> Total time spent on Iteration 2:  2:56:07 CPU, 47:32.773  Wall
==============
 Iteration 3
==============
 1. for m2: assembling the matrix and rhs, implementing b.c. 
   b) Factorization... done (10.2Gb).    c) Solve... done (CPU: 1:25:35, Wall: 19:19.431)
 2. for k1: assembling the matrix and rhs, implementing b.c. 
   b) Factorization... done (10.2Gb).    c) Solve... done (CPU: 1:23:42, Wall: 19:22.788)
	-----------------------------------------------------------
	 | Convg |   du  |   dv  |  duv% |  dh  | dhbar |  dh%  | 	
	 | ----- | ----- | ----- | ----- | ---- | ----- | ----- |  
	 | m2    | 25.01 | 40.84 | 0.091 | 2.07 | 0.020 | 0.081 |  
	 | k1    | 59.43 | 66.91 | 0.087 | 0.49 | 0.006 | 0.082 |  
	-----------------------------------------------------------
 
Calculate hsal and beta. 
   a) Interpolate h to the reg [1440 x 720] lat-lon grid...   done (CPU: 0.38672, Wall: 0.539)
   b) Spherical harmonic analysis... done (CPU: 1.6328, Wall: 8.083)
   c) Spherical harmonic synthesis... done (CPU: 1.7305, Wall: 9.48)
   d) Interpolate hsal onto the original grid... done (CPU: 0.71094, Wall: 0.741)
   e) Calculate beta (averaged over 5ยบ)... matgen   done (CPU: 0.62109, Wall: 1.127)
   e) coo_mat_mul 5ยบ)...   done (CPU: 147.23, Wall: 147.26)
done (CPU: 153.42, Wall: 169.06)
   a) Interpolate h to the reg [1440 x 720] lat-lon grid...   done (CPU: 0.38281, Wall: 0.391)
   b) Spherical harmonic analysis... done (CPU: 0.95313, Wall: 0.97)
   c) Spherical harmonic synthesis... done (CPU: 1.0703, Wall: 1.07)
   d) Interpolate hsal onto the original grid... done (CPU: 0.71484, Wall: 0.738)
   e) Calculate beta (averaged over 5ยบ)... matgen   done (CPU: 0.59375, Wall: 0.592)
   e) coo_mat_mul 5ยบ)...   done (CPU: 147.3, Wall: 147.32)
done (CPU: 152.08, Wall: 152.16)
  Welcome to calc_dhat: Projecting: ******** done (CPU: 1:17.957, Wall: 1:18.028)
  Storing: ** done (CPU: 3.578, Wall: 10.286)
===>>> Total time spent on Iteration 3:  2:57:08 CPU, 47:39.079  Wall
==============
 Iteration 4
==============
 1. for m2: assembling the matrix and rhs, implementing b.c. 
   b) Factorization... done (10.2Gb).    c) Solve... done (CPU: 1:23:36, Wall: 19:26.307)
 2. for k1: assembling the matrix and rhs, implementing b.c. 
   b) Factorization... done (10.2Gb).    c) Solve... done (CPU: 1:23:37, Wall: 19:29.057)
	-----------------------------------------------------------
	 | Convg |   du  |   dv  |  duv% |  dh  | dhbar |  dh%  | 	
	 | ----- | ----- | ----- | ----- | ---- | ----- | ----- |  
	 | m2    | 11.75 | 17.75 | 0.042 | 0.89 | 0.009 | 0.038 |  
	 | k1    | 20.01 | 22.82 | 0.040 | 0.19 | 0.003 | 0.035 |  
	-----------------------------------------------------------
 
Calculate hsal and beta. 
   a) Interpolate h to the reg [1440 x 720] lat-lon grid...   done (CPU: 0.38281, Wall: 0.402)
   b) Spherical harmonic analysis... done (CPU: 1.7266, Wall: 8.092)
   c) Spherical harmonic synthesis... done (CPU: 1.6367, Wall: 8.733)
   d) Interpolate hsal onto the original grid... done (CPU: 0.71484, Wall: 0.742)
   e) Calculate beta (averaged over 5ยบ)... matgen   done (CPU: 0.62109, Wall: 1.137)
   e) coo_mat_mul 5ยบ)...   done (CPU: 147.28, Wall: 147.33)
done (CPU: 153.44, Wall: 168.26)
   a) Interpolate h to the reg [1440 x 720] lat-lon grid...   done (CPU: 0.38281, Wall: 0.383)
   b) Spherical harmonic analysis... done (CPU: 0.95313, Wall: 0.952)
   c) Spherical harmonic synthesis... done (CPU: 1.1289, Wall: 1.132)
   d) Interpolate hsal onto the original grid... done (CPU: 0.71484, Wall: 0.722)
   e) Calculate beta (averaged over 5ยบ)... matgen   done (CPU: 0.58984, Wall: 0.592)
   e) coo_mat_mul 5ยบ)...   done (CPU: 147.25, Wall: 147.27)
done (CPU: 152.09, Wall: 152.11)
  Welcome to calc_dhat: Projecting: ******** done (CPU: 1:17.964, Wall: 1:18.059)
  Storing: ** done (CPU: 3.531, Wall: 10.289)
===>>> Total time spent on Iteration 4:  2:55:03 CPU, 47:52.642  Wall
==============
 Iteration 5
==============
 1. for m2: assembling the matrix and rhs, implementing b.c. 
   b) Factorization... done (10.2Gb).    c) Solve... done (CPU: 1:25:25, Wall: 19:47.755)
 2. for k1: assembling the matrix and rhs, implementing b.c. 
   b) Factorization... done (10.2Gb).    c) Solve... done (CPU: 1:24:01, Wall: 19:46.692)
	-----------------------------------------------------------
	 | Convg |  du  |  dv  |  duv% |  dh  | dhbar |  dh%  | 	
	 | ----- | ---- | ---- | ----- | ---- | ----- | ----- |  
	 | m2    | 5.30 | 6.47 | 0.021 | 0.42 | 0.004 | 0.019 |  
	 | k1    | 7.91 | 8.77 | 0.020 | 0.09 | 0.001 | 0.017 |  
	-----------------------------------------------------------
 
Calculate hsal and beta. 
   a) Interpolate h to the reg [1440 x 720] lat-lon grid...   done (CPU: 0.38281, Wall: 0.385)
   b) Spherical harmonic analysis... done (CPU: 1.5156, Wall: 8.068)
   c) Spherical harmonic synthesis... done (CPU: 1.7656, Wall: 9.341)
   d) Interpolate hsal onto the original grid... done (CPU: 0.71484, Wall: 0.735)
   e) Calculate beta (averaged over 5ยบ)... matgen   done (CPU: 0.62109, Wall: 1.125)
   e) coo_mat_mul 5ยบ)...   done (CPU: 147.29, Wall: 147.37)
done (CPU: 153.39, Wall: 168.86)
   a) Interpolate h to the reg [1440 x 720] lat-lon grid...   done (CPU: 0.38281, Wall: 0.382)
   b) Spherical harmonic analysis... done (CPU: 0.94531, Wall: 0.946)
   c) Spherical harmonic synthesis... done (CPU: 1.0664, Wall: 1.065)
   d) Interpolate hsal onto the original grid... done (CPU: 0.71875, Wall: 0.719)
   e) Calculate beta (averaged over 5ยบ)... matgen   done (CPU: 0.58984, Wall: 0.591)
   e) coo_mat_mul 5ยบ)...   done (CPU: 147.18, Wall: 147.2)
done (CPU: 151.95, Wall: 151.97)
  Welcome to calc_dhat: Projecting: ******** done (CPU: 1:17.984, Wall: 1:18.055)
  Storing: ** done (CPU: 3.433, Wall: 10.189)
===>>> Total time spent on Iteration 5:  2:57:18 CPU, 48:26.737  Wall
==============
 Iteration 6
==============
 1. for m2: assembling the matrix and rhs, implementing b.c. 
   b) Factorization... done (10.2Gb).    c) Solve... done (CPU: 1:23:59, Wall: 19:39.619)
 2. for k1: assembling the matrix and rhs, implementing b.c. 
   b) Factorization... done (10.2Gb).    c) Solve... done (CPU: 1:23:09, Wall: 19:39.631)
	-----------------------------------------------------------
	 | Convg |  du  |  dv  |  duv% |  dh  | dhbar |  dh%  | 	
	 | ----- | ---- | ---- | ----- | ---- | ----- | ----- |  
	 | m2    | 2.43 | 2.56 | 0.010 | 0.23 | 0.002 | 0.009 |  
	 | k1    | 3.87 | 3.95 | 0.011 | 0.05 | 0.001 | 0.009 |  
	-----------------------------------------------------------
 
Calculate hsal and beta. 
   a) Interpolate h to the reg [1440 x 720] lat-lon grid...   done (CPU: 0.38281, Wall: 0.386)
   b) Spherical harmonic analysis... done (CPU: 1.4297, Wall: 8.057)
   c) Spherical harmonic synthesis... done (CPU: 1.6719, Wall: 8.659)
   d) Interpolate hsal onto the original grid... done (CPU: 0.71094, Wall: 0.716)
   e) Calculate beta (averaged over 5ยบ)... matgen   done (CPU: 0.61719, Wall: 1.128)
   e) coo_mat_mul 5ยบ)...   done (CPU: 147.31, Wall: 147.35)
done (CPU: 153.23, Wall: 168.09)
   a) Interpolate h to the reg [1440 x 720] lat-lon grid...   done (CPU: 0.38281, Wall: 0.384)
   b) Spherical harmonic analysis... done (CPU: 0.95313, Wall: 0.953)
   c) Spherical harmonic synthesis... done (CPU: 1.0938, Wall: 1.093)
   d) Interpolate hsal onto the original grid... done (CPU: 0.71094, Wall: 0.715)
   e) Calculate beta (averaged over 5ยบ)... matgen   done (CPU: 0.58594, Wall: 0.591)
   e) coo_mat_mul 5ยบ)...   done (CPU: 147.17, Wall: 147.18)
done (CPU: 151.97, Wall: 151.98)
  Welcome to calc_dhat: Projecting: ******** done (CPU: 1:17.945, Wall: 1:18.028)
  Storing: ** done (CPU: 3.554, Wall: 10.293)
===>>> Total time spent on Iteration 6:  2:54:59 CPU, 48:11.502  Wall
==============
 Iteration 7
==============
 1. for m2: assembling the matrix and rhs, implementing b.c. 
   b) Factorization... done (10.2Gb).    c) Solve... done (CPU: 1:26:49, Wall: 20:20.613)
 2. for k1: assembling the matrix and rhs, implementing b.c. 
   b) Factorization... done (10.2Gb).    c) Solve... done (CPU: 1:23:44, Wall: 19:55.293)
	-----------------------------------------------------------
	 | Convg |  du  |  dv  |  duv% |  dh  | dhbar |  dh%  | 	
	 | ----- | ---- | ---- | ----- | ---- | ----- | ----- |  
	 | m2    | 1.14 | 1.15 | 0.005 | 0.11 | 0.001 | 0.004 |  
	 | k1    | 1.89 | 1.94 | 0.005 | 0.02 | 0.000 | 0.005 |  
	-----------------------------------------------------------
 
Calculate hsal and beta. 
   a) Interpolate h to the reg [1440 x 720] lat-lon grid...   done (CPU: 0.38281, Wall: 0.385)
   b) Spherical harmonic analysis... done (CPU: 1.5234, Wall: 8.068)
   c) Spherical harmonic synthesis... done (CPU: 1.6328, Wall: 8.249)
   d) Interpolate hsal onto the original grid... done (CPU: 0.71875, Wall: 0.715)
   e) Calculate beta (averaged over 5ยบ)... matgen   done (CPU: 0.61719, Wall: 1.122)
   e) coo_mat_mul 5ยบ)...   done (CPU: 147.37, Wall: 147.39)
done (CPU: 153.33, Wall: 167.74)
   a) Interpolate h to the reg [1440 x 720] lat-lon grid...   done (CPU: 0.38281, Wall: 0.382)
   b) Spherical harmonic analysis... done (CPU: 0.95313, Wall: 0.952)
   c) Spherical harmonic synthesis... done (CPU: 1.1094, Wall: 1.114)
   d) Interpolate hsal onto the original grid... done (CPU: 0.71094, Wall: 0.715)
   e) Calculate beta (averaged over 5ยบ)... matgen   done (CPU: 0.59375, Wall: 0.592)
   e) coo_mat_mul 5ยบ)...   done (CPU: 147.27, Wall: 147.33)
done (CPU: 152.09, Wall: 152.15)
  Welcome to calc_dhat: Projecting: ******** done (CPU: 1:17.992, Wall: 1:18.045)
  Storing: ** done (CPU: 3.664, Wall: 10.135)
===>>> Total time spent on Iteration 7:  2:58:22 CPU, 49:04.737  Wall
==============
 Iteration 8
==============
 1. for m2: assembling the matrix and rhs, implementing b.c. 
   b) Factorization... done (10.2Gb).    c) Solve... done (CPU: 1:26:18, Wall: 20:21.787)
 2. for k1: assembling the matrix and rhs, implementing b.c. 
   b) Factorization... done (10.2Gb).    c) Solve... done (CPU: 1:25:00, Wall: 20:30.500)
	-----------------------------------------------------------
	 | Convg |  du  |  dv  |  duv% |  dh  | dhbar |  dh%  | 	
	 | ----- | ---- | ---- | ----- | ---- | ----- | ----- |  
	 | m2    | 0.55 | 0.63 | 0.002 | 0.05 | 0.000 | 0.002 |  
	 | k1    | 0.92 | 0.95 | 0.003 | 0.01 | 0.000 | 0.002 |  
	-----------------------------------------------------------
 
Calculate hsal and beta. 
   a) Interpolate h to the reg [1440 x 720] lat-lon grid...   done (CPU: 0.38281, Wall: 0.384)
   b) Spherical harmonic analysis... done (CPU: 1.5, Wall: 8.062)
   c) Spherical harmonic synthesis... done (CPU: 1.7266, Wall: 8.272)
   d) Interpolate hsal onto the original grid... done (CPU: 0.71875, Wall: 0.716)
   e) Calculate beta (averaged over 5ยบ)... matgen   done (CPU: 0.61719, Wall: 2.254)
   e) coo_mat_mul 5ยบ)...   done (CPU: 147.31, Wall: 147.34)
done (CPU: 153.37, Wall: 168.81)
   a) Interpolate h to the reg [1440 x 720] lat-lon grid...   done (CPU: 0.38281, Wall: 0.383)
   b) Spherical harmonic analysis... done (CPU: 0.94531, Wall: 0.952)
   c) Spherical harmonic synthesis... done (CPU: 1.0859, Wall: 1.088)
   d) Interpolate hsal onto the original grid... done (CPU: 0.71875, Wall: 0.715)
   e) Calculate beta (averaged over 5ยบ)... matgen   done (CPU: 0.59375, Wall: 0.592)
   e) coo_mat_mul 5ยบ)...   done (CPU: 147.45, Wall: 147.5)
done (CPU: 152.24, Wall: 152.29)
  Welcome to calc_dhat: Projecting: ******** done (CPU: 1:17.906, Wall: 1:17.959)
  Storing: ** done (CPU: 3.351, Wall: 10.196)
===>>> Total time spent on Iteration 8:  2:59:10 CPU, 49:46.866  Wall
========================================================================
========================================================================
 
===>>> Total time spent on solving the system: 1 d  0:15:01 CPU, 6:51:56  Wall
 
-----------------------------------------------------------------------------
m2:	KE = 179.2 PJ, PE = 152.4 PJ, D = 2.760 TW.
	D_BL = 1.260 TW, D_IT = 1.499 TW, D_SAL = -0.057 GW, D_f = 0.000 GW.
	---------------------------------------------------------------------
	 | **** | Total | Shallow |  Deep | Coastal |  Open | 	
	 | ---- | ----- | ------- | ----- | ------- | ----- |  
	 | D_BL | 1.260 |  1.254  | 0.006 |  1.248  | 0.011 |  
	 | D_IT | 1.499 |  0.233  | 1.267 |  0.630  | 0.869 |  
	 | D    | 2.759 |  1.486  | 1.272 |  1.879  | 0.880 |  
-----------------------------------------------------------------------------
k1:	KE = 34.4 PJ, PE = 19.0 PJ, D = 0.343 TW.
	D_BL = 0.193 TW, D_IT = 0.150 TW, D_SAL = -0.007 GW, D_f = 0.000 GW.
	---------------------------------------------------------------------
	 | **** | Total | Shallow |  Deep | Coastal |  Open | 	
	 | ---- | ----- | ------- | ----- | ------- | ----- |  
	 | D_BL | 0.193 |  0.191  | 0.002 |  0.186  | 0.007 |  
	 | D_IT | 0.150 |  0.018  | 0.132 |  0.069  | 0.081 |  
	 | D    | 0.343 |  0.209  | 0.134 |  0.255  | 0.088 |  
Cleaning up temporary files 
[H[2JSaving data as 2012_11_27__15_01
Loading topography file:  done.
Interpolating topo to  7.50 min resolution global grid:  done.
****** Ocean is in the first/last tau index of H_hg. Removed ******
Removing bays and inlets: 2795 + 741 + 349 + 193 + 114 + 65 + 50 + 39 + 23 + 16 + 14 + 12 + 8 + 6 + 3 + 3 + 2 + 2 + 2 + 2 + 1 + 1 + 0.
Removing inland seas/lakes: found 63 connected components; removed 61 of size < 288 cells.
Smoothing topography for the linear ITD scheme: Loading topography file:  done.
done (CPU: 1.652, Wall: 5.710)
Allocating grid points: 2714889 for u, 2723852 for v, 2704141  for h.
Making vectors: tau, H, evaluating on the u-, v-, h-grid (CPU: 0.6s, Wall:0.7s)
Making matrices:
 - d/dph and 1 for h-grid functions, evaluating on the u-grid (CPU: 0.4s, Wall:0.4s)
 - d/dta and 1 for h grid functions, evaluating on the v-grid (CPU: 0.3s, Wall:0.4s)
 - d/dph and 1 for u-grid functions, evaluating on the h-grid (CPU: 0.4s, Wall:0.4s)
 - d/dta and 1 for v-grid functions, evaluating on the h-grid (CPU: 0.3s, Wall:0.4s)
 - v & fv,     			     evaluating on the u-grid (CPU: 2.3s, Wall:2.8s)
 - u & fu,     			     evaluating on the v-grid (CPU: 2.3s, Wall:2.5s)
Saving matrices: done.
Preparing matrices: GHU, GHV, KU, KV, v2uf, u2vf, Linear BBL, Linear ITD (1 matrix per constituent), b.c.  Done.
====================================
Welcome to baro_solver (nonlinear)
====================================
==============
 Iteration 1
==============
Have [8.14E+06 x 8.14E+06] sparse matrix (nnz = 5.12E+07). Solve with pardiso.
 1. for m2: assembling the matrix and rhs, implementing b.c. 
   a) Reordering... done (peak-6.2Gb; permanent-5.2Gb) 
      Size of matrix factors 13.8Gb < 20.0Gb RAM+Swap. Running in-core with peak memory usage: 19.0Gb.
   b) Factorization... [H[2JSaving data as 2012_11_27__17_14
Loading topography file:  done.
Interpolating topo to  7.50 min resolution global grid:  done.
****** Ocean is in the first/last tau index of H_hg. Removed ******
Removing bays and inlets: 4022 + 767 + 266 + 101 + 34 + 13 + 8 + 3 + 2 + 0.
Removing inland seas/lakes: found 143 connected components; removed 139 of size < 288 cells.
Smoothing topography for the linear ITD scheme: Loading topography file:  done.
done (CPU: 2.091, Wall: 5.868)
Allocating grid points: 5217987 for u, 5218301 for v, 5194418  for h.
Making vectors: tau, H, evaluating on the u-, v-, h-grid (CPU: 1.1s, Wall:1.1s)
Making matrices:
 - d/dph and 1 for h-grid functions, evaluating on the u-grid (CPU: 0.7s, Wall:0.7s)
 - d/dta and 1 for h grid functions, evaluating on the v-grid (CPU: 0.6s, Wall:0.6s)
 - d/dph and 1 for u-grid functions, evaluating on the h-grid (CPU: 0.7s, Wall:0.7s)
 - d/dta and 1 for v-grid functions, evaluating on the h-grid (CPU: 0.7s, Wall:0.7s)
 - v & fv,     			     evaluating on the u-grid (CPU: 4.3s, Wall:4.3s)
 - u & fu,     			     evaluating on the v-grid (CPU: 4.4s, Wall:4.4s)
Saving matrices: done.
Preparing matrices: GHU, GHV, KU, KV, v2uf, u2vf, Linear BBL, Linear ITD (1 matrix per constituent), b.c.  Done.
====================================
Welcome to baro_solver (nonlinear)
====================================
==============
 Iteration 1
==============
Have [1.56E+07 x 1.56E+07] sparse matrix (nnz = 9.85E+07). Solve with pardiso.
 1. for m2: assembling the matrix and rhs, implementing b.c. 
   a) Reordering... done (peak-12.0Gb; permanent-10.0Gb) 
      Size of matrix factors 25.6Gb > 20.0Gb RAM+Swap. Running out-of-core with peak memory usage: 12.0Gb. 
   b) Factorization... done (10.2Gb).    c) Solve... done (CPU: 2:00:43, Wall: 36:12.050)
 2. for k1: assembling the matrix and rhs, implementing b.c. 
   b) Factorization... done (10.2Gb).    c) Solve... done (CPU: 1:26:28, Wall: 19:53.906)
	-----------------------------------------------------------
	 | Convg |   du   |   dv   |  duv%  |  dh  | dhbar |  dh%  | 	
	 | ----- | ------ | ------ | ------ | ---- | ----- | ----- |  
	 | m2    | 784.80 | 472.43 | 51.300 | 5.85 | 0.451 | 0.451 |  
	 | k1    | 564.66 | 541.66 | 12.196 | 3.53 | 0.110 | 0.110 |  
	-----------------------------------------------------------
 
Calculate hsal and beta. 
   a) Interpolate h to the reg [1440 x 720] lat-lon grid...   done (CPU: 0.38184, Wall: 0.381)
   b) Spherical harmonic analysis... done (CPU: 4.791, Wall: 4.866)
   c) Spherical harmonic synthesis... done (CPU: 2.5713, Wall: 2.575)
   d) Interpolate hsal onto the original grid... done (CPU: 0.71777, Wall: 0.718)
   e) Calculate beta (averaged over 5ยบ)... matgen   done (CPU: 0.6123, Wall: 1.122)
   e) coo_mat_mul 5ยบ)...   done (CPU: 147.17, Wall: 147.2)
done (CPU: 157.34, Wall: 158.65)
   a) Interpolate h to the reg [1440 x 720] lat-lon grid...   done (CPU: 0.37988, Wall: 0.38)
   b) Spherical harmonic analysis... done (CPU: 0.95117, Wall: 0.951)
   c) Spherical harmonic synthesis... done (CPU: 1.1289, Wall: 1.129)
   d) Interpolate hsal onto the original grid... done (CPU: 0.71777, Wall: 0.718)
   e) Calculate beta (averaged over 5ยบ)... matgen   done (CPU: 0.58984, Wall: 0.591)
   e) coo_mat_mul 5ยบ)...   done (CPU: 147.16, Wall: 147.25)
done (CPU: 152, Wall: 152.09)
  Welcome to calc_dhat: Projecting: ******** done (CPU: 1:18.061, Wall: 1:18.138)
  Storing: ** done (CPU: 2.749, Wall: 3.426)
===>>> Total time spent on Iteration 1:  3:35:05 CPU,  1:04:10  Wall
==============
 Iteration 2
==============
 1. for m2: assembling the matrix and rhs, implementing b.c. 
   b) Factorization... done (10.2Gb).    c) Solve... done (CPU: 1:25:24, Wall: 19:46.774)
 2. for k1: assembling the matrix and rhs, implementing b.c. 
   b) Factorization... done (10.2Gb).    c) Solve... done (CPU: 3:04:43, Wall: 42:09.287)
	-----------------------------------------------------------
	 | Convg |   du   |   dv   |  duv% |  dh  | dhbar |  dh%  | 	
	 | ----- | ------ | ------ | ----- | ---- | ----- | ----- |  
	 | m2    |  62.13 |  86.32 | 3.418 | 4.54 | 0.066 | 2.193 |  
	 | k1    | 181.93 | 203.56 | 1.173 | 1.21 | 0.019 | 0.590 |  
	-----------------------------------------------------------
 
Calculate hsal and beta. 
   a) Interpolate h to the reg [1440 x 720] lat-lon grid...   done (CPU: 0.37891, Wall: 0.396)
   b) Spherical harmonic analysis... done (CPU: 1.7207, Wall: 8.159)
   c) Spherical harmonic synthesis... done (CPU: 1.6777, Wall: 9.978)
   d) Interpolate hsal onto the original grid... done (CPU: 0.7168, Wall: 0.717)
   e) Calculate beta (averaged over 5ยบ)... matgen   done (CPU: 0.62109, Wall: 1.209)
   e) coo_mat_mul 5ยบ)...   done (CPU: 147.99, Wall: 148.03)
done (CPU: 154.21, Wall: 170.47)
   a) Interpolate h to the reg [1440 x 720] lat-lon grid...   done (CPU: 0.38086, Wall: 0.38)
   b) Spherical harmonic analysis... done (CPU: 0.95508, Wall: 0.962)
   c) Spherical harmonic synthesis... done (CPU: 1.1309, Wall: 1.13)
   d) Interpolate hsal onto the original grid... done (CPU: 0.71484, Wall: 0.715)
   e) Calculate beta (averaged over 5ยบ)... matgen   done (CPU: 0.58984, Wall: 0.59)
   e) coo_mat_mul 5ยบ)...   done (CPU: 147.63, Wall: 147.7)
done (CPU: 152.47, Wall: 152.55)
  Welcome to calc_dhat: Projecting: ******** done (CPU: 1:18.826, Wall: 1:19.018)
  Storing: ** done (CPU: 3.974, Wall: 9.994)
===>>> Total time spent on Iteration 2:  4:38:08 CPU,  1:11:10  Wall
==============
 Iteration 3
==============
 1. for m2: assembling the matrix and rhs, implementing b.c. 
   b) Factorization... done (10.2Gb).    c) Solve... done (CPU: 1:28:05, Wall: 20:26.060)
 2. for k1: assembling the matrix and rhs, implementing b.c. 
   b) Factorization... done (10.2Gb).    c) Solve... done (CPU: 2:19:49, Wall: 29:02.501)
	-----------------------------------------------------------
	 | Convg |   du  |   dv  |  duv% |  dh  | dhbar |  dh%  | 	
	 | ----- | ----- | ----- | ----- | ---- | ----- | ----- |  
	 | m2    | 34.70 | 39.31 | 0.088 | 2.00 | 0.024 | 0.080 |  
	 | k1    | 56.12 | 65.55 | 0.087 | 0.44 | 0.007 | 0.083 |  
	-----------------------------------------------------------
 
Calculate hsal and beta. 
   a) Interpolate h to the reg [1440 x 720] lat-lon grid...   done (CPU: 0.38672, Wall: 0.387)
   b) Spherical harmonic analysis... done (CPU: 1.5977, Wall: 8.143)
   c) Spherical harmonic synthesis... done (CPU: 1.6953, Wall: 10.912)
   d) Interpolate hsal onto the original grid... done (CPU: 0.71875, Wall: 0.718)
   e) Calculate beta (averaged over 5ยบ)... matgen   done (CPU: 0.61328, Wall: 1.114)
   e) coo_mat_mul 5ยบ)...   done (CPU: 148.08, Wall: 148.35)
done (CPU: 154.18, Wall: 171.78)
   a) Interpolate h to the reg [1440 x 720] lat-lon grid...   done (CPU: 0.37891, Wall: 0.38)
   b) Spherical harmonic analysis... done (CPU: 0.94922, Wall: 0.95)
   c) Spherical harmonic synthesis... done (CPU: 1.1328, Wall: 1.134)
   d) Interpolate hsal onto the original grid... done (CPU: 0.71875, Wall: 0.719)
   e) Calculate beta (averaged over 5ยบ)... matgen   done (CPU: 0.58984, Wall: 0.591)
   e) coo_mat_mul 5ยบ)...   done (CPU: 147.95, Wall: 148.11)
done (CPU: 152.79, Wall: 152.95)
  Welcome to calc_dhat: Projecting: ******** done (CPU: 1:18.863, Wall: 1:18.930)
  Storing: ** done (CPU: 3.789, Wall: 10.416)
===>>> Total time spent on Iteration 3:  3:55:55 CPU, 58:44.580  Wall
==============
 Iteration 4
==============
 1. for m2: assembling the matrix and rhs, implementing b.c. 
   b) Factorization... done (10.2Gb).    c) Solve... done (CPU: 1:30:34, Wall: 21:24.479)
 2. for k1: assembling the matrix and rhs, implementing b.c. 
   b) Factorization... done (10.2Gb).    c) Solve... done (CPU: 1:27:43, Wall: 20:20.443)
	-----------------------------------------------------------
	 | Convg |   du  |   dv  |  duv% |  dh  | dhbar |  dh%  | 	
	 | ----- | ----- | ----- | ----- | ---- | ----- | ----- |  
	 | m2    | 14.94 | 16.59 | 0.042 | 0.83 | 0.011 | 0.039 |  
	 | k1    | 23.92 | 32.93 | 0.040 | 0.17 | 0.003 | 0.036 |  
	-----------------------------------------------------------
 
Calculate hsal and beta. 
   a) Interpolate h to the reg [1440 x 720] lat-lon grid...   done (CPU: 0.38281, Wall: 0.383)
   b) Spherical harmonic analysis... done (CPU: 1.7109, Wall: 8.225)
   c) Spherical harmonic synthesis... done (CPU: 2.082, Wall: 8.355)
   d) Interpolate hsal onto the original grid... done (CPU: 0.71875, Wall: 0.723)
   e) Calculate beta (averaged over 5ยบ)... matgen   done (CPU: 0.62891, Wall: 1.268)
   e) coo_mat_mul 5ยบ)...   done (CPU: 147.02, Wall: 144.87)
done (CPU: 153.65, Wall: 165.64)
   a) Interpolate h to the reg [1440 x 720] lat-lon grid...   done (CPU: 0.38281, Wall: 0.382)
   b) Spherical harmonic analysis... done (CPU: 0.95703, Wall: 0.958)
   c) Spherical harmonic synthesis... done (CPU: 1.0859, Wall: 1.089)
   d) Interpolate hsal onto the original grid... done (CPU: 0.71484, Wall: 0.716)
   e) Calculate beta (averaged over 5ยบ)... matgen   done (CPU: 0.58984, Wall: 0.589)
   e) coo_mat_mul 5ยบ)...   done (CPU: 147.44, Wall: 147.45)
done (CPU: 152.23, Wall: 152.26)
  Welcome to calc_dhat: Projecting: ******** done (CPU: 1:18.023, Wall: 1:18.039)
  Storing: ** done (CPU: 3.726, Wall: 10.376)
===>>> Total time spent on Iteration 4:  3:06:06 CPU, 50:46.722  Wall
==============
 Iteration 5
==============
 1. for m2: assembling the matrix and rhs, implementing b.c. 
   b) Factorization... done (10.2Gb).    c) Solve... done (CPU: 1:22:41, Wall: 19:39.472)
 2. for k1: assembling the matrix and rhs, implementing b.c. 
   b) Factorization... done (10.2Gb).    c) Solve... done (CPU: 1:23:49, Wall: 20:04.390)
	-----------------------------------------------------------
	 | Convg |   du  |   dv  |  duv% |  dh  | dhbar |  dh%  | 	
	 | ----- | ----- | ----- | ----- | ---- | ----- | ----- |  
	 | m2    |  5.97 |  5.66 | 0.021 | 0.42 | 0.005 | 0.020 |  
	 | k1    | 12.18 | 16.42 | 0.021 | 0.07 | 0.001 | 0.018 |  
	-----------------------------------------------------------
 
Calculate hsal and beta. 
   a) Interpolate h to the reg [1440 x 720] lat-lon grid...   done (CPU: 0.37891, Wall: 0.382)
   b) Spherical harmonic analysis... done (CPU: 1.5195, Wall: 8.17)
   c) Spherical harmonic synthesis... done (CPU: 1.6914, Wall: 8.351)
   d) Interpolate hsal onto the original grid... done (CPU: 0.73047, Wall: 0.732)
   e) Calculate beta (averaged over 5ยบ)... matgen   done (CPU: 0.62109, Wall: 1.504)
   e) coo_mat_mul 5ยบ)...   done (CPU: 147.4, Wall: 147.43)
done (CPU: 153.45, Wall: 168.36)
   a) Interpolate h to the reg [1440 x 720] lat-lon grid...   done (CPU: 0.38281, Wall: 0.381)
   b) Spherical harmonic analysis... done (CPU: 0.95703, Wall: 0.957)
   c) Spherical harmonic synthesis... done (CPU: 1.082, Wall: 1.085)
   d) Interpolate hsal onto the original grid... done (CPU: 0.71484, Wall: 0.715)
   e) Calculate beta (averaged over 5ยบ)... matgen   done (CPU: 0.58984, Wall: 0.589)
   e) coo_mat_mul 5ยบ)...   done (CPU: 147.28, Wall: 147.32)
done (CPU: 152.07, Wall: 152.11)
  Welcome to calc_dhat: Projecting: ******** done (CPU: 1:18.000, Wall: 1:18.022)
  Storing: ** done (CPU: 3.601, Wall: 10.432)
===>>> Total time spent on Iteration 5:  2:54:21 CPU, 48:42.444  Wall
==============
 Iteration 6
==============
 1. for m2: assembling the matrix and rhs, implementing b.c. 
   b) Factorization... done (10.2Gb).    c) Solve... done (CPU: 1:24:29, Wall: 20:09.412)
 2. for k1: assembling the matrix and rhs, implementing b.c. 
   b) Factorization... done (10.2Gb).    c) Solve... done (CPU: 1:29:45, Wall: 21:04.787)
	-----------------------------------------------------------
	 | Convg |  du  |  dv  |  duv% |  dh  | dhbar |  dh%  | 	
	 | ----- | ---- | ---- | ----- | ---- | ----- | ----- |  
	 | m2    | 2.77 | 2.78 | 0.010 | 0.23 | 0.003 | 0.010 |  
	 | k1    | 6.15 | 8.17 | 0.010 | 0.04 | 0.001 | 0.009 |  
	-----------------------------------------------------------
 
Calculate hsal and beta. 
   a) Interpolate h to the reg [1440 x 720] lat-lon grid...   done (CPU: 0.375, Wall: 0.386)
   b) Spherical harmonic analysis... done (CPU: 1.5781, Wall: 8.162)
   c) Spherical harmonic synthesis... done (CPU: 1.6406, Wall: 8.859)
   d) Interpolate hsal onto the original grid... done (CPU: 0.71875, Wall: 0.716)
   e) Calculate beta (averaged over 5ยบ)... matgen   done (CPU: 0.60938, Wall: 1.113)
   e) coo_mat_mul 5ยบ)...   done (CPU: 147.18, Wall: 147.21)
done (CPU: 153.22, Wall: 168.31)
   a) Interpolate h to the reg [1440 x 720] lat-lon grid...   done (CPU: 0.375, Wall: 0.38)
   b) Spherical harmonic analysis... done (CPU: 0.94531, Wall: 0.952)
   c) Spherical harmonic synthesis... done (CPU: 1.0859, Wall: 1.086)
   d) Interpolate hsal onto the original grid... done (CPU: 0.71094, Wall: 0.714)
   e) Calculate beta (averaged over 5ยบ)... matgen   done (CPU: 0.59375, Wall: 0.591)
   e) coo_mat_mul 5ยบ)...   done (CPU: 147.41, Wall: 147.43)
done (CPU: 152.2, Wall: 152.23)
  Welcome to calc_dhat: Projecting: ******** done (CPU: 1:18.015, Wall: 1:18.027)
  Storing: ** done (CPU: 3.539, Wall: 10.406)
===>>> Total time spent on Iteration 6:  3:02:05 CPU, 50:07.778  Wall
==============
 Iteration 7
==============
 1. for m2: assembling the matrix and rhs, implementing b.c. 
   b) Factorization... done (10.2Gb).    c) Solve... done (CPU: 1:23:22, Wall: 20:06.979)
 2. for k1: assembling the matrix and rhs, implementing b.c. 
   b) Factorization... done (10.2Gb).    c) Solve... done (CPU: 1:24:05, Wall: 20:28.911)
	-----------------------------------------------------------
	 | Convg |  du  |  dv  |  duv% |  dh  | dhbar |  dh%  | 	
	 | ----- | ---- | ---- | ----- | ---- | ----- | ----- |  
	 | m2    | 1.41 | 1.58 | 0.005 | 0.10 | 0.001 | 0.004 |  
	 | k1    | 3.09 | 4.09 | 0.005 | 0.02 | 0.000 | 0.004 |  
	-----------------------------------------------------------
 
Calculate hsal and beta. 
   a) Interpolate h to the reg [1440 x 720] lat-lon grid...   done (CPU: 0.375, Wall: 0.383)
   b) Spherical harmonic analysis... done (CPU: 1.8906, Wall: 8.203)
   c) Spherical harmonic synthesis... done (CPU: 1.9844, Wall: 8.285)
   d) Interpolate hsal onto the original grid... done (CPU: 0.71094, Wall: 0.715)
   e) Calculate beta (averaged over 5ยบ)... matgen   done (CPU: 0.625, Wall: 1.111)
   e) coo_mat_mul 5ยบ)...   done (CPU: 147.12, Wall: 147.2)
done (CPU: 153.82, Wall: 167.83)
   a) Interpolate h to the reg [1440 x 720] lat-lon grid...   done (CPU: 0.38281, Wall: 0.385)
   b) Spherical harmonic analysis... done (CPU: 0.96094, Wall: 0.959)
   c) Spherical harmonic synthesis... done (CPU: 1.1094, Wall: 1.105)
   d) Interpolate hsal onto the original grid... done (CPU: 0.71875, Wall: 0.714)
   e) Calculate beta (averaged over 5ยบ)... matgen   done (CPU: 0.58594, Wall: 0.589)
   e) coo_mat_mul 5ยบ)...   done (CPU: 147.23, Wall: 147.24)
done (CPU: 152.03, Wall: 152.06)
  Welcome to calc_dhat: Projecting: ******** done (CPU: 1:18.054, Wall: 1:18.124)
  Storing: ** done (CPU: 3.710, Wall: 10.486)
===>>> Total time spent on Iteration 7:  2:55:17 CPU, 49:27.691  Wall
========================================================================
========================================================================
 
===>>> Total time spent on solving the system: 1 d  0:07:01 CPU, 6:33:10  Wall
 
-----------------------------------------------------------------------------
m2:	KE = 272.3 PJ, PE = 237.3 PJ, D = 3.119 TW.
	D_BL = 2.041 TW, D_IT = 1.071 TW, D_SAL = -0.109 GW, D_f = 0.000 GW.
	---------------------------------------------------------------------
	 | **** | Total | Shallow |  Deep | Coastal |  Open | 	
	 | ---- | ----- | ------- | ----- | ------- | ----- |  
	 | D_BL | 2.041 |  2.029  | 0.011 |  2.021  | 0.019 |  
	 | D_IT | 1.071 |  0.272  | 0.800 |  0.587  | 0.484 |  
	 | D    | 3.112 |  2.301  | 0.811 |  2.608  | 0.504 |  
-----------------------------------------------------------------------------
k1:	KE = 37.6 PJ, PE = 21.8 PJ, D = 0.344 TW.
	D_BL = 0.231 TW, D_IT = 0.113 TW, D_SAL = -0.011 GW, D_f = 0.000 GW.
	---------------------------------------------------------------------
	 | **** | Total | Shallow |  Deep | Coastal |  Open | 	
	 | ---- | ----- | ------- | ----- | ------- | ----- |  
	 | D_BL | 0.231 |  0.229  | 0.002 |  0.223  | 0.008 |  
	 | D_IT | 0.113 |  0.021  | 0.092 |  0.067  | 0.046 |  
	 | D    | 0.344 |  0.250  | 0.094 |  0.290  | 0.054 |  
Cleaning up temporary files 
[H[2JSaving data as 2013_01_25__17_45
Loading topography file: /home/amt6/amtvl/Desktop/scratch/Tides/data/LAG/baro_fd/in/topo/nocs/topo_rot_2.0min_pole_15_-40.dat 
Interpolating topo to  7.50 min resolution global grid:  done.
****** Ocean is in the first/last tau index of H_hg. Removed ******
Removing bays and inlets: 4022 + 767 + 266 + 101 + 34 + 13 + 8 + 3 + 2 + 0.
Removing inland seas/lakes: found 143 connected components; removed 139 of size < 288 cells.
Smoothing topography for the linear ITD scheme: Loading topography file: /home/amt6/amtvl/Desktop/scratch/Tides/data/LAG/baro_fd/in/topo/nocs/smoothed_t1_trunc1440_topo_rot_2.0min_pole_15_-40.dat 
done (CPU: 0.884, Wall: 4.839)
Allocating grid points: 5217987 for u, 5218301 for v, 5194418  for h.
Making vectors: tau, H, evaluating on the u-, v-, h-grid (CPU: 1.1s, Wall:1.1s)
Making matrices:
 - d/dph and 1 for h-grid functions, evaluating on the u-grid (CPU: 0.7s, Wall:0.7s)
 - d/dta and 1 for h grid functions, evaluating on the v-grid (CPU: 0.6s, Wall:0.6s)
 - d/dph and 1 for u-grid functions, evaluating on the h-grid (CPU: 0.7s, Wall:0.7s)
 - d/dta and 1 for v-grid functions, evaluating on the h-grid (CPU: 0.7s, Wall:0.7s)
 - v & fv,     			     evaluating on the u-grid (CPU: 4.2s, Wall:4.2s)
 - u & fu,     			     evaluating on the v-grid (CPU: 4.3s, Wall:4.3s)
Saving matrices: done.
Preparing matrices: GHU, GHV, KU, KV, v2uf, u2vf, Linear BBL, Linear ITD (1 matrix per constituent), b.c. DONE
====================================
Welcome to baro_solver (nonlinear)
====================================
==============
 Iteration 1
==============
Have [1.56E+07 x 1.56E+07] sparse matrix (nnz = 9.85E+07). Solve with pardiso.
 1. for m2: assembling the matrix and rhs, implementing b.c. 
   a) Reordering... done (peak-11.2Gb; permanent-9.5Gb) 
      Size of matrix factors 16.1Gb > 15.0Gb RAM+Swap. Running out-of-core with peak memory usage: 11.2Gb. 
   b) Factorization... done (5.7Gb).    c) Solve... done (CPU: 1:25:00, Wall: 20:29.407)
 2. for k1: assembling the matrix and rhs, implementing b.c. 
   b) Factorization... done (5.7Gb).    c) Solve... done (CPU: 1:09:51, Wall: 14:05.093)
	-----------------------------------------------------------
	 | Convg |   du   |   dv   |  duv%  |  dh  | dhbar |  dh%  | 	
	 | ----- | ------ | ------ | ------ | ---- | ----- | ----- |  
	 | m2    | 822.24 | 561.79 | 42.371 | 4.64 | 0.360 | 0.360 |  
	 | k1    | 557.12 | 545.21 | 11.993 | 3.47 | 0.108 | 0.108 |  
	-----------------------------------------------------------
 
Calculate hsal and beta: 
 1. for m2: done (CPU: 48.047, Wall: 19.762)
 2. for k1: done (CPU: 38.53, Wall: 11.437)
  Welcome to calc_dhat: Projecting: ******** done (CPU: 1:16.543, Wall: 1:16.573)
  Storing: ** done (CPU: 2.656, Wall: 3.444)
===>>> Total time spent on Iteration 1:  2:39:10 CPU, 38:27.053  Wall
==============
 Iteration 2
==============
 1. for m2: assembling the matrix and rhs, implementing b.c. 
   b) Factorization... done (5.7Gb).    c) Solve... done (CPU: 1:10:07, Wall: 14:04.543)
 2. for k1: assembling the matrix and rhs, implementing b.c. 
   b) Factorization... done (5.7Gb).    c) Solve... done (CPU: 1:10:11, Wall: 13:45.101)
	-----------------------------------------------------------
	 | Convg |   du   |   dv   |  duv% |  dh  | dhbar |  dh%  | 	
	 | ----- | ------ | ------ | ----- | ---- | ----- | ----- |  
	 | m2    |  58.08 |  80.26 | 1.867 | 4.24 | 0.044 | 1.123 |  
	 | k1    | 181.14 | 202.58 | 1.236 | 1.28 | 0.018 | 0.586 |  
	-----------------------------------------------------------
 
Calculate hsal and beta: 
 1. for m2: done (CPU: 42.971, Wall: 33.627)
 2. for k1: done (CPU: 39.225, Wall: 10.047)
  Welcome to calc_dhat: Projecting: ******** done (CPU: 1:16.718, Wall: 1:16.750)
  Storing: ** done (CPU: 4.294, Wall: 9.772)
===>>> Total time spent on Iteration 2:  2:24:36 CPU, 32:28.829  Wall
==============
 Iteration 3
==============
 1. for m2: assembling the matrix and rhs, implementing b.c. 
   b) Factorization... done (5.7Gb).    c) Solve... done (CPU: 1:10:36, Wall: 14:10.260)
 2. for k1: assembling the matrix and rhs, implementing b.c. 
   b) Factorization... done (5.7Gb).    c) Solve... done (CPU: 1:10:18, Wall: 13:51.690)
	-----------------------------------------------------------
	 | Convg |   du  |   dv  |  duv% |  dh  | dhbar |  dh%  | 	
	 | ----- | ----- | ----- | ----- | ---- | ----- | ----- |  
	 | m2    | 28.35 | 36.57 | 0.087 | 1.85 | 0.019 | 0.078 |  
	 | k1    | 57.30 | 64.36 | 0.089 | 0.53 | 0.006 | 0.085 |  
	-----------------------------------------------------------
 
Calculate hsal and beta: 
 1. for m2: done (CPU: 43.734, Wall: 33.528)
 2. for k1: done (CPU: 40.055, Wall: 10.045)
  Welcome to calc_dhat: Projecting: ******** done (CPU: 1:16.644, Wall: 1:16.676)
  Storing: ** done (CPU: 4.302, Wall: 9.765)
===>>> Total time spent on Iteration 3:  2:25:17 CPU, 32:48.745  Wall
==============
 Iteration 4
==============
 1. for m2: assembling the matrix and rhs, implementing b.c. 
   b) Factorization... done (5.7Gb).    c) Solve... done (CPU: 1:08:23, Wall: 13:49.513)
 2. for k1: assembling the matrix and rhs, implementing b.c. 
   b) Factorization... done (5.7Gb).    c) Solve... done (CPU: 1:10:43, Wall: 13:52.828)
	-----------------------------------------------------------
	 | Convg |   du  |   dv  |  duv% |  dh  | dhbar |  dh%  | 	
	 | ----- | ----- | ----- | ----- | ---- | ----- | ----- |  
	 | m2    | 15.82 | 15.51 | 0.040 | 0.77 | 0.009 | 0.036 |  
	 | k1    | 19.83 | 22.54 | 0.042 | 0.21 | 0.003 | 0.038 |  
	-----------------------------------------------------------
 
Calculate hsal and beta: 
 1. for m2: done (CPU: 41.832, Wall: 31.333)
 2. for k1: done (CPU: 39.355, Wall: 10.163)
  Welcome to calc_dhat: Projecting: ******** done (CPU: 1:16.703, Wall: 1:16.740)
  Storing: ** done (CPU: 4.304, Wall: 9.788)
===>>> Total time spent on Iteration 4:  2:23:27 CPU, 32:23.899  Wall
==============
 Iteration 5
==============
 1. for m2: assembling the matrix and rhs, implementing b.c. 
   b) Factorization... done (5.7Gb).    c) Solve... done (CPU: 1:09:46, Wall: 14:06.203)
 2. for k1: assembling the matrix and rhs, implementing b.c. 
   b) Factorization... done (5.7Gb).    c) Solve... done (CPU: 1:11:43, Wall: 14:12.200)
	-----------------------------------------------------------
	 | Convg |  du  |  dv  |  duv% |  dh  | dhbar |  dh%  | 	
	 | ----- | ---- | ---- | ----- | ---- | ----- | ----- |  
	 | m2    | 8.00 | 5.40 | 0.019 | 0.34 | 0.004 | 0.017 |  
	 | k1    | 7.87 | 8.95 | 0.021 | 0.08 | 0.001 | 0.019 |  
	-----------------------------------------------------------
 
Calculate hsal and beta: 
 1. for m2: done (CPU: 44.27, Wall: 31.869)
 2. for k1: done (CPU: 38.223, Wall: 9.795)
  Welcome to calc_dhat: Projecting: ******** done (CPU: 1:16.550, Wall: 1:16.561)
  Storing: ** done (CPU: 4.324, Wall: 10.022)
===>>> Total time spent on Iteration 5:  2:25:47 CPU, 33:03.572  Wall
==============
 Iteration 6
==============
 1. for m2: assembling the matrix and rhs, implementing b.c. 
   b) Factorization... done (5.7Gb).    c) Solve... done (CPU: 1:10:49, Wall: 13:59.062)
 2. for k1: assembling the matrix and rhs, implementing b.c. 
   b) Factorization... done (5.7Gb).    c) Solve... done (CPU: 1:10:35, Wall: 13:51.385)
	-----------------------------------------------------------
	 | Convg |  du  |  dv  |  duv% |  dh  | dhbar |  dh%  | 	
	 | ----- | ---- | ---- | ----- | ---- | ----- | ----- |  
	 | m2    | 3.84 | 2.20 | 0.009 | 0.18 | 0.002 | 0.008 |  
	 | k1    | 3.86 | 3.93 | 0.010 | 0.04 | 0.001 | 0.009 |  
	-----------------------------------------------------------
 
Calculate hsal and beta: 
 1. for m2: done (CPU: 42.184, Wall: 33.715)
 2. for k1: done (CPU: 39.945, Wall: 10.089)
  Welcome to calc_dhat: Projecting: ******** done (CPU: 1:16.535, Wall: 1:16.597)
  Storing: ** done (CPU: 4.015, Wall: 9.914)
===>>> Total time spent on Iteration 6:  2:25:44 CPU, 32:33.041  Wall
==============
 Iteration 7
==============
 1. for m2: assembling the matrix and rhs, implementing b.c. 
   b) Factorization... done (5.7Gb).    c) Solve... done (CPU: 1:10:22, Wall: 14:39.031)
 2. for k1: assembling the matrix and rhs, implementing b.c. 
   b) Factorization... done (5.7Gb).    c) Solve... done (CPU: 1:10:15, Wall: 14:05.171)
	-----------------------------------------------------------
	 | Convg |  du  |  dv  |  duv% |  dh  | dhbar |  dh%  | 	
	 | ----- | ---- | ---- | ----- | ---- | ----- | ----- |  
	 | m2    | 1.82 | 1.14 | 0.004 | 0.08 | 0.001 | 0.004 |  
	 | k1    | 1.90 | 1.93 | 0.005 | 0.02 | 0.000 | 0.004 |  
	-----------------------------------------------------------
 
Calculate hsal and beta: 
 1. for m2: done (CPU: 42.066, Wall: 33.454)
 2. for k1: done (CPU: 40.188, Wall: 9.793)
  Welcome to calc_dhat: Projecting: ******** done (CPU: 1:16.722, Wall: 1:16.731)
  Storing: ** done (CPU: 4.925, Wall: 10.008)
===>>> Total time spent on Iteration 7:  2:24:52 CPU, 33:23.199  Wall
========================================================================
========================================================================
 
===>>> Total time spent on solving the system: 17:08:57 CPU, 3:55:08  Wall
 
-----------------------------------------------------------------------------
m2:	KE = 186.9 PJ, PE = 158.0 PJ, D = 2.707 TW.
	D_BL = 1.181 TW, D_IT = 1.521 TW, D_SAL = -0.068 GW, D_f = 0.000 GW.
	---------------------------------------------------------------------
	 | **** | Total | Shallow |  Deep | Coastal |  Open | 	
	 | ---- | ----- | ------- | ----- | ------- | ----- |  
	 | D_BL | 1.181 |  1.175  | 0.007 |  1.163  | 0.019 |  
	 | D_IT | 1.521 |  0.542  | 0.979 |  0.853  | 0.668 |  
	 | D    | 2.702 |  1.716  | 0.986 |  2.016  | 0.686 |  
-----------------------------------------------------------------------------
k1:	KE = 37.5 PJ, PE = 21.7 PJ, D = 0.346 TW.
	D_BL = 0.244 TW, D_IT = 0.103 TW, D_SAL = -0.009 GW, D_f = -0.000 GW.
	---------------------------------------------------------------------
	 | **** | Total | Shallow |  Deep | Coastal |  Open | 	
	 | ---- | ----- | ------- | ----- | ------- | ----- |  
	 | D_BL | 0.244 |  0.242  | 0.002 |  0.213  | 0.031 |  
	 | D_IT | 0.103 |  -.014  | 0.116 |  0.076  | 0.026 |  
	 | D    | 0.346 |  0.228  | 0.118 |  0.289  | 0.057 |  
 
===>>> Calculation of domain integrals: 3:07:04 CPU, 3:07:30  Wall
Cleaning up temporary files 
[H[2JSaving data as 2013_01_26__10_18
Loading topography file: /home/amt6/amtvl/Desktop/scratch/Tides/data/LAG/baro_fd/in/topo/nocs/topo_rot_2.0min_pole_15_-40.dat 
Interpolating topo to  7.50 min resolution global grid:  done.
****** Ocean is in the first/last tau index of H_hg. Removed ******
Removing bays and inlets: 4022 + 767 + 266 + 101 + 34 + 13 + 8 + 3 + 2 + 0.
Removing inland seas/lakes: found 143 connected components; removed 139 of size < 288 cells.
Smoothing topography for the linear ITD scheme: Loading topography file: /home/amt6/amtvl/Desktop/scratch/Tides/data/LAG/baro_fd/in/topo/nocs/smoothed_t1_trunc720_topo_rot_2.0min_pole_15_-40.dat 
done (CPU: 0.947, Wall: 4.668)
Allocating grid points: 5217987 for u, 5218301 for v, 5194418  for h.
Making vectors: tau, H, evaluating on the u-, v-, h-grid (CPU: 1.1s, Wall:1.1s)
Making matrices:
 - d/dph and 1 for h-grid functions, evaluating on the u-grid (CPU: 0.7s, Wall:0.7s)
 - d/dta and 1 for h grid functions, evaluating on the v-grid (CPU: 0.6s, Wall:0.6s)
 - d/dph and 1 for u-grid functions, evaluating on the h-grid (CPU: 0.7s, Wall:0.7s)
 - d/dta and 1 for v-grid functions, evaluating on the h-grid (CPU: 0.7s, Wall:0.7s)
 - v & fv,     			     evaluating on the u-grid (CPU: 4.2s, Wall:4.2s)
 - u & fu,     			     evaluating on the v-grid (CPU: 4.3s, Wall:4.3s)
Saving matrices: done.
Preparing matrices: GHU, GHV, KU, KV, v2uf, u2vf, Linear BBL, Linear ITD (1 matrix per constituent), b.c. DONE
====================================
Welcome to baro_solver (nonlinear)
====================================
==============
 Iteration 1
==============
Have [1.56E+07 x 1.56E+07] sparse matrix (nnz = 9.85E+07). Solve with pardiso.
 1. for m2: assembling the matrix and rhs, implementing b.c. 
   a) Reordering... done (peak-11.2Gb; permanent-9.5Gb) 
      Size of matrix factors 16.3Gb < 20.0Gb RAM+Swap. Running in-core with peak memory usage: 25.8Gb.
   b) Factorization... done (10.6Gb).    c) Solve... done (CPU: 1:24:26, Wall: 20:14.901)
 2. for k1: assembling the matrix and rhs, implementing b.c. 
   b) Factorization... done (10.6Gb).    c) Solve... done (CPU: 1:10:29, Wall: 13:49.562)
	-----------------------------------------------------------
	 | Convg |   du   |   dv   |  duv%  |  dh  | dhbar |  dh%  | 	
	 | ----- | ------ | ------ | ------ | ---- | ----- | ----- |  
	 | m2    | 585.57 | 321.20 | 39.857 | 4.20 | 0.340 | 0.340 |  
	 | k1    | 569.60 | 581.00 | 11.208 | 3.33 | 0.099 | 0.099 |  
	-----------------------------------------------------------
  Welcome to calc_dhat: Projecting: ******** done (CPU: 1:16.996, Wall: 1:17.017)
  Storing: ** done (CPU: 2.633, Wall: 3.273)
===>>> Total time spent on Iteration 1:  2:37:01 CPU, 36:32.009  Wall
==============
 Iteration 2
==============
 1. for m2: assembling the matrix and rhs, implementing b.c. 
   b) Factorization... done (10.6Gb).    c) Solve... done (CPU: 1:09:20, Wall: 13:42.499)
 2. for k1: assembling the matrix and rhs, implementing b.c. 
   b) Factorization... done (10.6Gb).    c) Solve... done (CPU: 1:10:57, Wall: 13:55.094)
	-----------------------------------------------------------
	 | Convg |   du   |   dv   |  duv% |  dh  | dhbar |  dh%  | 	
	 | ----- | ------ | ------ | ----- | ---- | ----- | ----- |  
	 | m2    |  50.07 |  76.90 | 3.851 | 4.96 | 0.034 | 2.543 |  
	 | k1    | 195.00 | 218.47 | 1.366 | 1.20 | 0.007 | 0.579 |  
	-----------------------------------------------------------
  Welcome to calc_dhat: Projecting: ******** done (CPU: 1:16.910, Wall: 1:16.922)
  Storing: ** done (CPU: 4.263, Wall: 10.048)
===>>> Total time spent on Iteration 2:  2:22:19 CPU, 30:23.557  Wall
==============
 Iteration 3
==============
 1. for m2: assembling the matrix and rhs, implementing b.c. 
   b) Factorization... done (10.6Gb).    c) Solve... done (CPU: 1:10:13, Wall: 14:00.715)
 2. for k1: assembling the matrix and rhs, implementing b.c. 
   b) Factorization... done (10.6Gb).    c) Solve... done (CPU: 1:10:00, Wall: 13:35.989)
	-----------------------------------------------------------
	 | Convg |   du  |   dv  |  duv% |  dh  | dhbar |  dh%  | 	
	 | ----- | ----- | ----- | ----- | ---- | ----- | ----- |  
	 | m2    | 18.45 | 34.56 | 0.053 | 1.91 | 0.011 | 0.046 |  
	 | k1    | 62.09 | 70.05 | 0.050 | 0.46 | 0.002 | 0.035 |  
	-----------------------------------------------------------
  Welcome to calc_dhat: Projecting: ******** done (CPU: 1:17.050, Wall: 1:17.083)
  Storing: ** done (CPU: 4.496, Wall: 9.888)
===>>> Total time spent on Iteration 3:  2:22:17 CPU, 30:21.901  Wall
==============
 Iteration 4
==============
 1. for m2: assembling the matrix and rhs, implementing b.c. 
   b) Factorization... done (10.6Gb).    c) Solve... done (CPU: 1:09:11, Wall: 13:45.021)
 2. for k1: assembling the matrix and rhs, implementing b.c. 
   b) Factorization... done (10.6Gb).    c) Solve... done (CPU: 1:09:22, Wall: 13:37.353)
	-----------------------------------------------------------
	 | Convg |   du  |   dv  |  duv% |  dh  | dhbar |  dh%  | 	
	 | ----- | ----- | ----- | ----- | ---- | ----- | ----- |  
	 | m2    |  8.86 | 14.40 | 0.025 | 0.96 | 0.005 | 0.022 |  
	 | k1    | 20.47 | 23.45 | 0.024 | 0.17 | 0.001 | 0.017 |  
	-----------------------------------------------------------
  Welcome to calc_dhat: Projecting: ******** done (CPU: 1:17.031, Wall: 1:17.063)
  Storing: ** done (CPU: 4.839, Wall: 10.045)
===>>> Total time spent on Iteration 4:  2:20:37 CPU, 30:07.889  Wall
==============
 Iteration 5
==============
 1. for m2: assembling the matrix and rhs, implementing b.c. 
   b) Factorization... done (10.6Gb).    c) Solve... done (CPU: 1:09:44, Wall: 13:34.192)
 2. for k1: assembling the matrix and rhs, implementing b.c. 
   b) Factorization... done (10.6Gb).    c) Solve... done (CPU: 1:09:47, Wall: 13:38.172)
	-----------------------------------------------------------
	 | Convg |  du  |  dv  |  duv% |  dh  | dhbar |  dh%  | 	
	 | ----- | ---- | ---- | ----- | ---- | ----- | ----- |  
	 | m2    | 5.68 | 5.53 | 0.013 | 0.43 | 0.002 | 0.011 |  
	 | k1    | 8.18 | 8.79 | 0.012 | 0.07 | 0.000 | 0.009 |  
	-----------------------------------------------------------
  Welcome to calc_dhat: Projecting: ******** done (CPU: 1:17.031, Wall: 1:17.041)
  Storing: ** done (CPU: 5.113, Wall: 10.133)
===>>> Total time spent on Iteration 5:  2:21:35 CPU, 29:57.720  Wall
==============
 Iteration 6
==============
 1. for m2: assembling the matrix and rhs, implementing b.c. 
   b) Factorization... done (10.6Gb).    c) Solve... done (CPU: 1:09:18, Wall: 13:29.942)
 2. for k1: assembling the matrix and rhs, implementing b.c. 
   b) Factorization... done (10.6Gb).    c) Solve... done (CPU: 1:09:34, Wall: 13:39.601)
	-----------------------------------------------------------
	 | Convg |  du  |  dv  |  duv% |  dh  | dhbar |  dh%  | 	
	 | ----- | ---- | ---- | ----- | ---- | ----- | ----- |  
	 | m2    | 2.06 | 2.34 | 0.006 | 0.18 | 0.001 | 0.005 |  
	 | k1    | 4.00 | 4.08 | 0.006 | 0.04 | 0.000 | 0.005 |  
	-----------------------------------------------------------
  Welcome to calc_dhat: Projecting: ******** done (CPU: 1:16.941, Wall: 1:17.000)
  Storing: ** done (CPU: 4.265, Wall: 9.869)
===>>> Total time spent on Iteration 6:  2:20:54 CPU, 29:54.730  Wall
==============
 Iteration 7
==============
 1. for m2: assembling the matrix and rhs, implementing b.c. 
   b) Factorization... done (10.6Gb).    c) Solve... done (CPU: 1:09:57, Wall: 13:40.577)
 2. for k1: assembling the matrix and rhs, implementing b.c. 
   b) Factorization... done (10.6Gb).    c) Solve... done (CPU: 1:10:21, Wall: 13:42.947)
	-----------------------------------------------------------
	 | Convg |  du  |  dv  |  duv% |  dh  | dhbar |  dh%  | 	
	 | ----- | ---- | ---- | ----- | ---- | ----- | ----- |  
	 | m2    | 0.97 | 1.13 | 0.003 | 0.09 | 0.000 | 0.002 |  
	 | k1    | 1.97 | 2.01 | 0.003 | 0.02 | 0.000 | 0.002 |  
	-----------------------------------------------------------
  Welcome to calc_dhat: Projecting: ******** done (CPU: 1:16.910, Wall: 1:16.953)
  Storing: ** done (CPU: 4.140, Wall: 10.079)
===>>> Total time spent on Iteration 7:  2:22:23 CPU, 30:08.896  Wall
========================================================================
========================================================================
 
===>>> Total time spent on solving the system: 16:47:10 CPU, 3:37:26  Wall
 
-----------------------------------------------------------------------------
m2:	KE = 200.9 PJ, PE = 172.7 PJ, D = 3.273 TW.
	D_BL = 1.176 TW, D_IT = 2.095 TW, D_SAL = 0.000 GW, D_f = -0.000 GW.
	---------------------------------------------------------------------
	 | **** | Total | Shallow |  Deep | Coastal |  Open | 	
	 | ---- | ----- | ------- | ----- | ------- | ----- |  
	 | D_BL | 1.176 |  1.168  | 0.007 |  1.162  | 0.013 |  
	 | D_IT | 2.095 |  0.460  | 1.635 |  1.051  | 1.044 |  
	 | D    | 3.271 |  1.628  | 1.642 |  2.213  | 1.057 |  
-----------------------------------------------------------------------------
k1:	KE = 34.6 PJ, PE = 18.5 PJ, D = 0.360 TW.
	D_BL = 0.193 TW, D_IT = 0.167 TW, D_SAL = -0.000 GW, D_f = -0.000 GW.
	---------------------------------------------------------------------
	 | **** | Total | Shallow |  Deep | Coastal |  Open | 	
	 | ---- | ----- | ------- | ----- | ------- | ----- |  
	 | D_BL | 0.193 |  0.191  | 0.002 |  0.185  | 0.008 |  
	 | D_IT | 0.167 |  0.022  | 0.145 |  0.080  | 0.087 |  
	 | D    | 0.360 |  0.213  | 0.147 |  0.266  | 0.094 |  
 
===>>> Calculation of domain integrals: 3:10:25 CPU, 3:10:48  Wall
Cleaning up temporary files 
