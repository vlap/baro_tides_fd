[H[2JSaving data as 2012_11_24__16_55
Loading topography file:  done.
Interpolating topo to 15.00 min resolution global grid:  done.
****** Ocean is in the first/last tau index of H_hg. Removed ******
Removing bays and inlets: 1371 + 335 + 156 + 78 + 48 + 31 + 21 + 16 + 13 + 8 + 4 + 3 + 3 + 2 + 0.
Removing inland seas/lakes: found 26 connected components; removed 23 of size < 144 cells.
Smoothing topography for the linear ITD scheme: Loading topography file: At line 1125 of file src/misc/save_load.f90 (unit = 10, file = '')
Fortran runtime error: File '/home/amt6/amtvl/Desktop/scratch/Tides/data/LAG/baro_fd/in/topo/nocs/smoothed_t1_trunc180_topo_rot_2.0min_pole_15_-40.dat' does not exist

Backtrace for this error:
  + function __save_load_MOD_load_alloc_topo_real (0x4DE58C)
    at line 1127 of file save_load.f90
  + function __generate_grid_MOD_generate_global_grid (0x487189)
    at line 128 of file generate_global_grid.f90
  + in the main program
    at line 79 of file baro_v1.f90
  + /lib64/libc.so.6(__libc_start_main+0xfd) [0x3c4081ecdd]
[H[2JSaving data as 2012_11_25__08_14
Loading topography file:  done.
Interpolating topo to 15.00 min resolution global grid:  done.
****** Ocean is in the first/last tau index of H_hg. Removed ******
Removing bays and inlets: 1371 + 335 + 156 + 78 + 48 + 31 + 21 + 16 + 13 + 8 + 4 + 3 + 3 + 2 + 0.
Removing inland seas/lakes: found 26 connected components; removed 23 of size < 144 cells.
Smoothing topography for the linear ITD scheme: Loading topography file:  done.
done (CPU: 0.986, Wall: 0.998)
Allocating grid points: 679779 for u, 683462 for v, 675152  for h.
Making vectors: tau, H, evaluating on the u-, v-, h-grid (CPU: 0.1s, Wall:0.1s)
Making matrices:
 - d/dph and 1 for h-grid functions, evaluating on the u-grid (CPU: 0.1s, Wall:0.1s)
 - d/dta and 1 for h grid functions, evaluating on the v-grid (CPU: 0.1s, Wall:0.1s)
 - d/dph and 1 for u-grid functions, evaluating on the h-grid (CPU: 0.1s, Wall:0.1s)
 - d/dta and 1 for v-grid functions, evaluating on the h-grid (CPU: 0.1s, Wall:0.1s)
 - v & fv,     			     evaluating on the u-grid (CPU: 0.5s, Wall:0.5s)
 - u & fu,     			     evaluating on the v-grid (CPU: 0.6s, Wall:0.6s)
Saving matrices: done.
Preparing matrices: GHU, GHV, KU, KV, v2uf, u2vf, Linear BBL, Linear ITD (1 matrix per constituent), b.c.  Done.
====================================
Welcome to baro_solver (nonlinear)
====================================
==============
 Iteration 1
==============
Have [2.04E+06 x 2.04E+06] sparse matrix (nnz = 1.28E+07). Solve with pardiso.
 1. for m2: assembling the matrix and rhs, implementing b.c. 
   a) Reordering... done (peak-1.6Gb; permanent-1.3Gb) 
      Size of matrix factors 3.0Gb < 18.0Gb RAM+Swap. Running in-core with peak memory usage: 4.3Gb.
   b) Factorization... done (3.0Gb).    c) Solve... done (CPU: 1:48.615, Wall: 26.596)
 2. for k1: assembling the matrix and rhs, implementing b.c. 
   b) Factorization... done (3.0Gb).    c) Solve... done (CPU: 1:14.437, Wall: 9.762)
	-----------------------------------------------------------
	 | Convg |   du   |   dv   |  duv%  |   dh  | dhbar |  dh%  | 	
	 | ----- | ------ | ------ | ------ | ----- | ----- | ----- |  
	 | m2    | 834.40 | 582.63 | 64.619 | 10.85 | 0.491 | 0.491 |  
	 | k1    | 888.52 | 704.01 | 16.452 |  3.19 | 0.119 | 0.119 |  
	-----------------------------------------------------------
 
Calculate hsal and beta. 
   a) Interpolate h to the reg [1440 x 720] lat-lon grid...   done (CPU: 0.14398, Wall: 0.144)
   b) Spherical harmonic analysis... done (CPU: 4.7663, Wall: 4.777)
   c) Spherical harmonic synthesis... done (CPU: 2.5576, Wall: 2.565)
   d) Interpolate hsal onto the original grid... done (CPU: 0.14197, Wall: 0.142)
   e) Calculate beta (averaged over 5ยบ)... matgen   done (CPU: 6.29883E-02, Wall: 6.3E-02)
   e) coo_mat_mul 5ยบ)...   done (CPU: 5.6422, Wall: 5.649)
done (CPU: 13.448, Wall: 13.473)
   a) Interpolate h to the reg [1440 x 720] lat-lon grid...   done (CPU: 0.14497, Wall: 0.145)
   b) Spherical harmonic analysis... done (CPU: 0.94385, Wall: 0.945)
   c) Spherical harmonic synthesis... done (CPU: 1.0908, Wall: 1.092)
   d) Interpolate hsal onto the original grid... done (CPU: 0.14297, Wall: 0.142)
   e) Calculate beta (averaged over 5ยบ)... matgen   done (CPU: 6.19965E-02, Wall: 6.3E-02)
   e) coo_mat_mul 5ยบ)...   done (CPU: 5.6441, Wall: 5.648)
done (CPU: 8.1588, Wall: 8.168)
  Welcome to calc_dhat: Projecting: ******** done (CPU: 10.026, Wall: 10.043)
  Storing: ** done (CPU: 0.273, Wall: 0.275)
===>>> Total time spent on Iteration 1:  3:51.138 CPU,  1:15.385  Wall
==============
 Iteration 2
==============
 1. for m2: assembling the matrix and rhs, implementing b.c. 
   b) Factorization... done (3.0Gb).    c) Solve... done (CPU: 1:12.970, Wall: 9.656)
 2. for k1: assembling the matrix and rhs, implementing b.c. 
   b) Factorization... done (3.0Gb).    c) Solve... done (CPU: 1:16.157, Wall: 10.020)
	-----------------------------------------------------------
	 | Convg |   du   |   dv   |  duv% |  dh  | dhbar |  dh%  | 	
	 | ----- | ------ | ------ | ----- | ---- | ----- | ----- |  
	 | m2    |  95.12 | 163.01 | 0.289 | 3.12 | 0.080 | 0.256 |  
	 | k1    | 336.04 | 261.25 | 0.310 | 0.58 | 0.018 | 0.272 |  
	-----------------------------------------------------------
 
Calculate hsal and beta. 
   a) Interpolate h to the reg [1440 x 720] lat-lon grid...   done (CPU: 0.14398, Wall: 0.145)
   b) Spherical harmonic analysis... done (CPU: 1.3038, Wall: 1.306)
   c) Spherical harmonic synthesis... done (CPU: 1.4498, Wall: 1.827)
   d) Interpolate hsal onto the original grid... done (CPU: 0.14301, Wall: 0.142)
   e) Calculate beta (averaged over 5ยบ)... matgen   done (CPU: 6.39648E-02, Wall: 6.4E-02)
   e) coo_mat_mul 5ยบ)...   done (CPU: 5.6461, Wall: 5.647)
done (CPU: 8.8826, Wall: 9.266)
   a) Interpolate h to the reg [1440 x 720] lat-lon grid...   done (CPU: 0.14395, Wall: 0.144)
   b) Spherical harmonic analysis... done (CPU: 0.95087, Wall: 0.952)
   c) Spherical harmonic synthesis... done (CPU: 1.0828, Wall: 1.083)
   d) Interpolate hsal onto the original grid... done (CPU: 0.14197, Wall: 0.142)
   e) Calculate beta (averaged over 5ยบ)... matgen   done (CPU: 6.39954E-02, Wall: 6.4E-02)
   e) coo_mat_mul 5ยบ)...   done (CPU: 5.6621, Wall: 5.665)
done (CPU: 8.1797, Wall: 8.182)
  Welcome to calc_dhat: Projecting: ******** done (CPU: 10.050, Wall: 10.050)
  Storing: ** done (CPU: 0.258, Wall: 0.258)
===>>> Total time spent on Iteration 2:  3:11.734 CPU, 54.472  Wall
==============
 Iteration 3
==============
 1. for m2: assembling the matrix and rhs, implementing b.c. 
   b) Factorization... done (3.0Gb).    c) Solve... done (CPU: 1:14.031, Wall: 9.699)
 2. for k1: assembling the matrix and rhs, implementing b.c. 
   b) Factorization... done (3.0Gb).    c) Solve... done (CPU: 1:14.639, Wall: 9.788)
	-----------------------------------------------------------
	 | Convg |   du  |   dv  |  duv% |  dh  | dhbar |  dh%  | 	
	 | ----- | ----- | ----- | ----- | ---- | ----- | ----- |  
	 | m2    | 55.06 | 71.64 | 0.091 | 1.13 | 0.030 | 0.082 |  
	 | k1    | 99.99 | 88.30 | 0.084 | 0.28 | 0.007 | 0.092 |  
	-----------------------------------------------------------
 
Calculate hsal and beta. 
   a) Interpolate h to the reg [1440 x 720] lat-lon grid...   done (CPU: 0.14197, Wall: 0.143)
   b) Spherical harmonic analysis... done (CPU: 1.2728, Wall: 1.273)
   c) Spherical harmonic synthesis... done (CPU: 1.4258, Wall: 1.427)
   d) Interpolate hsal onto the original grid... done (CPU: 0.14197, Wall: 0.143)
   e) Calculate beta (averaged over 5ยบ)... matgen   done (CPU: 6.29883E-02, Wall: 6.4E-02)
   e) coo_mat_mul 5ยบ)...   done (CPU: 5.6561, Wall: 5.657)
done (CPU: 8.8367, Wall: 8.838)
   a) Interpolate h to the reg [1440 x 720] lat-lon grid...   done (CPU: 0.14392, Wall: 0.144)
   b) Spherical harmonic analysis... done (CPU: 0.94983, Wall: 0.949)
   c) Spherical harmonic synthesis... done (CPU: 1.0948, Wall: 1.095)
   d) Interpolate hsal onto the original grid... done (CPU: 0.14197, Wall: 0.142)
   e) Calculate beta (averaged over 5ยบ)... matgen   done (CPU: 6.39648E-02, Wall: 6.3E-02)
   e) coo_mat_mul 5ยบ)...   done (CPU: 5.6522, Wall: 5.654)
done (CPU: 8.1788, Wall: 8.18)
  Welcome to calc_dhat: Projecting: ******** done (CPU: 10.113, Wall: 10.123)
  Storing: ** done (CPU: 0.257, Wall: 0.257)
===>>> Total time spent on Iteration 3:  3:18.301 CPU, 53.778  Wall
==============
 Iteration 4
==============
 1. for m2: assembling the matrix and rhs, implementing b.c. 
   b) Factorization... done (3.0Gb).    c) Solve... done (CPU: 1:13.283, Wall: 9.592)
 2. for k1: assembling the matrix and rhs, implementing b.c. 
   b) Factorization... done (3.0Gb).    c) Solve... done (CPU: 1:13.218, Wall: 9.590)
	-----------------------------------------------------------
	 | Convg |   du  |   dv  |  duv% |  dh  | dhbar |  dh%  | 	
	 | ----- | ----- | ----- | ----- | ---- | ----- | ----- |  
	 | m2    | 29.82 | 28.09 | 0.037 | 0.44 | 0.013 | 0.034 |  
	 | k1    | 32.30 | 27.95 | 0.036 | 0.14 | 0.003 | 0.037 |  
	-----------------------------------------------------------
 
Calculate hsal and beta. 
   a) Interpolate h to the reg [1440 x 720] lat-lon grid...   done (CPU: 0.14294, Wall: 0.144)
   b) Spherical harmonic analysis... done (CPU: 1.2758, Wall: 1.276)
   c) Spherical harmonic synthesis... done (CPU: 1.3898, Wall: 1.412)
   d) Interpolate hsal onto the original grid... done (CPU: 0.14294, Wall: 0.143)
   e) Calculate beta (averaged over 5ยบ)... matgen   done (CPU: 6.39648E-02, Wall: 6.4E-02)
   e) coo_mat_mul 5ยบ)...   done (CPU: 5.6451, Wall: 5.698)
done (CPU: 8.7936, Wall: 8.873)
   a) Interpolate h to the reg [1440 x 720] lat-lon grid...   done (CPU: 0.14398, Wall: 0.147)
   b) Spherical harmonic analysis... done (CPU: 0.94989, Wall: 0.95)
   c) Spherical harmonic synthesis... done (CPU: 1.0908, Wall: 1.091)
   d) Interpolate hsal onto the original grid... done (CPU: 0.14197, Wall: 0.141)
   e) Calculate beta (averaged over 5ยบ)... matgen   done (CPU: 6.39648E-02, Wall: 6.3E-02)
   e) coo_mat_mul 5ยบ)...   done (CPU: 5.6472, Wall: 5.647)
done (CPU: 8.1698, Wall: 8.176)
  Welcome to calc_dhat: Projecting: ******** done (CPU: 10.050, Wall: 10.098)
  Storing: ** done (CPU: 0.255, Wall: 0.266)
===>>> Total time spent on Iteration 4:  3:11.475 CPU, 53.444  Wall
==============
 Iteration 5
==============
 1. for m2: assembling the matrix and rhs, implementing b.c. 
   b) Factorization... done (3.0Gb).    c) Solve... done (CPU: 1:13.424, Wall: 9.677)
 2. for k1: assembling the matrix and rhs, implementing b.c. 
   b) Factorization... done (3.0Gb).    c) Solve... done (CPU: 1:13.492, Wall: 9.633)
	-----------------------------------------------------------
	 | Convg |   du  |   dv  |  duv% |  dh  | dhbar |  dh%  | 	
	 | ----- | ----- | ----- | ----- | ---- | ----- | ----- |  
	 | m2    | 15.53 | 11.25 | 0.017 | 0.22 | 0.006 | 0.015 |  
	 | k1    | 12.53 | 11.67 | 0.016 | 0.07 | 0.001 | 0.016 |  
	-----------------------------------------------------------
 
Calculate hsal and beta. 
   a) Interpolate h to the reg [1440 x 720] lat-lon grid...   done (CPU: 0.14197, Wall: 0.143)
   b) Spherical harmonic analysis... done (CPU: 1.2728, Wall: 1.273)
   c) Spherical harmonic synthesis... done (CPU: 1.4768, Wall: 1.478)
   d) Interpolate hsal onto the original grid... done (CPU: 0.14197, Wall: 0.143)
   e) Calculate beta (averaged over 5ยบ)... matgen   done (CPU: 6.29883E-02, Wall: 6.4E-02)
   e) coo_mat_mul 5ยบ)...   done (CPU: 5.6481, Wall: 5.649)
done (CPU: 8.8817, Wall: 8.883)
   a) Interpolate h to the reg [1440 x 720] lat-lon grid...   done (CPU: 0.14398, Wall: 0.145)
   b) Spherical harmonic analysis... done (CPU: 0.95087, Wall: 0.952)
   c) Spherical harmonic synthesis... done (CPU: 1.1248, Wall: 1.125)
   d) Interpolate hsal onto the original grid... done (CPU: 0.14294, Wall: 0.142)
   e) Calculate beta (averaged over 5ยบ)... matgen   done (CPU: 6.40259E-02, Wall: 6.4E-02)
   e) coo_mat_mul 5ยบ)...   done (CPU: 5.6461, Wall: 5.647)
done (CPU: 8.2048, Wall: 8.207)
  Welcome to calc_dhat: Projecting: ******** done (CPU: 10.058, Wall: 10.062)
  Storing: ** done (CPU: 0.258, Wall: 0.259)
===>>> Total time spent on Iteration 5:  3:08.976 CPU, 53.601  Wall
==============
 Iteration 6
==============
 1. for m2: assembling the matrix and rhs, implementing b.c. 
   b) Factorization... done (3.0Gb).    c) Solve... done (CPU: 1:13.924, Wall: 9.758)
 2. for k1: assembling the matrix and rhs, implementing b.c. 
   b) Factorization... done (3.0Gb).    c) Solve... done (CPU: 1:14.167, Wall: 9.751)
	-----------------------------------------------------------
	 | Convg |  du  |  dv  |  duv% |  dh  | dhbar |  dh%  | 	
	 | ----- | ---- | ---- | ----- | ---- | ----- | ----- |  
	 | m2    | 7.92 | 5.59 | 0.008 | 0.11 | 0.003 | 0.007 |  
	 | k1    | 5.56 | 5.46 | 0.008 | 0.03 | 0.001 | 0.008 |  
	-----------------------------------------------------------
 
Calculate hsal and beta. 
   a) Interpolate h to the reg [1440 x 720] lat-lon grid...   done (CPU: 0.14294, Wall: 0.149)
   b) Spherical harmonic analysis... done (CPU: 1.2817, Wall: 1.282)
   c) Spherical harmonic synthesis... done (CPU: 1.4329, Wall: 1.432)
   d) Interpolate hsal onto the original grid... done (CPU: 0.14197, Wall: 0.142)
   e) Calculate beta (averaged over 5ยบ)... matgen   done (CPU: 6.20117E-02, Wall: 6.3E-02)
   e) coo_mat_mul 5ยบ)...   done (CPU: 5.6552, Wall: 5.657)
done (CPU: 8.8517, Wall: 8.858)
   a) Interpolate h to the reg [1440 x 720] lat-lon grid...   done (CPU: 0.14404, Wall: 0.144)
   b) Spherical harmonic analysis... done (CPU: 0.94788, Wall: 0.947)
   c) Spherical harmonic synthesis... done (CPU: 1.1388, Wall: 1.14)
   d) Interpolate hsal onto the original grid... done (CPU: 0.14197, Wall: 0.143)
   e) Calculate beta (averaged over 5ยบ)... matgen   done (CPU: 6.29883E-02, Wall: 6.3E-02)
   e) coo_mat_mul 5ยบ)...   done (CPU: 5.6501, Wall: 5.652)
done (CPU: 8.2188, Wall: 8.22)
  Welcome to calc_dhat: Projecting: ******** done (CPU: 10.056, Wall: 10.057)
  Storing: ** done (CPU: 0.256, Wall: 0.256)
===>>> Total time spent on Iteration 6:  3:17.017 CPU, 53.977  Wall
==============
 Iteration 7
==============
 1. for m2: assembling the matrix and rhs, implementing b.c. 
   b) Factorization... done (3.0Gb).    c) Solve... done (CPU: 1:14.777, Wall: 9.800)
 2. for k1: assembling the matrix and rhs, implementing b.c. 
   b) Factorization... done (3.0Gb).    c) Solve... done (CPU: 1:13.334, Wall: 9.685)
	-----------------------------------------------------------
	 | Convg |  du  |  dv  |  duv% |  dh  | dhbar |  dh%  | 	
	 | ----- | ---- | ---- | ----- | ---- | ----- | ----- |  
	 | m2    | 4.01 | 2.76 | 0.004 | 0.05 | 0.001 | 0.003 |  
	 | k1    | 2.57 | 2.56 | 0.004 | 0.02 | 0.000 | 0.004 |  
	-----------------------------------------------------------
 
Calculate hsal and beta. 
   a) Interpolate h to the reg [1440 x 720] lat-lon grid...   done (CPU: 0.14307, Wall: 0.143)
   b) Spherical harmonic analysis... done (CPU: 1.2748, Wall: 1.275)
   c) Spherical harmonic synthesis... done (CPU: 1.3948, Wall: 1.395)
   d) Interpolate hsal onto the original grid... done (CPU: 0.14197, Wall: 0.142)
   e) Calculate beta (averaged over 5ยบ)... matgen   done (CPU: 6.39648E-02, Wall: 6.4E-02)
   e) coo_mat_mul 5ยบ)...   done (CPU: 5.6492, Wall: 5.65)
done (CPU: 8.8007, Wall: 8.801)
   a) Interpolate h to the reg [1440 x 720] lat-lon grid...   done (CPU: 0.14392, Wall: 0.144)
   b) Spherical harmonic analysis... done (CPU: 0.94885, Wall: 0.949)
   c) Spherical harmonic synthesis... done (CPU: 1.0818, Wall: 1.083)
   d) Interpolate hsal onto the original grid... done (CPU: 0.14307, Wall: 0.143)
   e) Calculate beta (averaged over 5ยบ)... matgen   done (CPU: 6.39648E-02, Wall: 6.4E-02)
   e) coo_mat_mul 5ยบ)...   done (CPU: 5.6521, Wall: 5.653)
done (CPU: 8.1667, Wall: 8.168)
  Welcome to calc_dhat: Projecting: ******** done (CPU: 10.053, Wall: 10.055)
  Storing: ** done (CPU: 0.255, Wall: 0.257)
===>>> Total time spent on Iteration 7:  3:10.510 CPU, 53.736  Wall
========================================================================
========================================================================
 
===>>> Total time spent on solving the system: 23:09.167 CPU, 6:38.406  Wall
 
-----------------------------------------------------------------------------
m2:	KE = 331.1 PJ, PE = 298.5 PJ, D = 2.912 TW.
	D_BL = 2.302 TW, D_IT = 0.602 TW, D_SAL = 0.004 GW, D_f = -0.081 GW.
	---------------------------------------------------------------------
	 | **** | Total | Shallow |  Deep | Coastal |  Open | 	
	 | ---- | ----- | ------- | ----- | ------- | ----- |  
	 | D_BL | 2.302 |  2.287  | 0.015 |  2.266  | 0.035 |  
	 | D_IT | 0.602 |  0.394  | 0.208 |  0.478  | 0.124 |  
	 | D    | 2.904 |  2.681  | 0.223 |  2.745  | 0.159 |  
-----------------------------------------------------------------------------
k1:	KE = 43.0 PJ, PE = 24.6 PJ, D = 0.289 TW.
	D_BL = 0.223 TW, D_IT = 0.066 TW, D_SAL = 0.001 GW, D_f = -0.461 GW.
	---------------------------------------------------------------------
	 | **** | Total | Shallow |  Deep | Coastal |  Open | 	
	 | ---- | ----- | ------- | ----- | ------- | ----- |  
	 | D_BL | 0.223 |  0.220  | 0.003 |  0.206  | 0.017 |  
	 | D_IT | 0.066 |  0.036  | 0.030 |  0.055  | 0.011 |  
	 | D    | 0.289 |  0.256  | 0.033 |  0.261  | 0.028 |  
Cleaning up temporary files 
[H[2JSaving data as 2012_11_26__11_22
Loading topography file:  done.
Interpolating topo to 15.00 min resolution global grid:  done.
****** Ocean is in the first/last tau index of H_hg. Removed ******
Removing bays and inlets: 1371 + 335 + 156 + 78 + 48 + 31 + 21 + 16 + 13 + 8 + 4 + 3 + 3 + 2 + 0.
Removing inland seas/lakes: found 26 connected components; removed 23 of size < 144 cells.
Allocating grid points: 679779 for u, 683462 for v, 675152  for h.
Making vectors: tau, H, evaluating on the u-, v-, h-grid (CPU: 0.1s, Wall:0.1s)
Making matrices:
 - d/dph and 1 for h-grid functions, evaluating on the u-grid (CPU: 0.1s, Wall:0.1s)
 - d/dta and 1 for h grid functions, evaluating on the v-grid (CPU: 0.1s, Wall:0.1s)
 - d/dph and 1 for u-grid functions, evaluating on the h-grid (CPU: 0.1s, Wall:0.1s)
 - d/dta and 1 for v-grid functions, evaluating on the h-grid (CPU: 0.1s, Wall:0.1s)
 - v & fv,     			     evaluating on the u-grid (CPU: 0.5s, Wall:0.5s)
 - u & fu,     			     evaluating on the v-grid (CPU: 0.5s, Wall:0.5s)
Saving matrices: done.
Preparing matrices: GHU, GHV, KU, KV, v2uf, u2vf, Linear BBL, Linear ITD (1 matrix per constituent), b.c.  Done.
====================================
Welcome to baro_solver (nonlinear)
====================================
==============
 Iteration 1
==============
Have [2.04E+06 x 2.04E+06] sparse matrix (nnz = 1.28E+07). Solve with pardiso.
 1. for m2: assembling the matrix and rhs, implementing b.c. 
   a) Reordering... done (peak-1.6Gb; permanent-1.3Gb) 
      Size of matrix factors 3.0Gb < 20.0Gb RAM+Swap. Running in-core with peak memory usage: 4.3Gb.
   b) Factorization... done (3.0Gb).    c) Solve... done (CPU: 1:51.698, Wall: 28.615)
 2. for k1: assembling the matrix and rhs, implementing b.c. 
   b) Factorization... done (3.0Gb).    c) Solve... done (CPU: 1:16.616, Wall: 10.074)
	-----------------------------------------------------------
	 | Convg |   du   |   dv   |  duv%  |  dh  | dhbar |  dh%  | 	
	 | ----- | ------ | ------ | ------ | ---- | ----- | ----- |  
	 | m2    | 670.90 | 467.46 | 54.091 | 8.96 | 0.403 | 0.403 |  
	 | k1    | 805.59 | 672.91 | 15.010 | 3.04 | 0.108 | 0.108 |  
	-----------------------------------------------------------
 
Calculate hsal and beta. 
   a) Interpolate h to the reg [1440 x 720] lat-lon grid...   done (CPU: 0.14398, Wall: 0.146)
   b) Spherical harmonic analysis... done (CPU: 4.7783, Wall: 4.805)
   c) Spherical harmonic synthesis... done (CPU: 2.5086, Wall: 2.51)
   d) Interpolate hsal onto the original grid... done (CPU: 0.14197, Wall: 0.143)
   e) Calculate beta (averaged over 5ยบ)... matgen   done (CPU: 6.29883E-02, Wall: 6.3E-02)
   e) coo_mat_mul 5ยบ)...   done (CPU: 5.6691, Wall: 5.67)
done (CPU: 13.439, Wall: 13.469)
   a) Interpolate h to the reg [1440 x 720] lat-lon grid...   done (CPU: 0.14497, Wall: 0.144)
   b) Spherical harmonic analysis... done (CPU: 0.96185, Wall: 0.961)
   c) Spherical harmonic synthesis... done (CPU: 1.1248, Wall: 1.125)
   d) Interpolate hsal onto the original grid... done (CPU: 0.14198, Wall: 0.142)
   e) Calculate beta (averaged over 5ยบ)... matgen   done (CPU: 6.29883E-02, Wall: 6.2E-02)
   e) coo_mat_mul 5ยบ)...   done (CPU: 5.6571, Wall: 5.657)
done (CPU: 8.2247, Wall: 8.225)
  Welcome to calc_dhat: Projecting: ******** done (CPU: 10.049, Wall: 10.050)
  Storing: ** done (CPU: 0.275, Wall: 0.277)
===>>> Total time spent on Iteration 1:  4:00.601 CPU,  1:17.866  Wall
==============
 Iteration 2
==============
 1. for m2: assembling the matrix and rhs, implementing b.c. 
   b) Factorization... done (3.0Gb).    c) Solve... done (CPU: 1:16.177, Wall: 10.050)
 2. for k1: assembling the matrix and rhs, implementing b.c. 
   b) Factorization... done (3.0Gb).    c) Solve... done (CPU: 1:15.988, Wall: 9.989)
	-----------------------------------------------------------
	 | Convg |   du   |   dv   |  duv% |  dh  | dhbar |  dh%  | 	
	 | ----- | ------ | ------ | ----- | ---- | ----- | ----- |  
	 | m2    |  85.67 | 163.55 | 0.297 | 3.16 | 0.062 | 0.263 |  
	 | k1    | 290.06 | 243.15 | 0.296 | 0.66 | 0.015 | 0.259 |  
	-----------------------------------------------------------
 
Calculate hsal and beta. 
   a) Interpolate h to the reg [1440 x 720] lat-lon grid...   done (CPU: 0.14499, Wall: 0.145)
   b) Spherical harmonic analysis... done (CPU: 1.3138, Wall: 1.321)
   c) Spherical harmonic synthesis... done (CPU: 1.4608, Wall: 1.461)
   d) Interpolate hsal onto the original grid... done (CPU: 0.14197, Wall: 0.142)
   e) Calculate beta (averaged over 5ยบ)... matgen   done (CPU: 6.39954E-02, Wall: 6.4E-02)
   e) coo_mat_mul 5ยบ)...   done (CPU: 5.6391, Wall: 5.641)
done (CPU: 8.9016, Wall: 8.91)
   a) Interpolate h to the reg [1440 x 720] lat-lon grid...   done (CPU: 0.14398, Wall: 0.144)
   b) Spherical harmonic analysis... done (CPU: 0.96185, Wall: 0.96)
   c) Spherical harmonic synthesis... done (CPU: 1.0699, Wall: 1.069)
   d) Interpolate hsal onto the original grid... done (CPU: 0.14197, Wall: 0.142)
   e) Calculate beta (averaged over 5ยบ)... matgen   done (CPU: 6.29883E-02, Wall: 6.3E-02)
   e) coo_mat_mul 5ยบ)...   done (CPU: 5.6481, Wall: 5.648)
done (CPU: 8.1617, Wall: 8.16)
  Welcome to calc_dhat: Projecting: ******** done (CPU: 10.038, Wall: 10.038)
  Storing: ** done (CPU: 0.258, Wall: 0.259)
===>>> Total time spent on Iteration 2:  3:15.322 CPU, 55.419  Wall
==============
 Iteration 3
==============
 1. for m2: assembling the matrix and rhs, implementing b.c. 
   b) Factorization... done (3.0Gb).    c) Solve... done (CPU: 1:16.150, Wall: 10.001)
 2. for k1: assembling the matrix and rhs, implementing b.c. 
   b) Factorization... done (3.0Gb).    c) Solve... done (CPU: 1:15.213, Wall: 9.779)
	-----------------------------------------------------------
	 | Convg |   du  |   dv  |  duv% |  dh  | dhbar |  dh%  | 	
	 | ----- | ----- | ----- | ----- | ---- | ----- | ----- |  
	 | m2    | 45.88 | 73.28 | 0.091 | 1.15 | 0.024 | 0.084 |  
	 | k1    | 89.64 | 78.88 | 0.080 | 0.26 | 0.006 | 0.084 |  
	-----------------------------------------------------------
 
Calculate hsal and beta. 
   a) Interpolate h to the reg [1440 x 720] lat-lon grid...   done (CPU: 0.14301, Wall: 0.143)
   b) Spherical harmonic analysis... done (CPU: 1.2748, Wall: 1.274)
   c) Spherical harmonic synthesis... done (CPU: 1.4098, Wall: 1.411)
   d) Interpolate hsal onto the original grid... done (CPU: 0.14301, Wall: 0.143)
   e) Calculate beta (averaged over 5ยบ)... matgen   done (CPU: 6.39648E-02, Wall: 6.4E-02)
   e) coo_mat_mul 5ยบ)...   done (CPU: 5.6531, Wall: 5.654)
done (CPU: 8.8217, Wall: 8.821)
   a) Interpolate h to the reg [1440 x 720] lat-lon grid...   done (CPU: 0.14496, Wall: 0.148)
   b) Spherical harmonic analysis... done (CPU: 0.95886, Wall: 0.962)
   c) Spherical harmonic synthesis... done (CPU: 1.0848, Wall: 1.085)
   d) Interpolate hsal onto the original grid... done (CPU: 0.14197, Wall: 0.142)
   e) Calculate beta (averaged over 5ยบ)... matgen   done (CPU: 6.39648E-02, Wall: 6.4E-02)
   e) coo_mat_mul 5ยบ)...   done (CPU: 5.6482, Wall: 5.65)
done (CPU: 8.1768, Wall: 8.185)
  Welcome to calc_dhat: Projecting: ******** done (CPU: 10.012, Wall: 10.019)
  Storing: ** done (CPU: 0.255, Wall: 0.255)
===>>> Total time spent on Iteration 3:  3:19.977 CPU, 53.962  Wall
==============
 Iteration 4
==============
 1. for m2: assembling the matrix and rhs, implementing b.c. 
   b) Factorization... done (3.0Gb).    c) Solve... done (CPU: 1:15.918, Wall: 9.974)
 2. for k1: assembling the matrix and rhs, implementing b.c. 
   b) Factorization... done (3.0Gb).    c) Solve... done (CPU: 1:15.512, Wall: 9.869)
	-----------------------------------------------------------
	 | Convg |   du  |   dv  |  duv% |  dh  | dhbar |  dh%  | 	
	 | ----- | ----- | ----- | ----- | ---- | ----- | ----- |  
	 | m2    | 25.28 | 29.48 | 0.040 | 0.47 | 0.011 | 0.039 |  
	 | k1    | 28.65 | 24.99 | 0.034 | 0.12 | 0.003 | 0.035 |  
	-----------------------------------------------------------
 
Calculate hsal and beta. 
   a) Interpolate h to the reg [1440 x 720] lat-lon grid...   done (CPU: 0.14301, Wall: 0.143)
   b) Spherical harmonic analysis... done (CPU: 1.2758, Wall: 1.276)
   c) Spherical harmonic synthesis... done (CPU: 1.4258, Wall: 1.426)
   d) Interpolate hsal onto the original grid... done (CPU: 0.14197, Wall: 0.142)
   e) Calculate beta (averaged over 5ยบ)... matgen   done (CPU: 6.50024E-02, Wall: 6.4E-02)
   e) coo_mat_mul 5ยบ)...   done (CPU: 5.6531, Wall: 5.654)
done (CPU: 8.8386, Wall: 8.839)
   a) Interpolate h to the reg [1440 x 720] lat-lon grid...   done (CPU: 0.14294, Wall: 0.144)
   b) Spherical harmonic analysis... done (CPU: 0.95984, Wall: 0.96)
   c) Spherical harmonic synthesis... done (CPU: 1.0798, Wall: 1.081)
   d) Interpolate hsal onto the original grid... done (CPU: 0.14301, Wall: 0.143)
   e) Calculate beta (averaged over 5ยบ)... matgen   done (CPU: 6.39648E-02, Wall: 6.4E-02)
   e) coo_mat_mul 5ยบ)...   done (CPU: 5.6401, Wall: 5.641)
done (CPU: 8.1638, Wall: 8.165)
  Welcome to calc_dhat: Projecting: ******** done (CPU: 10.050, Wall: 10.050)
  Storing: ** done (CPU: 0.258, Wall: 0.259)
===>>> Total time spent on Iteration 4:  3:15.618 CPU, 54.116  Wall
==============
 Iteration 5
==============
 1. for m2: assembling the matrix and rhs, implementing b.c. 
   b) Factorization... done (3.0Gb).    c) Solve... done (CPU: 1:15.053, Wall: 9.793)
 2. for k1: assembling the matrix and rhs, implementing b.c. 
   b) Factorization... done (3.0Gb).    c) Solve... done (CPU: 1:16.953, Wall: 10.112)
	-----------------------------------------------------------
	 | Convg |   du  |   dv  |  duv% |  dh  | dhbar |  dh%  | 	
	 | ----- | ----- | ----- | ----- | ---- | ----- | ----- |  
	 | m2    | 13.24 | 11.46 | 0.018 | 0.24 | 0.005 | 0.017 |  
	 | k1    | 11.11 | 10.67 | 0.016 | 0.06 | 0.001 | 0.016 |  
	-----------------------------------------------------------
 
Calculate hsal and beta. 
   a) Interpolate h to the reg [1440 x 720] lat-lon grid...   done (CPU: 0.14294, Wall: 0.144)
   b) Spherical harmonic analysis... done (CPU: 1.2788, Wall: 1.28)
   c) Spherical harmonic synthesis... done (CPU: 1.4608, Wall: 1.461)
   d) Interpolate hsal onto the original grid... done (CPU: 0.14301, Wall: 0.142)
   e) Calculate beta (averaged over 5ยบ)... matgen   done (CPU: 6.29883E-02, Wall: 6.3E-02)
   e) coo_mat_mul 5ยบ)...   done (CPU: 5.6631, Wall: 5.663)
done (CPU: 8.8846, Wall: 8.885)
   a) Interpolate h to the reg [1440 x 720] lat-lon grid...   done (CPU: 0.14496, Wall: 0.145)
   b) Spherical harmonic analysis... done (CPU: 0.95886, Wall: 0.957)
   c) Spherical harmonic synthesis... done (CPU: 1.1098, Wall: 1.11)
   d) Interpolate hsal onto the original grid... done (CPU: 0.14197, Wall: 0.143)
   e) Calculate beta (averaged over 5ยบ)... matgen   done (CPU: 6.20117E-02, Wall: 6.3E-02)
   e) coo_mat_mul 5ยบ)...   done (CPU: 5.6582, Wall: 5.659)
done (CPU: 8.2088, Wall: 8.208)
  Welcome to calc_dhat: Projecting: ******** done (CPU: 10.038, Wall: 10.038)
  Storing: ** done (CPU: 0.255, Wall: 0.256)
===>>> Total time spent on Iteration 5:  3:14.895 CPU, 54.106  Wall
==============
 Iteration 6
==============
 1. for m2: assembling the matrix and rhs, implementing b.c. 
   b) Factorization... done (3.0Gb).    c) Solve... done (CPU: 1:15.352, Wall: 9.887)
 2. for k1: assembling the matrix and rhs, implementing b.c. 
   b) Factorization... done (3.0Gb).    c) Solve... done (CPU: 1:15.020, Wall: 9.850)
	-----------------------------------------------------------
	 | Convg |  du  |  dv  |  duv% |  dh  | dhbar |  dh%  | 	
	 | ----- | ---- | ---- | ----- | ---- | ----- | ----- |  
	 | m2    | 6.75 | 5.44 | 0.008 | 0.12 | 0.002 | 0.008 |  
	 | k1    | 4.90 | 5.66 | 0.008 | 0.03 | 0.001 | 0.008 |  
	-----------------------------------------------------------
 
Calculate hsal and beta. 
   a) Interpolate h to the reg [1440 x 720] lat-lon grid...   done (CPU: 0.14294, Wall: 0.144)
   b) Spherical harmonic analysis... done (CPU: 1.2769, Wall: 1.281)
   c) Spherical harmonic synthesis... done (CPU: 1.4117, Wall: 1.412)
   d) Interpolate hsal onto the original grid... done (CPU: 0.14307, Wall: 0.142)
   e) Calculate beta (averaged over 5ยบ)... matgen   done (CPU: 6.39648E-02, Wall: 6.4E-02)
   e) coo_mat_mul 5ยบ)...   done (CPU: 5.6431, Wall: 5.644)
done (CPU: 8.8146, Wall: 8.822)
   a) Interpolate h to the reg [1440 x 720] lat-lon grid...   done (CPU: 0.14392, Wall: 0.145)
   b) Spherical harmonic analysis... done (CPU: 0.96082, Wall: 0.961)
   c) Spherical harmonic synthesis... done (CPU: 1.1289, Wall: 1.128)
   d) Interpolate hsal onto the original grid... done (CPU: 0.14209, Wall: 0.142)
   e) Calculate beta (averaged over 5ยบ)... matgen   done (CPU: 6.39648E-02, Wall: 6.4E-02)
   e) coo_mat_mul 5ยบ)...   done (CPU: 5.6431, Wall: 5.644)
done (CPU: 8.2147, Wall: 8.216)
  Welcome to calc_dhat: Projecting: ******** done (CPU: 10.054, Wall: 10.053)
  Storing: ** done (CPU: 0.257, Wall: 0.258)
===>>> Total time spent on Iteration 6:  3:17.882 CPU, 54.062  Wall
==============
 Iteration 7
==============
 1. for m2: assembling the matrix and rhs, implementing b.c. 
   b) Factorization... done (3.0Gb).    c) Solve... done (CPU: 1:15.914, Wall: 9.888)
 2. for k1: assembling the matrix and rhs, implementing b.c. 
   b) Factorization... done (3.0Gb).    c) Solve... done (CPU: 1:15.629, Wall: 9.890)
	-----------------------------------------------------------
	 | Convg |  du  |  dv  |  duv% |  dh  | dhbar |  dh%  | 	
	 | ----- | ---- | ---- | ----- | ---- | ----- | ----- |  
	 | m2    | 3.41 | 2.79 | 0.004 | 0.06 | 0.001 | 0.004 |  
	 | k1    | 2.32 | 3.01 | 0.004 | 0.01 | 0.000 | 0.004 |  
	-----------------------------------------------------------
 
Calculate hsal and beta. 
   a) Interpolate h to the reg [1440 x 720] lat-lon grid...   done (CPU: 0.14294, Wall: 0.143)
   b) Spherical harmonic analysis... done (CPU: 1.2709, Wall: 1.272)
   c) Spherical harmonic synthesis... done (CPU: 1.3818, Wall: 1.391)
   d) Interpolate hsal onto the original grid... done (CPU: 0.14197, Wall: 0.143)
   e) Calculate beta (averaged over 5ยบ)... matgen   done (CPU: 6.20117E-02, Wall: 6.3E-02)
   e) coo_mat_mul 5ยบ)...   done (CPU: 5.6571, Wall: 5.665)
done (CPU: 8.7916, Wall: 8.811)
   a) Interpolate h to the reg [1440 x 720] lat-lon grid...   done (CPU: 0.14502, Wall: 0.145)
   b) Spherical harmonic analysis... done (CPU: 0.95984, Wall: 0.971)
   c) Spherical harmonic synthesis... done (CPU: 1.0748, Wall: 1.075)
   d) Interpolate hsal onto the original grid... done (CPU: 0.14197, Wall: 0.143)
   e) Calculate beta (averaged over 5ยบ)... matgen   done (CPU: 6.29883E-02, Wall: 6.3E-02)
   e) coo_mat_mul 5ยบ)...   done (CPU: 5.6561, Wall: 5.656)
done (CPU: 8.1727, Wall: 8.187)
  Welcome to calc_dhat: Projecting: ******** done (CPU: 10.050, Wall: 10.052)
  Storing: ** done (CPU: 0.256, Wall: 0.257)
===>>> Total time spent on Iteration 7:  3:16.639 CPU, 54.067  Wall
========================================================================
========================================================================
 
===>>> Total time spent on solving the system: 23:40.948 CPU, 6:43.614  Wall
 
-----------------------------------------------------------------------------
m2:	KE = 242.8 PJ, PE = 214.2 PJ, D = 2.822 TW.
	D_BL = 1.592 TW, D_IT = 1.225 TW, D_SAL = 0.003 GW, D_f = -0.048 GW.
	---------------------------------------------------------------------
	 | **** | Total | Shallow |  Deep | Coastal |  Open | 	
	 | ---- | ----- | ------- | ----- | ------- | ----- |  
	 | D_BL | 1.592 |  1.583  | 0.009 |  1.570  | 0.022 |  
	 | D_IT | 1.225 |  0.235  | 0.990 |  0.587  | 0.638 |  
	 | D    | 2.817 |  1.818  | 0.999 |  2.157  | 0.659 |  
-----------------------------------------------------------------------------
k1:	KE = 38.4 PJ, PE = 22.0 PJ, D = 0.322 TW.
	D_BL = 0.184 TW, D_IT = 0.139 TW, D_SAL = 0.001 GW, D_f = -0.416 GW.
	---------------------------------------------------------------------
	 | **** | Total | Shallow |  Deep | Coastal |  Open | 	
	 | ---- | ----- | ------- | ----- | ------- | ----- |  
	 | D_BL | 0.184 |  0.182  | 0.002 |  0.171  | 0.013 |  
	 | D_IT | 0.139 |  0.019  | 0.119 |  0.082  | 0.056 |  
	 | D    | 0.322 |  0.201  | 0.121 |  0.254  | 0.069 |  
Cleaning up temporary files 
[H[2JSaving data as 2012_11_27__14_32
Loading topography file:  done.
Interpolating topo to 15.00 min resolution global grid:  done.
****** Ocean is in the first/last tau index of H_hg. Removed ******
Removing bays and inlets: 1371 + 335 + 156 + 78 + 48 + 31 + 21 + 16 + 13 + 8 + 4 + 3 + 3 + 2 + 0.
Removing inland seas/lakes: found 26 connected components; removed 23 of size < 144 cells.
Smoothing topography for the linear ITD scheme: Loading topography file:  done.
done (CPU: 2.524, Wall: 8.123)
Allocating grid points: 679779 for u, 683462 for v, 675152  for h.
Making vectors: tau, H, evaluating on the u-, v-, h-grid (CPU: 0.1s, Wall:0.1s)
Making matrices:
 - d/dph and 1 for h-grid functions, evaluating on the u-grid (CPU: 0.1s, Wall:0.1s)
 - d/dta and 1 for h grid functions, evaluating on the v-grid (CPU: 0.1s, Wall:0.1s)
 - d/dph and 1 for u-grid functions, evaluating on the h-grid (CPU: 0.1s, Wall:0.1s)
 - d/dta and 1 for v-grid functions, evaluating on the h-grid (CPU: 0.1s, Wall:0.1s)
 - v & fv,     			     evaluating on the u-grid (CPU: 0.6s, Wall:0.6s)
 - u & fu,     			     evaluating on the v-grid (CPU: 0.6s, Wall:0.6s)
Saving matrices: done.
Preparing matrices: GHU, GHV, KU, KV, v2uf, u2vf, Linear BBL, Linear ITD (1 matrix per constituent), b.c.  Done.
====================================
Welcome to baro_solver (nonlinear)
====================================
==============
 Iteration 1
==============
Have [2.04E+06 x 2.04E+06] sparse matrix (nnz = 1.28E+07). Solve with pardiso.
 1. for m2: assembling the matrix and rhs, implementing b.c. 
   a) Reordering... done (peak-1.6Gb; permanent-1.3Gb) 
      Size of matrix factors 2.9Gb < 20.0Gb RAM+Swap. Running in-core with peak memory usage: 4.2Gb.
   b) Factorization... done (2.9Gb).    c) Solve... done (CPU: 3:28.382, Wall: 1:08.609)
 2. for k1: assembling the matrix and rhs, implementing b.c. 
   b) Factorization... done (2.9Gb).    c) Solve... done (CPU: 1:38.566, Wall: 14.612)
	-----------------------------------------------------------
	 | Convg |   du   |   dv   |  duv%  |  dh  | dhbar |  dh%  | 	
	 | ----- | ------ | ------ | ------ | ---- | ----- | ----- |  
	 | m2    | 741.61 | 515.85 | 58.205 | 9.75 | 0.437 | 0.437 |  
	 | k1    | 822.84 | 688.58 | 15.355 | 3.11 | 0.111 | 0.111 |  
	-----------------------------------------------------------
 
Calculate hsal and beta. 
   a) Interpolate h to the reg [1440 x 720] lat-lon grid...   done (CPU: 0.14697, Wall: 0.149)
   b) Spherical harmonic analysis... done (CPU: 4.7303, Wall: 4.746)
   c) Spherical harmonic synthesis... done (CPU: 2.5276, Wall: 2.529)
   d) Interpolate hsal onto the original grid... done (CPU: 0.142, Wall: 0.142)
   e) Calculate beta (averaged over 5ยบ)... matgen   done (CPU: 6.39648E-02, Wall: 0.253)
   e) coo_mat_mul 5ยบ)...   done (CPU: 5.6852, Wall: 5.685)
done (CPU: 13.431, Wall: 13.637)
   a) Interpolate h to the reg [1440 x 720] lat-lon grid...   done (CPU: 0.14398, Wall: 0.144)
   b) Spherical harmonic analysis... done (CPU: 0.94785, Wall: 0.948)
   c) Spherical harmonic synthesis... done (CPU: 1.1048, Wall: 1.105)
   d) Interpolate hsal onto the original grid... done (CPU: 0.142, Wall: 0.142)
   e) Calculate beta (averaged over 5ยบ)... matgen   done (CPU: 6.29883E-02, Wall: 6.3E-02)
   e) coo_mat_mul 5ยบ)...   done (CPU: 5.6781, Wall: 5.678)
done (CPU: 8.2097, Wall: 8.211)
  Welcome to calc_dhat: Projecting: ******** done (CPU: 10.068, Wall: 10.130)
  Storing: ** done (CPU: 0.281, Wall: 0.282)
===>>> Total time spent on Iteration 1:  5:55.718 CPU,  2:06.193  Wall
==============
 Iteration 2
==============
 1. for m2: assembling the matrix and rhs, implementing b.c. 
   b) Factorization... done (2.9Gb).    c) Solve... done (CPU: 1:44.647, Wall: 15.597)
 2. for k1: assembling the matrix and rhs, implementing b.c. 
   b) Factorization... done (2.9Gb).    c) Solve... done (CPU: 1:28.802, Wall: 13.276)
	-----------------------------------------------------------
	 | Convg |   du   |   dv   |  duv% |  dh  | dhbar |  dh%  | 	
	 | ----- | ------ | ------ | ----- | ---- | ----- | ----- |  
	 | m2    |  88.24 | 163.43 | 0.294 | 3.15 | 0.068 | 0.270 |  
	 | k1    | 299.38 | 250.20 | 0.290 | 0.64 | 0.015 | 0.263 |  
	-----------------------------------------------------------
 
Calculate hsal and beta. 
   a) Interpolate h to the reg [1440 x 720] lat-lon grid...   done (CPU: 0.14496, Wall: 0.145)
   b) Spherical harmonic analysis... done (CPU: 1.4008, Wall: 1.552)
   c) Spherical harmonic synthesis... done (CPU: 1.5758, Wall: 2.105)
   d) Interpolate hsal onto the original grid... done (CPU: 0.14899, Wall: 0.231)
   e) Calculate beta (averaged over 5ยบ)... matgen   done (CPU: 6.89697E-02, Wall: 0.129)
   e) coo_mat_mul 5ยบ)...   done (CPU: 5.9741, Wall: 7.046)
done (CPU: 9.4536, Wall: 11.345)
   a) Interpolate h to the reg [1440 x 720] lat-lon grid...   done (CPU: 0.14899, Wall: 0.18)
   b) Spherical harmonic analysis... done (CPU: 1.0048, Wall: 1.375)
   c) Spherical harmonic synthesis... done (CPU: 1.1238, Wall: 1.197)
   d) Interpolate hsal onto the original grid... done (CPU: 0.14801, Wall: 0.149)
   e) Calculate beta (averaged over 5ยบ)... matgen   done (CPU: 6.5979E-02, Wall: 6.6E-02)
   e) coo_mat_mul 5ยบ)...   done (CPU: 5.9671, Wall: 6.585)
done (CPU: 8.5987, Wall: 9.754)
  Welcome to calc_dhat: Projecting: ******** done (CPU: 10.971, Wall: 12.977)
  Storing: ** done (CPU: 0.274, Wall: 0.276)
===>>> Total time spent on Iteration 2:  3:59.437 CPU,  1:12.496  Wall
==============
 Iteration 3
==============
 1. for m2: assembling the matrix and rhs, implementing b.c. 
   b) Factorization... done (2.9Gb).    c) Solve... done (CPU: 1:23.470, Wall: 12.965)
 2. for k1: assembling the matrix and rhs, implementing b.c. 
   b) Factorization... done (2.9Gb).    c) Solve... done (CPU: 2:21.265, Wall: 36.520)
	-----------------------------------------------------------
	 | Convg |   du  |   dv  |  duv% |  dh  | dhbar |  dh%  | 	
	 | ----- | ----- | ----- | ----- | ---- | ----- | ----- |  
	 | m2    | 50.40 | 72.57 | 0.091 | 1.14 | 0.026 | 0.084 |  
	 | k1    | 93.00 | 81.75 | 0.078 | 0.25 | 0.006 | 0.087 |  
	-----------------------------------------------------------
 
Calculate hsal and beta. 
   a) Interpolate h to the reg [1440 x 720] lat-lon grid...   done (CPU: 0.14893, Wall: 0.151)
   b) Spherical harmonic analysis... done (CPU: 1.3398, Wall: 1.349)
   c) Spherical harmonic synthesis... done (CPU: 1.4988, Wall: 1.526)
   d) Interpolate hsal onto the original grid... done (CPU: 0.14899, Wall: 0.148)
   e) Calculate beta (averaged over 5ยบ)... matgen   done (CPU: 6.5979E-02, Wall: 6.6E-02)
   e) coo_mat_mul 5ยบ)...   done (CPU: 5.9791, Wall: 7.572)
done (CPU: 9.3206, Wall: 10.966)
   a) Interpolate h to the reg [1440 x 720] lat-lon grid...   done (CPU: 0.15295, Wall: 0.154)
   b) Spherical harmonic analysis... done (CPU: 1.0548, Wall: 1.065)
   c) Spherical harmonic synthesis... done (CPU: 1.1768, Wall: 1.707)
   d) Interpolate hsal onto the original grid... done (CPU: 0.15094, Wall: 0.151)
   e) Calculate beta (averaged over 5ยบ)... matgen   done (CPU: 6.90308E-02, Wall: 0.137)
   e) coo_mat_mul 5ยบ)...   done (CPU: 5.9831, Wall: 6.789)
done (CPU: 8.7307, Wall: 10.145)
  Welcome to calc_dhat: Projecting: ******** done (CPU: 10.276, Wall: 10.277)
  Storing: ** done (CPU: 0.257, Wall: 0.285)
===>>> Total time spent on Iteration 3:  4:28.169 CPU,  1:29.969  Wall
==============
 Iteration 4
==============
 1. for m2: assembling the matrix and rhs, implementing b.c. 
   b) Factorization... done (2.9Gb).    c) Solve... done (CPU: 1:43.141, Wall: 15.385)
 2. for k1: assembling the matrix and rhs, implementing b.c. 
   b) Factorization... done (2.9Gb).    c) Solve... done (CPU: 1:46.322, Wall: 15.732)
	-----------------------------------------------------------
	 | Convg |   du  |   dv  |  duv% |  dh  | dhbar |  dh%  | 	
	 | ----- | ----- | ----- | ----- | ---- | ----- | ----- |  
	 | m2    | 27.26 | 28.80 | 0.038 | 0.45 | 0.011 | 0.036 |  
	 | k1    | 29.67 | 25.76 | 0.034 | 0.13 | 0.003 | 0.035 |  
	-----------------------------------------------------------
 
Calculate hsal and beta. 
   a) Interpolate h to the reg [1440 x 720] lat-lon grid...   done (CPU: 0.1449, Wall: 0.146)
   b) Spherical harmonic analysis... done (CPU: 1.2728, Wall: 1.406)
   c) Spherical harmonic synthesis... done (CPU: 1.4218, Wall: 1.437)
   d) Interpolate hsal onto the original grid... done (CPU: 0.14099, Wall: 0.141)
   e) Calculate beta (averaged over 5ยบ)... matgen   done (CPU: 6.39648E-02, Wall: 9.3E-02)
   e) coo_mat_mul 5ยบ)...   done (CPU: 5.6722, Wall: 5.672)
done (CPU: 8.8496, Wall: 9.051)
   a) Interpolate h to the reg [1440 x 720] lat-lon grid...   done (CPU: 0.14392, Wall: 0.144)
   b) Spherical harmonic analysis... done (CPU: 0.9519, Wall: 0.952)
   c) Spherical harmonic synthesis... done (CPU: 1.1049, Wall: 1.104)
   d) Interpolate hsal onto the original grid... done (CPU: 0.14099, Wall: 0.141)
   e) Calculate beta (averaged over 5ยบ)... matgen   done (CPU: 6.29883E-02, Wall: 6.3E-02)
   e) coo_mat_mul 5ยบ)...   done (CPU: 5.6602, Wall: 5.66)
done (CPU: 8.1948, Wall: 8.194)
  Welcome to calc_dhat: Projecting: ******** done (CPU: 10.067, Wall: 10.067)
  Storing: ** done (CPU: 0.254, Wall: 0.255)
===>>> Total time spent on Iteration 4:  4:15.797 CPU,  1:06.848  Wall
==============
 Iteration 5
==============
 1. for m2: assembling the matrix and rhs, implementing b.c. 
   b) Factorization... done (2.9Gb).    c) Solve... done (CPU: 1:34.947, Wall: 15.182)
 2. for k1: assembling the matrix and rhs, implementing b.c. 
   b) Factorization... done (2.9Gb).    c) Solve... done (CPU: 2:36.274, Wall: 39.737)
	-----------------------------------------------------------
	 | Convg |   du  |   dv  |  duv% |  dh  | dhbar |  dh%  | 	
	 | ----- | ----- | ----- | ----- | ---- | ----- | ----- |  
	 | m2    | 14.13 | 11.28 | 0.017 | 0.21 | 0.005 | 0.016 |  
	 | k1    | 11.42 | 10.89 | 0.016 | 0.06 | 0.001 | 0.016 |  
	-----------------------------------------------------------
 
Calculate hsal and beta. 
   a) Interpolate h to the reg [1440 x 720] lat-lon grid...   done (CPU: 0.15002, Wall: 0.152)
   b) Spherical harmonic analysis... done (CPU: 1.4117, Wall: 1.829)
   c) Spherical harmonic synthesis... done (CPU: 1.5737, Wall: 1.643)
   d) Interpolate hsal onto the original grid... done (CPU: 0.151, Wall: 0.155)
   e) Calculate beta (averaged over 5ยบ)... matgen   done (CPU: 6.70166E-02, Wall: 7.1E-02)
   e) coo_mat_mul 5ยบ)...   done (CPU: 5.9922, Wall: 7.536)
done (CPU: 9.4916, Wall: 11.598)
   a) Interpolate h to the reg [1440 x 720] lat-lon grid...   done (CPU: 0.15503, Wall: 0.19)
   b) Spherical harmonic analysis... done (CPU: 1.0558, Wall: 1.242)
   c) Spherical harmonic synthesis... done (CPU: 1.2008, Wall: 1.578)
   d) Interpolate hsal onto the original grid... done (CPU: 0.151, Wall: 0.153)
   e) Calculate beta (averaged over 5ยบ)... matgen   done (CPU: 6.70166E-02, Wall: 6.9E-02)
   e) coo_mat_mul 5ยบ)...   done (CPU: 5.9551, Wall: 7.013)
done (CPU: 8.7257, Wall: 10.438)
  Welcome to calc_dhat: Projecting: ******** done (CPU: 10.442, Wall: 11.185)
  Storing: ** done (CPU: 0.274, Wall: 0.386)
===>>> Total time spent on Iteration 5:  4:54.715 CPU,  1:36.862  Wall
==============
 Iteration 6
==============
 1. for m2: assembling the matrix and rhs, implementing b.c. 
   b) Factorization... done (2.9Gb).    c) Solve... done (CPU: 2:24.994, Wall: 37.256)
 2. for k1: assembling the matrix and rhs, implementing b.c. 
   b) Factorization... done (2.9Gb).    c) Solve... done (CPU: 2:56.100, Wall: 39.959)
	-----------------------------------------------------------
	 | Convg |  du  |  dv  |  duv% |  dh  | dhbar |  dh%  | 	
	 | ----- | ---- | ---- | ----- | ---- | ----- | ----- |  
	 | m2    | 7.17 | 5.37 | 0.008 | 0.10 | 0.002 | 0.007 |  
	 | k1    | 5.05 | 6.09 | 0.008 | 0.03 | 0.001 | 0.008 |  
	-----------------------------------------------------------
 
Calculate hsal and beta. 
   a) Interpolate h to the reg [1440 x 720] lat-lon grid...   done (CPU: 0.14697, Wall: 0.147)
   b) Spherical harmonic analysis... done (CPU: 1.3447, Wall: 7.456)
   c) Spherical harmonic synthesis... done (CPU: 1.4728, Wall: 8.202)
   d) Interpolate hsal onto the original grid... done (CPU: 0.14294, Wall: 0.143)
   e) Calculate beta (averaged over 5ยบ)... matgen   done (CPU: 6.20117E-02, Wall: 0.131)
   e) coo_mat_mul 5ยบ)...   done (CPU: 5.6511, Wall: 5.652)
done (CPU: 8.9547, Wall: 22.011)
   a) Interpolate h to the reg [1440 x 720] lat-lon grid...   done (CPU: 0.14392, Wall: 0.144)
   b) Spherical harmonic analysis... done (CPU: 0.9408, Wall: 0.941)
   c) Spherical harmonic synthesis... done (CPU: 1.1008, Wall: 1.101)
   d) Interpolate hsal onto the original grid... done (CPU: 0.14197, Wall: 0.142)
   e) Calculate beta (averaged over 5ยบ)... matgen   done (CPU: 6.18896E-02, Wall: 6.2E-02)
   e) coo_mat_mul 5ยบ)...   done (CPU: 5.7211, Wall: 5.74)
done (CPU: 8.2438, Wall: 8.263)
  Welcome to calc_dhat: Projecting: ******** done (CPU: 10.165, Wall: 10.170)
  Storing: ** done (CPU: 0.262, Wall: 0.384)
===>>> Total time spent on Iteration 6:  6:01.356 CPU,  2:09.783  Wall
==============
 Iteration 7
==============
 1. for m2: assembling the matrix and rhs, implementing b.c. 
   b) Factorization... done (2.9Gb).    c) Solve... done (CPU: 1:45.156, Wall: 15.661)
 2. for k1: assembling the matrix and rhs, implementing b.c. 
   b) Factorization... done (2.9Gb).    c) Solve... done (CPU: 1:50.500, Wall: 16.687)
	-----------------------------------------------------------
	 | Convg |  du  |  dv  |  duv% |  dh  | dhbar |  dh%  | 	
	 | ----- | ---- | ---- | ----- | ---- | ----- | ----- |  
	 | m2    | 3.63 | 2.76 | 0.004 | 0.05 | 0.001 | 0.003 |  
	 | k1    | 2.35 | 3.05 | 0.004 | 0.01 | 0.000 | 0.004 |  
	-----------------------------------------------------------
 
Calculate hsal and beta. 
   a) Interpolate h to the reg [1440 x 720] lat-lon grid...   done (CPU: 0.14502, Wall: 0.145)
   b) Spherical harmonic analysis... done (CPU: 1.3079, Wall: 1.31)
   c) Spherical harmonic synthesis... done (CPU: 1.4448, Wall: 1.445)
   d) Interpolate hsal onto the original grid... done (CPU: 0.14294, Wall: 0.143)
   e) Calculate beta (averaged over 5ยบ)... matgen   done (CPU: 6.49414E-02, Wall: 6.5E-02)
   e) coo_mat_mul 5ยบ)...   done (CPU: 5.7412, Wall: 5.914)
done (CPU: 8.9807, Wall: 9.156)
   a) Interpolate h to the reg [1440 x 720] lat-lon grid...   done (CPU: 0.15601, Wall: 0.176)
   b) Spherical harmonic analysis... done (CPU: 0.98584, Wall: 1.13)
   c) Spherical harmonic synthesis... done (CPU: 1.1278, Wall: 1.13)
   d) Interpolate hsal onto the original grid... done (CPU: 0.15002, Wall: 0.15)
   e) Calculate beta (averaged over 5ยบ)... matgen   done (CPU: 6.70166E-02, Wall: 6.7E-02)
   e) coo_mat_mul 5ยบ)...   done (CPU: 5.9551, Wall: 6.451)
done (CPU: 8.5797, Wall: 9.242)
  Welcome to calc_dhat: Projecting: ******** done (CPU: 10.674, Wall: 11.173)
  Storing: ** done (CPU: 0.272, Wall: 0.283)
===>>> Total time spent on Iteration 7:  4:21.724 CPU,  1:12.721  Wall
========================================================================
========================================================================
 
===>>> Total time spent on solving the system: 33:56.928 CPU, 10:54.885  Wall
 
-----------------------------------------------------------------------------
m2:	KE = 277.8 PJ, PE = 246.9 PJ, D = 2.910 TW.
	D_BL = 1.876 TW, D_IT = 1.028 TW, D_SAL = 0.003 GW, D_f = -0.062 GW.
	---------------------------------------------------------------------
	 | **** | Total | Shallow |  Deep | Coastal |  Open | 	
	 | ---- | ----- | ------- | ----- | ------- | ----- |  
	 | D_BL | 1.876 |  1.865  | 0.011 |  1.849  | 0.027 |  
	 | D_IT | 1.028 |  0.270  | 0.758 |  0.574  | 0.454 |  
	 | D    | 2.904 |  2.135  | 0.769 |  2.424  | 0.481 |  
-----------------------------------------------------------------------------
k1:	KE = 39.5 PJ, PE = 22.8 PJ, D = 0.320 TW.
	D_BL = 0.195 TW, D_IT = 0.125 TW, D_SAL = 0.001 GW, D_f = -0.426 GW.
	---------------------------------------------------------------------
	 | **** | Total | Shallow |  Deep | Coastal |  Open | 	
	 | ---- | ----- | ------- | ----- | ------- | ----- |  
	 | D_BL | 0.195 |  0.193  | 0.002 |  0.182  | 0.014 |  
	 | D_IT | 0.125 |  0.024  | 0.102 |  0.082  | 0.043 |  
	 | D    | 0.320 |  0.216  | 0.104 |  0.264  | 0.057 |  
Cleaning up temporary files 
[H[2JSaving data as 2012_11_27__15_08
Loading topography file:  done.
Interpolating topo to 15.00 min resolution global grid:  done.
****** Ocean is in the first/last tau index of H_hg. Removed ******
Removing bays and inlets: 1371 + 335 + 156 + 78 + 48 + 31 + 21 + 16 + 13 + 8 + [H[2JSaving data as 2013_01_22__00_58
Loading topography file: /home/amt6/amtvl/Desktop/scratch/Tides/data/LAG/baro_fd/in/topo/nocs/topo_rot_2.0min_pole_15_-40.dat 
Interpolating topo to 15.00 min resolution global grid:  done.
****** Ocean is in the first/last tau index of H_hg. Removed ******
Removing bays and inlets: 1371 + 335 + 156 + 78 + 48 + 31 + 21 + 16 + 13 + 8 + 4 + 3 + 3 + 2 + 0.
Removing inland seas/lakes: found 26 connected components; removed 23 of size < 144 cells.
Smoothing topography for the linear ITD scheme: Loading topography file: /home/amt6/amtvl/Desktop/scratch/Tides/data/LAG/baro_fd/in/topo/nocs/smoothed_t1_trunc1440_topo_rot_2.0min_pole_15_-40.dat 
done (CPU: 0.387, Wall: 0.388)
Allocating grid points: 679779 for u, 683462 for v, 675152  for h.
Making vectors: tau, H, evaluating on the u-, v-, h-grid (CPU: 0.1s, Wall:0.1s)
Making matrices:
 - d/dph and 1 for h-grid functions, evaluating on the u-grid (CPU: 0.1s, Wall:0.1s)
 - d/dta and 1 for h grid functions, evaluating on the v-grid (CPU: 0.1s, Wall:0.1s)
 - d/dph and 1 for u-grid functions, evaluating on the h-grid (CPU: 0.1s, Wall:0.1s)
 - d/dta and 1 for v-grid functions, evaluating on the h-grid (CPU: 0.1s, Wall:0.1s)
 - v & fv,     			     evaluating on the u-grid (CPU: 0.5s, Wall:0.5s)
 - u & fu,     			     evaluating on the v-grid (CPU: 0.5s, Wall:0.5s)
Saving matrices: done.
Preparing matrices: GHU, GHV, KU, KV, v2uf, u2vf, Linear BBL, Linear ITD (1 matrix per constituent), b.c. DONE
====================================
Welcome to baro_solver (nonlinear)
====================================
==============
 Iteration 1
==============
Have [2.04E+06 x 2.04E+06] sparse matrix (nnz = 1.28E+07). Solve with pardiso.
 1. for m2: assembling the matrix and rhs, implementing b.c. 
   a) Reordering... done (peak-1.5Gb; permanent-1.2Gb) 
      Size of matrix factors 1.7Gb < 15.0Gb RAM+Swap. Running in-core with peak memory usage: 3.0Gb.
   b) Factorization... done (1.7Gb).    c) Solve... done (CPU: 1:03.070, Wall: 12.276)
	-----------------------------------------------------------
	 | Convg |   du   |   dv   |  duv%  |  dh  | dhbar |  dh%  | 	
	 | ----- | ------ | ------ | ------ | ---- | ----- | ----- |  
	 | m2    | 679.91 | 438.15 | 52.067 | 7.50 | 0.382 | 0.382 |  
	-----------------------------------------------------------
 
Calculate hsal and beta: 
 1. for m2: done (CPU: 9.2256, Wall: 7.903)
  Welcome to calc_dhat: Projecting: ******** done (CPU: 2.141, Wall: 2.141)
  Storing: * done (CPU: 0.133, Wall: 1.628)
===>>> Total time spent on Iteration 1:  1:21.704 CPU, 27.415  Wall
==============
 Iteration 2
==============
 1. for m2: assembling the matrix and rhs, implementing b.c. 
   b) Factorization... done (1.7Gb).    c) Solve... done (CPU: 40.020, Wall: 5.308)
	-----------------------------------------------------------
	 | Convg |   du   |   dv   |  duv% |  dh  | dhbar |  dh%  | 	
	 | ----- | ------ | ------ | ----- | ---- | ----- | ----- |  
	 | m2    | 106.38 | 153.30 | 0.279 | 2.95 | 0.054 | 0.254 |  
	-----------------------------------------------------------
 
Calculate hsal and beta: 
 1. for m2: done (CPU: 5.0722, Wall: 3.315)
  Welcome to calc_dhat: Projecting: ******** done (CPU: 2.141, Wall: 2.141)
  Storing: * done (CPU: 0.125, Wall: 0.127)
===>>> Total time spent on Iteration 2: 56.077 CPU, 14.453  Wall
==============
 Iteration 3
==============
 1. for m2: assembling the matrix and rhs, implementing b.c. 
   b) Factorization... done (1.7Gb).    c) Solve... done (CPU: 40.683, Wall: 5.431)
	-----------------------------------------------------------
	 | Convg |   du  |   dv  |  duv% |  dh  | dhbar |  dh%  | 	
	 | ----- | ----- | ----- | ----- | ---- | ----- | ----- |  
	 | m2    | 44.10 | 66.89 | 0.090 | 1.05 | 0.021 | 0.085 |  
	-----------------------------------------------------------
 
Calculate hsal and beta: 
 1. for m2: done (CPU: 4.9863, Wall: 3.301)
  Welcome to calc_dhat: Projecting: ******** done (CPU: 2.140, Wall: 2.141)
  Storing: * done (CPU: 0.124, Wall: 0.125)
===>>> Total time spent on Iteration 3: 55.417 CPU, 15.166  Wall
==============
 Iteration 4
==============
 1. for m2: assembling the matrix and rhs, implementing b.c. 
   b) Factorization... done (1.7Gb).    c) Solve... done (CPU: 39.453, Wall: 5.225)
	-----------------------------------------------------------
	 | Convg |   du  |   dv  |  duv% |  dh  | dhbar |  dh%  | 	
	 | ----- | ----- | ----- | ----- | ---- | ----- | ----- |  
	 | m2    | 23.75 | 27.49 | 0.041 | 0.50 | 0.010 | 0.039 |  
	-----------------------------------------------------------
 
Calculate hsal and beta: 
 1. for m2: done (CPU: 5.2602, Wall: 3.298)
  Welcome to calc_dhat: Projecting: ******** done (CPU: 2.148, Wall: 2.148)
  Storing: * done (CPU: 0.126, Wall: 0.127)
===>>> Total time spent on Iteration 4: 56.534 CPU, 14.560  Wall
==============
 Iteration 5
==============
 1. for m2: assembling the matrix and rhs, implementing b.c. 
   b) Factorization... done (1.7Gb).    c) Solve... done (CPU: 41.178, Wall: 5.520)
	-----------------------------------------------------------
	 | Convg |   du  |   dv  |  duv% |  dh  | dhbar |  dh%  | 	
	 | ----- | ----- | ----- | ----- | ---- | ----- | ----- |  
	 | m2    | 12.43 | 10.88 | 0.019 | 0.26 | 0.004 | 0.017 |  
	-----------------------------------------------------------
 
Calculate hsal and beta: 
 1. for m2: done (CPU: 5.2722, Wall: 3.309)
  Welcome to calc_dhat: Projecting: ******** done (CPU: 2.146, Wall: 2.147)
  Storing: * done (CPU: 0.125, Wall: 0.127)
===>>> Total time spent on Iteration 5: 59.699 CPU, 14.659  Wall
==============
 Iteration 6
==============
 1. for m2: assembling the matrix and rhs, implementing b.c. 
   b) Factorization... done (1.7Gb).    c) Solve... done (CPU: 40.308, Wall: 5.335)
	-----------------------------------------------------------
	 | Convg |  du  |  dv  |  duv% |  dh  | dhbar |  dh%  | 	
	 | ----- | ---- | ---- | ----- | ---- | ----- | ----- |  
	 | m2    | 6.35 | 5.03 | 0.009 | 0.12 | 0.002 | 0.008 |  
	-----------------------------------------------------------
 
Calculate hsal and beta: 
 1. for m2: done (CPU: 4.7173, Wall: 3.309)
  Welcome to calc_dhat: Projecting: ******** done (CPU: 2.138, Wall: 2.138)
  Storing: * done (CPU: 0.125, Wall: 0.126)
===>>> Total time spent on Iteration 6: 55.188 CPU, 14.494  Wall
==============
 Iteration 7
==============
 1. for m2: assembling the matrix and rhs, implementing b.c. 
   b) Factorization... done (1.7Gb).    c) Solve... done (CPU: 40.022, Wall: 5.303)
	-----------------------------------------------------------
	 | Convg |  du  |  dv  |  duv% |  dh  | dhbar |  dh%  | 	
	 | ----- | ---- | ---- | ----- | ---- | ----- | ----- |  
	 | m2    | 3.20 | 2.50 | 0.004 | 0.06 | 0.001 | 0.004 |  
	-----------------------------------------------------------
 
Calculate hsal and beta: 
 1. for m2: done (CPU: 5.1972, Wall: 3.285)
  Welcome to calc_dhat: Projecting: ******** done (CPU: 2.146, Wall: 2.148)
  Storing: * done (CPU: 0.126, Wall: 0.126)
===>>> Total time spent on Iteration 7: 56.140 CPU, 14.430  Wall
========================================================================
========================================================================
 
===>>> Total time spent on solving the system: 7:00.773 CPU, 1:55.194  Wall
 
-----------------------------------------------------------------------------
m2:	KE = 220.7 PJ, PE = 191.9 PJ, D = 2.718 TW.
	D_BL = 1.231 TW, D_IT = 1.481 TW, D_SAL = 0.003 GW, D_f = -0.043 GW.
	---------------------------------------------------------------------
	 | **** | Total | Shallow |  Deep | Coastal |  Open | 	
	 | ---- | ----- | ------- | ----- | ------- | ----- |  
	 | D_BL | 1.231 |  1.223  | 0.008 |  1.216  | 0.015 |  
	 | D_IT | 1.481 |  0.597  | 0.884 |  0.912  | 0.569 |  
	 | D    | 2.712 |  1.820  | 0.892 |  2.129  | 0.583 |  
 
===>>> Calculation of domain integrals: 28.399 CPU, 28.468  Wall
Cleaning up temporary files 
[H[2JSaving data as 2013_01_22__14_29
Loading topography file: /home/amt6/amtvl/Desktop/scratch/Tides/data/LAG/baro_fd/in/topo/nocs/topo_rot_2.0min_pole_15_-40.dat 
Interpolating topo to 15.00 min resolution global grid:  done.
****** Ocean is in the first/last tau index of H_hg. Removed ******
Removing bays and inlets: 1371 + 335 + 156 + 78 + 48 + 31 + 21 + 16 + 13 + 8 + 4 + 3 + 3 + 2 + 0.
Removing inland seas/lakes: found 26 connected components; removed 23 of size < 144 cells.
Smoothing topography for the linear ITD scheme: Loading topography file: /home/amt6/amtvl/Desktop/scratch/Tides/data/LAG/baro_fd/in/topo/nocs/smoothed_t1_trunc1440_topo_rot_2.0min_pole_15_-40.dat 
done (CPU: 0.394, Wall: 0.395)
Allocating grid points: 679779 for u, 683462 for v, 675152  for h.
Making vectors: tau, H, evaluating on the u-, v-, h-grid (CPU: 0.1s, Wall:0.1s)
Making matrices:
 - d/dph and 1 for h-grid functions, evaluating on the u-grid (CPU: 0.1s, Wall:0.1s)
 - d/dta and 1 for h grid functions, evaluating on the v-grid (CPU: 0.1s, Wall:0.1s)
 - d/dph and 1 for u-grid functions, evaluating on the h-grid (CPU: 0.1s, Wall:0.1s)
 - d/dta and 1 for v-grid functions, evaluating on the h-grid (CPU: 0.1s, Wall:0.1s)
 - v & fv,     			     evaluating on the u-grid (CPU: 0.5s, Wall:0.5s)
 - u & fu,     			     evaluating on the v-grid (CPU: 0.5s, Wall:0.5s)
Saving matrices: done.
Preparing matrices: GHU, GHV, KU, KV, v2uf, u2vf, Linear BBL, Linear ITD (1 matrix per constituent), b.c. DONE
====================================
Welcome to baro_solver (nonlinear)
====================================
==============
 Iteration 1
==============
Have [2.04E+06 x 2.04E+06] sparse matrix (nnz = 1.28E+07). Solve with pardiso.
 1. for m2: assembling the matrix and rhs, implementing b.c. 
   a) Reordering... done (peak-1.5Gb; permanent-1.2Gb) 
      Size of matrix factors 1.7Gb < 15.0Gb RAM+Swap. Running in-core with peak memory usage: 3.0Gb.
   b) Factorization... done (1.7Gb).    c) Solve... done (CPU: 1:02.651, Wall: 12.369)
 2. for k1: assembling the matrix and rhs, implementing b.c. 
   b) Factorization... done (1.7Gb).    c) Solve... done (CPU: 40.661, Wall: 5.504)
	-----------------------------------------------------------
	 | Convg |   du   |   dv   |  duv%  |  dh  | dhbar |  dh%  | 	
	 | ----- | ------ | ------ | ------ | ---- | ----- | ----- |  
	 | m2    | 699.87 | 450.93 | 52.993 | 7.79 | 0.390 | 0.390 |  
	 | k1    | 807.39 | 682.84 | 15.211 | 3.07 | 0.111 | 0.111 |  
	-----------------------------------------------------------
 
Calculate hsal and beta: 
 1. for m2: done (CPU: 9.4995, Wall: 7.927)
 2. for k1: done (CPU: 4.5413, Wall: 2.655)
  Welcome to calc_dhat: Projecting: ******** done (CPU: 9.995, Wall: 10.039)
  Storing: ** done (CPU: 0.268, Wall: 0.269)
===>>> Total time spent on Iteration 1:  2:26.414 CPU, 45.770  Wall
==============
 Iteration 2
==============
 1. for m2: assembling the matrix and rhs, implementing b.c. 
   b) Factorization... done (1.7Gb).    c) Solve... done (CPU: 39.481, Wall: 5.236)
 2. for k1: assembling the matrix and rhs, implementing b.c. 
   b) Factorization... done (1.7Gb).    c) Solve... done (CPU: 40.543, Wall: 5.390)
	-----------------------------------------------------------
	 | Convg |   du   |   dv   |  duv% |  dh  | dhbar |  dh%  | 	
	 | ----- | ------ | ------ | ----- | ---- | ----- | ----- |  
	 | m2    | 102.56 | 152.42 | 0.278 | 2.94 | 0.056 | 0.253 |  
	 | k1    | 292.82 | 245.17 | 0.318 | 0.64 | 0.016 | 0.255 |  
	-----------------------------------------------------------
 
Calculate hsal and beta: 
 1. for m2: done (CPU: 5.1392, Wall: 3.329)
 2. for k1: done (CPU: 4.0054, Wall: 2.614)
  Welcome to calc_dhat: Projecting: ******** done (CPU: 9.988, Wall: 9.989)
  Storing: ** done (CPU: 0.239, Wall: 0.239)
===>>> Total time spent on Iteration 2:  1:54.525 CPU, 33.617  Wall
==============
 Iteration 3
==============
 1. for m2: assembling the matrix and rhs, implementing b.c. 
   b) Factorization... done (1.7Gb).    c) Solve... done (CPU: 39.663, Wall: 5.280)
 2. for k1: assembling the matrix and rhs, implementing b.c. 
   b) Factorization... done (1.7Gb).    c) Solve... done (CPU: 39.902, Wall: 5.316)
	-----------------------------------------------------------
	 | Convg |   du  |   dv  |  duv% |  dh  | dhbar |  dh%  | 	
	 | ----- | ----- | ----- | ----- | ---- | ----- | ----- |  
	 | m2    | 45.29 | 66.18 | 0.090 | 1.04 | 0.022 | 0.083 |  
	 | k1    | 89.38 | 78.46 | 0.089 | 0.26 | 0.007 | 0.096 |  
	-----------------------------------------------------------
 
Calculate hsal and beta: 
 1. for m2: done (CPU: 5.3522, Wall: 3.32)
 2. for k1: done (CPU: 4.4573, Wall: 2.65)
  Welcome to calc_dhat: Projecting: ******** done (CPU: 9.987, Wall: 9.991)
  Storing: ** done (CPU: 0.240, Wall: 0.241)
===>>> Total time spent on Iteration 3:  1:56.230 CPU, 33.587  Wall
==============
 Iteration 4
==============
 1. for m2: assembling the matrix and rhs, implementing b.c. 
   b) Factorization... done (1.7Gb).    c) Solve... done (CPU: 39.686, Wall: 5.283)
 2. for k1: assembling the matrix and rhs, implementing b.c. 
   b) Factorization... done (1.7Gb).    c) Solve... done (CPU: 39.561, Wall: 5.243)
	-----------------------------------------------------------
	 | Convg |   du  |   dv  |  duv% |  dh  | dhbar |  dh%  | 	
	 | ----- | ----- | ----- | ----- | ---- | ----- | ----- |  
	 | m2    | 24.11 | 27.10 | 0.041 | 0.51 | 0.010 | 0.039 |  
	 | k1    | 28.30 | 24.71 | 0.039 | 0.11 | 0.003 | 0.042 |  
	-----------------------------------------------------------
 
Calculate hsal and beta: 
 1. for m2: done (CPU: 5.0612, Wall: 3.276)
 2. for k1: done (CPU: 3.9964, Wall: 2.56)
  Welcome to calc_dhat: Projecting: ******** done (CPU: 9.985, Wall: 9.987)
  Storing: ** done (CPU: 0.239, Wall: 0.241)
===>>> Total time spent on Iteration 4:  1:53.572 CPU, 33.414  Wall
==============
 Iteration 5
==============
 1. for m2: assembling the matrix and rhs, implementing b.c. 
   b) Factorization... done (1.7Gb).    c) Solve... done (CPU: 40.000, Wall: 5.370)
 2. for k1: assembling the matrix and rhs, implementing b.c. 
   b) Factorization... done (1.7Gb).    c) Solve... done (CPU: 41.384, Wall: 5.612)
	-----------------------------------------------------------
	 | Convg |   du  |   dv  |  duv% |  dh  | dhbar |  dh%  | 	
	 | ----- | ----- | ----- | ----- | ---- | ----- | ----- |  
	 | m2    | 12.52 | 10.71 | 0.020 | 0.26 | 0.005 | 0.018 |  
	 | k1    | 10.95 | 10.83 | 0.018 | 0.05 | 0.001 | 0.020 |  
	-----------------------------------------------------------
 
Calculate hsal and beta: 
 1. for m2: done (CPU: 4.8572, Wall: 3.241)
 2. for k1: done (CPU: 4.5863, Wall: 2.628)
  Welcome to calc_dhat: Projecting: ******** done (CPU: 10.025, Wall: 10.026)
  Storing: ** done (CPU: 0.241, Wall: 0.243)
===>>> Total time spent on Iteration 5:  1:58.951 CPU, 33.945  Wall
==============
 Iteration 6
==============
 1. for m2: assembling the matrix and rhs, implementing b.c. 
   b) Factorization... done (1.7Gb).    c) Solve... done (CPU: 38.819, Wall: 5.149)
 2. for k1: assembling the matrix and rhs, implementing b.c. 
   b) Factorization... done (1.7Gb).    c) Solve... done (CPU: 39.806, Wall: 5.267)
	-----------------------------------------------------------
	 | Convg |  du  |  dv  |  duv% |  dh  | dhbar |  dh%  | 	
	 | ----- | ---- | ---- | ----- | ---- | ----- | ----- |  
	 | m2    | 6.39 | 4.93 | 0.009 | 0.13 | 0.002 | 0.008 |  
	 | k1    | 4.76 | 4.36 | 0.009 | 0.02 | 0.001 | 0.010 |  
	-----------------------------------------------------------
 
Calculate hsal and beta: 
 1. for m2: done (CPU: 4.9813, Wall: 3.252)
 2. for k1: done (CPU: 4.7083, Wall: 2.675)
  Welcome to calc_dhat: Projecting: ******** done (CPU: 10.015, Wall: 10.017)
  Storing: ** done (CPU: 0.241, Wall: 0.243)
===>>> Total time spent on Iteration 6:  1:57.532 CPU, 33.444  Wall
==============
 Iteration 7
==============
 1. for m2: assembling the matrix and rhs, implementing b.c. 
   b) Factorization... done (1.7Gb).    c) Solve... done (CPU: 39.844, Wall: 5.362)
 2. for k1: assembling the matrix and rhs, implementing b.c. 
   b) Factorization... done (1.7Gb).    c) Solve... done (CPU: 39.542, Wall: 5.270)
	-----------------------------------------------------------
	 | Convg |  du  |  dv  |  duv% |  dh  | dhbar |  dh%  | 	
	 | ----- | ---- | ---- | ----- | ---- | ----- | ----- |  
	 | m2    | 3.24 | 2.44 | 0.004 | 0.06 | 0.001 | 0.004 |  
	 | k1    | 2.12 | 2.19 | 0.004 | 0.01 | 0.000 | 0.005 |  
	-----------------------------------------------------------
 
Calculate hsal and beta: 
 1. for m2: done (CPU: 5.1342, Wall: 3.272)
 2. for k1: done (CPU: 4.1704, Wall: 2.641)
  Welcome to calc_dhat: Projecting: ******** done (CPU: 10.012, Wall: 10.013)
  Storing: ** done (CPU: 0.240, Wall: 0.240)
===>>> Total time spent on Iteration 7:  1:59.100 CPU, 33.709  Wall
========================================================================
========================================================================
 
===>>> Total time spent on solving the system: 14:06.342 CPU, 4:07.503  Wall
 
-----------------------------------------------------------------------------
m2:	KE = 228.0 PJ, PE = 198.8 PJ, D = 2.744 TW.
	D_BL = 1.327 TW, D_IT = 1.412 TW, D_SAL = 0.003 GW, D_f = -0.044 GW.
	---------------------------------------------------------------------
	 | **** | Total | Shallow |  Deep | Coastal |  Open | 	
	 | ---- | ----- | ------- | ----- | ------- | ----- |  
	 | D_BL | 1.327 |  1.319  | 0.008 |  1.310  | 0.017 |  
	 | D_IT | 1.412 |  0.577  | 0.835 |  0.874  | 0.538 |  
	 | D    | 2.739 |  1.895  | 0.843 |  2.183  | 0.555 |  
-----------------------------------------------------------------------------
k1:	KE = 41.0 PJ, PE = 24.2 PJ, D = 0.326 TW.
	D_BL = 0.188 TW, D_IT = 0.139 TW, D_SAL = 0.001 GW, D_f = -0.405 GW.
	---------------------------------------------------------------------
	 | **** | Total | Shallow |  Deep | Coastal |  Open | 	
	 | ---- | ----- | ------- | ----- | ------- | ----- |  
	 | D_BL | 0.188 |  0.185  | 0.002 |  0.174  | 0.014 |  
	 | D_IT | 0.139 |  0.027  | 0.111 |  0.103  | 0.036 |  
	 | D    | 0.326 |  0.213  | 0.114 |  0.276  | 0.050 |  
 
===>>> Calculation of domain integrals: 29.378 CPU, 29.385  Wall
Cleaning up temporary files 
[H[2JSaving data as 2013_01_22__22_26
Loading topography file: /home/amt6/amtvl/Desktop/scratch/Tides/data/LAG/baro_fd/in/topo/nocs/topo_rot_2.0min_pole_15_-40.dat 
Interpolating topo to 15.00 min resolution global grid:  done.
****** Ocean is in the first/last tau index of H_hg. Removed ******
Removing bays and inlets: 1371 + 335 + 156 + 78 + 48 + 31 + 21 + 16 + 13 + 8 + 4 + 3 + 3 + 2 + 0.
Removing inland seas/lakes: found 26 connected components; removed 23 of size < 144 cells.
Smoothing topography for the linear ITD scheme: Loading topography file: /home/amt6/amtvl/Desktop/scratch/Tides/data/LAG/baro_fd/in/topo/nocs/smoothed_t1_trunc1440_topo_rot_2.0min_pole_15_-40.dat 
done (CPU: 0.402, Wall: 0.402)
Allocating grid points: 679779 for u, 683462 for v, 675152  for h.
Making vectors: tau, H, evaluating on the u-, v-, h-grid (CPU: 0.1s, Wall:0.1s)
Making matrices:
 - d/dph and 1 for h-grid functions, evaluating on the u-grid (CPU: 0.1s, Wall:0.1s)
 - d/dta and 1 for h grid functions, evaluating on the v-grid (CPU: 0.1s, Wall:0.1s)
 - d/dph and 1 for u-grid functions, evaluating on the h-grid (CPU: 0.1s, Wall:0.1s)
 - d/dta and 1 for v-grid functions, evaluating on the h-grid (CPU: 0.1s, Wall:0.1s)
 - v & fv,     			     evaluating on the u-grid (CPU: 0.5s, Wall:0.5s)
 - u & fu,     			     evaluating on the v-grid (CPU: 0.5s, Wall:0.5s)
Saving matrices: done.
Preparing matrices: GHU, GHV, KU, KV, v2uf, u2vf, Linear BBL, Linear ITD (1 matrix per constituent), b.c. DONE
====================================
Welcome to baro_solver (nonlinear)
====================================
==============
 Iteration 1
==============
Have [2.04E+06 x 2.04E+06] sparse matrix (nnz = 1.28E+07). Solve with pardiso.
 1. for m2: assembling the matrix and rhs, implementing b.c. 
   a) Reordering... done (peak-1.5Gb; permanent-1.2Gb) 
      Size of matrix factors 1.7Gb < 15.0Gb RAM+Swap. Running in-core with peak memory usage: 3.0Gb.
   b) Factorization... done (1.7Gb).    c) Solve... done (CPU: 1:02.967, Wall: 12.494)
 2. for k1: assembling the matrix and rhs, implementing b.c. 
   b) Factorization... done (1.7Gb).    c) Solve... done (CPU: 40.671, Wall: 5.434)
	-----------------------------------------------------------
	 | Convg |   du   |   dv   |  duv%  |  dh  | dhbar |  dh%  | 	
	 | ----- | ------ | ------ | ------ | ---- | ----- | ----- |  
	 | m2    | 625.64 | 419.93 | 49.722 | 6.80 | 0.362 | 0.362 |  
	 | k1    | 784.91 | 679.64 | 15.022 | 3.06 | 0.110 | 0.110 |  
	-----------------------------------------------------------
 
Calculate hsal and beta: 
 1. for m2: done (CPU: 9.5965, Wall: 7.906)
 2. for k1: done (CPU: 3.7614, Wall: 2.582)
  Welcome to calc_dhat: Projecting: ******** done (CPU: 10.072, Wall: 10.079)
  Storing: ** done (CPU: 0.258, Wall: 0.264)
===>>> Total time spent on Iteration 1:  2:20.732 CPU, 45.673  Wall
==============
 Iteration 2
==============
 1. for m2: assembling the matrix and rhs, implementing b.c. 
   b) Factorization... done (1.7Gb).    c) Solve... done (CPU: 40.168, Wall: 5.309)
 2. for k1: assembling the matrix and rhs, implementing b.c. 
   b) Factorization... done (1.7Gb).    c) Solve... done (CPU: 41.456, Wall: 5.541)
	-----------------------------------------------------------
	 | Convg |   du   |   dv   |  duv% |  dh  | dhbar |  dh%  | 	
	 | ----- | ------ | ------ | ----- | ---- | ----- | ----- |  
	 | m2    |  90.11 | 145.41 | 0.265 | 2.80 | 0.049 | 0.244 |  
	 | k1    | 281.21 | 242.01 | 0.329 | 0.66 | 0.016 | 0.254 |  
	-----------------------------------------------------------
 
Calculate hsal and beta: 
 1. for m2: done (CPU: 5.0132, Wall: 3.33)
 2. for k1: done (CPU: 4.6023, Wall: 2.662)
  Welcome to calc_dhat: Projecting: ******** done (CPU: 10.088, Wall: 10.116)
  Storing: ** done (CPU: 0.243, Wall: 0.244)
===>>> Total time spent on Iteration 2:  1:57.104 CPU, 38.895  Wall
==============
 Iteration 3
==============
 1. for m2: assembling the matrix and rhs, implementing b.c. 
   b) Factorization... done (1.7Gb).    c) Solve... done (CPU: 41.334, Wall: 5.513)
 2. for k1: assembling the matrix and rhs, implementing b.c. 
   b) Factorization... done (1.7Gb).    c) Solve... done (CPU: 40.740, Wall: 5.416)
	-----------------------------------------------------------
	 | Convg |   du  |   dv  |  duv% |  dh  | dhbar |  dh%  | 	
	 | ----- | ----- | ----- | ----- | ---- | ----- | ----- |  
	 | m2    | 40.40 | 61.91 | 0.086 | 0.98 | 0.019 | 0.081 |  
	 | k1    | 87.42 | 76.52 | 0.093 | 0.27 | 0.007 | 0.101 |  
	-----------------------------------------------------------
 
Calculate hsal and beta: 
 1. for m2: done (CPU: 5.2742, Wall: 3.313)
 2. for k1: done (CPU: 4.5343, Wall: 2.632)
  Welcome to calc_dhat: Projecting: ******** done (CPU: 10.031, Wall: 10.032)
  Storing: ** done (CPU: 0.240, Wall: 0.241)
===>>> Total time spent on Iteration 3:  2:03.536 CPU, 33.997  Wall
==============
 Iteration 4
==============
 1. for m2: assembling the matrix and rhs, implementing b.c. 
   b) Factorization... done (1.7Gb).    c) Solve... done (CPU: 40.733, Wall: 5.427)
 2. for k1: assembling the matrix and rhs, implementing b.c. 
   b) Factorization... done (1.7Gb).    c) Solve... done (CPU: 40.666, Wall: 5.414)
	-----------------------------------------------------------
	 | Convg |   du  |   dv  |  duv% |  dh  | dhbar |  dh%  | 	
	 | ----- | ----- | ----- | ----- | ---- | ----- | ----- |  
	 | m2    | 22.13 | 25.65 | 0.040 | 0.46 | 0.009 | 0.036 |  
	 | k1    | 27.30 | 23.79 | 0.040 | 0.11 | 0.003 | 0.046 |  
	-----------------------------------------------------------
 
Calculate hsal and beta: 
 1. for m2: done (CPU: 5.1842, Wall: 3.268)
 2. for k1: done (CPU: 4.7203, Wall: 2.604)
  Welcome to calc_dhat: Projecting: ******** done (CPU: 10.081, Wall: 10.097)
  Storing: ** done (CPU: 0.242, Wall: 0.244)
===>>> Total time spent on Iteration 4:  1:57.338 CPU, 33.847  Wall
==============
 Iteration 5
==============
 1. for m2: assembling the matrix and rhs, implementing b.c. 
   b) Factorization... done (1.7Gb).    c) Solve... done (CPU: 40.446, Wall: 5.388)
 2. for k1: assembling the matrix and rhs, implementing b.c. 
   b) Factorization... done (1.7Gb).    c) Solve... done (CPU: 42.207, Wall: 5.709)
	-----------------------------------------------------------
	 | Convg |   du  |   dv  |  duv% |  dh  | dhbar |  dh%  | 	
	 | ----- | ----- | ----- | ----- | ---- | ----- | ----- |  
	 | m2    | 11.63 | 10.30 | 0.019 | 0.23 | 0.004 | 0.017 |  
	 | k1    | 10.46 | 10.63 | 0.019 | 0.05 | 0.001 | 0.022 |  
	-----------------------------------------------------------
 
Calculate hsal and beta: 
 1. for m2: done (CPU: 5.1652, Wall: 3.216)
 2. for k1: done (CPU: 4.3494, Wall: 2.617)
  Welcome to calc_dhat: Projecting: ******** done (CPU: 10.065, Wall: 10.109)
  Storing: ** done (CPU: 0.242, Wall: 0.243)
===>>> Total time spent on Iteration 5:  2:00.375 CPU, 34.091  Wall
==============
 Iteration 6
==============
 1. for m2: assembling the matrix and rhs, implementing b.c. 
   b) Factorization... done (1.7Gb).    c) Solve... done (CPU: 39.978, Wall: 5.342)
 2. for k1: assembling the matrix and rhs, implementing b.c. 
   b) Factorization... done (1.7Gb).    c) Solve... done (CPU: 39.712, Wall: 5.316)
	-----------------------------------------------------------
	 | Convg |  du  |  dv  |  duv% |  dh  | dhbar |  dh%  | 	
	 | ----- | ---- | ---- | ----- | ---- | ----- | ----- |  
	 | m2    | 5.93 | 4.71 | 0.009 | 0.11 | 0.002 | 0.008 |  
	 | k1    | 4.50 | 4.12 | 0.009 | 0.02 | 0.001 | 0.011 |  
	-----------------------------------------------------------
 
Calculate hsal and beta: 
 1. for m2: done (CPU: 5.1412, Wall: 3.262)
 2. for k1: done (CPU: 4.1783, Wall: 2.645)
  Welcome to calc_dhat: Projecting: ******** done (CPU: 10.065, Wall: 10.064)
  Storing: ** done (CPU: 0.242, Wall: 0.243)
===>>> Total time spent on Iteration 6:  1:58.709 CPU, 33.798  Wall
==============
 Iteration 7
==============
 1. for m2: assembling the matrix and rhs, implementing b.c. 
   b) Factorization... done (1.7Gb).    c) Solve... done (CPU: 42.700, Wall: 5.752)
 2. for k1: assembling the matrix and rhs, implementing b.c. 
   b) Factorization... done (1.7Gb).    c) Solve... done (CPU: 41.873, Wall: 5.537)
	-----------------------------------------------------------
	 | Convg |  du  |  dv  |  duv% |  dh  | dhbar |  dh%  | 	
	 | ----- | ---- | ---- | ----- | ---- | ----- | ----- |  
	 | m2    | 2.98 | 2.30 | 0.004 | 0.05 | 0.001 | 0.004 |  
	 | k1    | 1.98 | 2.31 | 0.005 | 0.01 | 0.000 | 0.006 |  
	-----------------------------------------------------------
 
Calculate hsal and beta: 
 1. for m2: done (CPU: 5.2532, Wall: 3.289)
 2. for k1: done (CPU: 4.6203, Wall: 2.632)
  Welcome to calc_dhat: Projecting: ******** done (CPU: 10.058, Wall: 10.057)
  Storing: ** done (CPU: 0.241, Wall: 0.241)
===>>> Total time spent on Iteration 7:  2:02.957 CPU, 34.381  Wall
========================================================================
========================================================================
 
===>>> Total time spent on solving the system: 14:20.769 CPU, 4:14.699  Wall
 
-----------------------------------------------------------------------------
m2:	KE = 199.6 PJ, PE = 172.0 PJ, D = 2.663 TW.
	D_BL = 1.042 TW, D_IT = 1.616 TW, D_SAL = 0.003 GW, D_f = -0.033 GW.
	---------------------------------------------------------------------
	 | **** | Total | Shallow |  Deep | Coastal |  Open | 	
	 | ---- | ----- | ------- | ----- | ------- | ----- |  
	 | D_BL | 1.042 |  1.035  | 0.007 |  1.028  | 0.014 |  
	 | D_IT | 1.616 |  0.614  | 1.001 |  0.972  | 0.644 |  
	 | D    | 2.658 |  1.650  | 1.008 |  2.000  | 0.658 |  
-----------------------------------------------------------------------------
k1:	KE = 40.5 PJ, PE = 23.9 PJ, D = 0.336 TW.
	D_BL = 0.177 TW, D_IT = 0.159 TW, D_SAL = 0.001 GW, D_f = -0.386 GW.
	---------------------------------------------------------------------
	 | **** | Total | Shallow |  Deep | Coastal |  Open | 	
	 | ---- | ----- | ------- | ----- | ------- | ----- |  
	 | D_BL | 0.177 |  0.175  | 0.002 |  0.164  | 0.013 |  
	 | D_IT | 0.159 |  0.019  | 0.140 |  0.112  | 0.047 |  
	 | D    | 0.336 |  0.194  | 0.143 |  0.276  | 0.061 |  
 
===>>> Calculation of domain integrals: 29.385 CPU, 29.413  Wall
Cleaning up temporary files 
[H[2JSaving data as 2013_01_23__19_27
Preparing matrices: GHU, GHV, KU, KV, v2uf, u2vf, Linear BBL, Linear ITD (1 matrix per constituent), b.c. DONE
====================================
Welcome to baro_solver (nonlinear)
====================================
==============
 Iteration 1
==============
Have [2.04E+06 x 2.04E+06] sparse matrix (nnz = 1.28E+07). Solve with pardiso.
 1. for m2: assembling the matrix and rhs, implementing b.c. 
   a) Reordering... done (peak-1.5Gb; permanent-1.2Gb) 
      Size of matrix factors 1.7Gb < 15.0Gb RAM+Swap. Running in-core with peak memory usage: 3.0Gb.
   b) Factorization... done (1.7Gb).    c) Solve... done (CPU: 1:16.886, Wall: 14.741)
 2. for k1: assembling the matrix and rhs, implementing b.c. 
   b) Factorization... done (1.7Gb).    c) Solve... done (CPU: 44.066, Wall: 5.883)
	-----------------------------------------------------------
	 | Convg |   du   |   dv   |  duv%  |  dh  | dhbar |  dh%  | 	
	 | ----- | ------ | ------ | ------ | ---- | ----- | ----- |  
	 | m2    | 577.00 | 421.76 | 47.797 | 6.24 | 0.345 | 0.345 |  
	 | k1    | 771.13 | 676.96 | 14.909 | 3.05 | 0.109 | 0.109 |  
	-----------------------------------------------------------
 
Calculate hsal and beta: 
 1. for m2: done (CPU: 5.7901, Wall: 3.744)
 2. for k1: done (CPU: 6.498, Wall: 3.992)
  Welcome to calc_dhat: Projecting: ******** done (CPU: 10.031, Wall: 10.064)
  Storing: ** done (CPU: 0.258, Wall: 0.258)
===>>> Total time spent on Iteration 1:  2:38.361 CPU, 46.152  Wall
==============
 Iteration 2
==============
 1. for m2: assembling the matrix and rhs, implementing b.c. 
   b) Factorization... done (1.7Gb).    c) Solve... done (CPU: 41.327, Wall: 5.467)
 2. for k1: assembling the matrix and rhs, implementing b.c. 
   b) Factorization... done (1.7Gb).    c) Solve... done (CPU: 43.027, Wall: 5.676)
	-----------------------------------------------------------
	 | Convg |   du   |   dv   |  duv% |  dh  | dhbar |  dh%  | 	
	 | ----- | ------ | ------ | ----- | ---- | ----- | ----- |  
	 | m2    |  80.89 | 140.27 | 0.258 | 2.69 | 0.046 | 0.243 |  
	 | k1    | 274.13 | 240.12 | 0.338 | 0.67 | 0.016 | 0.257 |  
	-----------------------------------------------------------
 
Calculate hsal and beta: 
 1. for m2: done (CPU: 6.1791, Wall: 4.321)
 2. for k1: done (CPU: 4.4403, Wall: 2.725)
  Welcome to calc_dhat: Projecting: ******** done (CPU: 10.023, Wall: 10.065)
  Storing: ** done (CPU: 0.241, Wall: 0.245)
===>>> Total time spent on Iteration 2:  1:59.805 CPU, 35.691  Wall
==============
 Iteration 3
==============
 1. for m2: assembling the matrix and rhs, implementing b.c. 
   b) Factorization... done (1.7Gb).    c) Solve... done (CPU: 41.772, Wall: 5.526)
 2. for k1: assembling the matrix and rhs, implementing b.c. 
   b) Factorization... done (1.7Gb).    c) Solve... done (CPU: 42.113, Wall: 5.568)
	-----------------------------------------------------------
	 | Convg |   du  |   dv  |  duv% |  dh  | dhbar |  dh%  | 	
	 | ----- | ----- | ----- | ----- | ---- | ----- | ----- |  
	 | m2    | 37.21 | 58.85 | 0.084 | 0.93 | 0.018 | 0.075 |  
	 | k1    | 86.34 | 75.46 | 0.095 | 0.27 | 0.007 | 0.105 |  
	-----------------------------------------------------------
 
Calculate hsal and beta: 
 1. for m2: done (CPU: 5.6581, Wall: 3.853)
 2. for k1: done (CPU: 4.2873, Wall: 2.678)
  Welcome to calc_dhat: Projecting: ******** done (CPU: 10.011, Wall: 10.020)
  Storing: ** done (CPU: 0.243, Wall: 0.243)
===>>> Total time spent on Iteration 3:  1:57.691 CPU, 35.122  Wall
==============
 Iteration 4
==============
 1. for m2: assembling the matrix and rhs, implementing b.c. 
   b) Factorization... done (1.7Gb).    c) Solve... done (CPU: 42.163, Wall: 5.652)
 2. for k1: assembling the matrix and rhs, implementing b.c. 
   b) Factorization... done (1.7Gb).    c) Solve... done (CPU: 41.070, Wall: 5.416)
	-----------------------------------------------------------
	 | Convg |   du  |   dv  |  duv% |  dh  | dhbar |  dh%  | 	
	 | ----- | ----- | ----- | ----- | ---- | ----- | ----- |  
	 | m2    | 20.80 | 24.53 | 0.038 | 0.43 | 0.008 | 0.035 |  
	 | k1    | 26.76 | 23.27 | 0.042 | 0.11 | 0.003 | 0.046 |  
	-----------------------------------------------------------
 
Calculate hsal and beta: 
 1. for m2: done (CPU: 6.468, Wall: 4.48)
 2. for k1: done (CPU: 5.6891, Wall: 3.753)
  Welcome to calc_dhat: Projecting: ******** done (CPU: 10.008, Wall: 10.008)
  Storing: ** done (CPU: 0.240, Wall: 0.241)
===>>> Total time spent on Iteration 4:  2:04.324 CPU, 36.805  Wall
==============
 Iteration 5
==============
 1. for m2: assembling the matrix and rhs, implementing b.c. 
   b) Factorization... done (1.7Gb).    c) Solve... done (CPU: 42.281, Wall: 5.571)
 2. for k1: assembling the matrix and rhs, implementing b.c. 
   b) Factorization... done (1.7Gb).    c) Solve... done (CPU: 50.027, Wall: 6.905)
	-----------------------------------------------------------
	 | Convg |   du  |   dv  |  duv% |  dh  | dhbar |  dh%  | 	
	 | ----- | ----- | ----- | ----- | ---- | ----- | ----- |  
	 | m2    | 11.00 |  9.97 | 0.018 | 0.22 | 0.004 | 0.017 |  
	 | k1    | 10.19 | 10.50 | 0.019 | 0.05 | 0.001 | 0.021 |  
	-----------------------------------------------------------
 
Calculate hsal and beta: 
 1. for m2: done (CPU: 5.8571, Wall: 4.426)
 2. for k1: done (CPU: 4.5953, Wall: 2.854)
  Welcome to calc_dhat: Projecting: ******** done (CPU: 10.047, Wall: 10.088)
  Storing: ** done (CPU: 0.243, Wall: 0.244)
===>>> Total time spent on Iteration 5:  2:15.670 CPU, 37.340  Wall
==============
 Iteration 6
==============
 1. for m2: assembling the matrix and rhs, implementing b.c. 
   b) Factorization... done (1.7Gb).    c) Solve... done (CPU: 41.648, Wall: 5.453)
 2. for k1: assembling the matrix and rhs, implementing b.c. 
   b) Factorization... done (1.7Gb).    c) Solve... done (CPU: 57.870, Wall: 7.956)
	-----------------------------------------------------------
	 | Convg |  du  |  dv  |  duv% |  dh  | dhbar |  dh%  | 	
	 | ----- | ---- | ---- | ----- | ---- | ----- | ----- |  
	 | m2    | 5.61 | 4.55 | 0.009 | 0.11 | 0.002 | 0.008 |  
	 | k1    | 4.36 | 4.21 | 0.009 | 0.02 | 0.001 | 0.010 |  
	-----------------------------------------------------------
 
Calculate hsal and beta: 
 1. for m2: done (CPU: 6.175, Wall: 4.477)
 2. for k1: done (CPU: 4.2834, Wall: 2.779)
  Welcome to calc_dhat: Projecting: ******** done (CPU: 10.036, Wall: 10.038)
  Storing: ** done (CPU: 0.242, Wall: 0.242)
===>>> Total time spent on Iteration 6:  2:15.825 CPU, 38.242  Wall
==============
 Iteration 7
==============
 1. for m2: assembling the matrix and rhs, implementing b.c. 
   b) Factorization... done (1.7Gb).    c) Solve... done (CPU: 40.950, Wall: 5.471)
 2. for k1: assembling the matrix and rhs, implementing b.c. 
   b) Factorization... done (1.7Gb).    c) Solve... done (CPU: 47.662, Wall: 6.524)
	-----------------------------------------------------------
	 | Convg |  du  |  dv  |  duv% |  dh  | dhbar |  dh%  | 	
	 | ----- | ---- | ---- | ----- | ---- | ----- | ----- |  
	 | m2    | 2.81 | 2.20 | 0.004 | 0.05 | 0.001 | 0.004 |  
	 | k1    | 1.92 | 2.46 | 0.005 | 0.01 | 0.000 | 0.005 |  
	-----------------------------------------------------------
 
Calculate hsal and beta: 
 1. for m2: done (CPU: 5.8611, Wall: 4.407)
 2. for k1: done (CPU: 4.9243, Wall: 3.057)
  Welcome to calc_dhat: Projecting: ******** done (CPU: 10.039, Wall: 10.041)
  Storing: ** done (CPU: 0.243, Wall: 0.244)
===>>> Total time spent on Iteration 7:  2:08.222 CPU, 36.923  Wall
========================================================================
========================================================================
 
===>>> Total time spent on solving the system: 15:19.925 CPU, 4:26.302  Wall
 
-----------------------------------------------------------------------------
m2:	KE = 183.7 PJ, PE = 157.3 PJ, D = 2.614 TW.
	D_BL = 0.890 TW, D_IT = 1.719 TW, D_SAL = 0.004 GW, D_f = -0.027 GW.
	---------------------------------------------------------------------
	 | **** | Total | Shallow |  Deep | Coastal |  Open | 	
	 | ---- | ----- | ------- | ----- | ------- | ----- |  
	 | D_BL | 0.890 |  0.884  | 0.006 |  0.878  | 0.012 |  
	 | D_IT | 1.719 |  0.626  | 1.093 |  1.015  | 0.704 |  
	 | D    | 2.609 |  1.510  | 1.100 |  1.893  | 0.717 |  
-----------------------------------------------------------------------------
k1:	KE = 40.1 PJ, PE = 23.7 PJ, D = 0.341 TW.
	D_BL = 0.171 TW, D_IT = 0.170 TW, D_SAL = 0.001 GW, D_f = -0.375 GW.
	---------------------------------------------------------------------
	 | **** | Total | Shallow |  Deep | Coastal |  Open | 	
	 | ---- | ----- | ------- | ----- | ------- | ----- |  
	 | D_BL | 0.171 |  0.169  | 0.002 |  0.158  | 0.013 |  
	 | D_IT | 0.170 |  0.012  | 0.158 |  0.115  | 0.055 |  
	 | D    | 0.341 |  0.181  | 0.160 |  0.273  | 0.068 |  
 
===>>> Calculation of domain integrals: 29.378 CPU, 29.378  Wall
Cleaning up temporary files 
[H[2JSaving data as 2013_01_23__22_06
Preparing matrices: GHU, GHV, KU, KV, v2uf, u2vf, Linear BBL, Linear ITD (1 matrix per constituent), b.c. DONE
====================================
Welcome to baro_solver (nonlinear)
====================================
==============
 Iteration 1
==============
Have [2.04E+06 x 2.04E+06] sparse matrix (nnz = 1.28E+07). Solve with pardiso.
 1. for m2: assembling the matrix and rhs, implementing b.c. 
   a) Reordering... done (peak-1.5Gb; permanent-1.2Gb) 
      Size of matrix factors 1.8Gb < 15.0Gb RAM+Swap. Running in-core with peak memory usage: 3.0Gb.
   b) Factorization... done (1.8Gb).    c) Solve... done (CPU: 1:08.388, Wall: 13.359)
 2. for k1: assembling the matrix and rhs, implementing b.c. 
   b) Factorization... done (1.8Gb).    c) Solve... done (CPU: 46.900, Wall: 6.368)
	-----------------------------------------------------------
	 | Convg |   du   |   dv   |  duv%  |  dh  | dhbar |  dh%  | 	
	 | ----- | ------ | ------ | ------ | ---- | ----- | ----- |  
	 | m2    | 577.00 | 421.76 | 47.797 | 6.24 | 0.345 | 0.345 |  
	 | k1    | 771.13 | 676.96 | 14.909 | 3.05 | 0.109 | 0.109 |  
	-----------------------------------------------------------
 
Calculate hsal and beta: 
 1. for m2: done (CPU: 5.7631, Wall: 3.398)
 2. for k1: done (CPU: 4.0344, Wall: 2.576)
  Welcome to calc_dhat: Projecting: ******** done (CPU: 10.001, Wall: 10.008)
  Storing: ** done (CPU: 0.258, Wall: 0.260)
===>>> Total time spent on Iteration 1:  2:34.039 CPU, 43.139  Wall
==============
 Iteration 2
==============
 1. for m2: assembling the matrix and rhs, implementing b.c. 
   b) Factorization... done (1.8Gb).    c) Solve... done (CPU: 44.120, Wall: 6.040)
 2. for k1: assembling the matrix and rhs, implementing b.c. 
   b) Factorization... done (1.8Gb).    c) Solve... done (CPU: 44.279, Wall: 5.948)
	-----------------------------------------------------------
	 | Convg |   du   |   dv   |  duv% |  dh  | dhbar |  dh%  | 	
	 | ----- | ------ | ------ | ----- | ---- | ----- | ----- |  
	 | m2    |  80.89 | 140.27 | 0.258 | 2.69 | 0.046 | 0.243 |  
	 | k1    | 274.13 | 240.12 | 0.338 | 0.67 | 0.016 | 0.257 |  
	-----------------------------------------------------------
 
Calculate hsal and beta: 
 1. for m2: done (CPU: 5.1912, Wall: 3.278)
 2. for k1: done (CPU: 4.7583, Wall: 2.596)
  Welcome to calc_dhat: Projecting: ******** done (CPU: 9.999, Wall: 10.010)
  Storing: ** done (CPU: 0.241, Wall: 0.241)
===>>> Total time spent on Iteration 2:  2:06.302 CPU, 35.125  Wall
==============
 Iteration 3
==============
 1. for m2: assembling the matrix and rhs, implementing b.c. 
   b) Factorization... done (1.8Gb).    c) Solve... done (CPU: 45.064, Wall: 6.147)
 2. for k1: assembling the matrix and rhs, implementing b.c. 
   b) Factorization... done (1.8Gb).    c) Solve... done (CPU: 45.960, Wall: 6.193)
	-----------------------------------------------------------
	 | Convg |   du  |   dv  |  duv% |  dh  | dhbar |  dh%  | 	
	 | ----- | ----- | ----- | ----- | ---- | ----- | ----- |  
	 | m2    | 37.21 | 58.85 | 0.084 | 0.93 | 0.018 | 0.075 |  
	 | k1    | 86.34 | 75.46 | 0.095 | 0.27 | 0.007 | 0.105 |  
	-----------------------------------------------------------
 
Calculate hsal and beta: 
 1. for m2: done (CPU: 4.9733, Wall: 3.235)
 2. for k1: done (CPU: 4.6003, Wall: 2.675)
  Welcome to calc_dhat: Projecting: ******** done (CPU: 10.032, Wall: 10.034)
  Storing: ** done (CPU: 0.243, Wall: 0.243)
===>>> Total time spent on Iteration 3:  2:05.139 CPU, 35.425  Wall
==============
 Iteration 4
==============
 1. for m2: assembling the matrix and rhs, implementing b.c. 
   b) Factorization... done (1.8Gb).    c) Solve... done (CPU: 45.081, Wall: 6.039)
 2. for k1: assembling the matrix and rhs, implementing b.c. 
   b) Factorization... done (1.8Gb).    c) Solve... done (CPU: 44.196, Wall: 5.889)
	-----------------------------------------------------------
	 | Convg |   du  |   dv  |  duv% |  dh  | dhbar |  dh%  | 	
	 | ----- | ----- | ----- | ----- | ---- | ----- | ----- |  
	 | m2    | 20.80 | 24.53 | 0.038 | 0.43 | 0.008 | 0.035 |  
	 | k1    | 26.76 | 23.27 | 0.042 | 0.11 | 0.003 | 0.046 |  
	-----------------------------------------------------------
 
Calculate hsal and beta: 
 1. for m2: done (CPU: 5.6992, Wall: 3.365)
 2. for k1: done (CPU: 4.7753, Wall: 2.724)
  Welcome to calc_dhat: Projecting: ******** done (CPU: 10.081, Wall: 10.095)
  Storing: ** done (CPU: 0.239, Wall: 0.239)
===>>> Total time spent on Iteration 4:  2:03.862 CPU, 35.291  Wall
==============
 Iteration 5
==============
 1. for m2: assembling the matrix and rhs, implementing b.c. 
   b) Factorization... done (1.8Gb).    c) Solve... done (CPU: 44.613, Wall: 5.954)
 2. for k1: assembling the matrix and rhs, implementing b.c. 
   b) Factorization... done (1.8Gb).    c) Solve... done (CPU: 43.663, Wall: 5.852)
	-----------------------------------------------------------
	 | Convg |   du  |   dv  |  duv% |  dh  | dhbar |  dh%  | 	
	 | ----- | ----- | ----- | ----- | ---- | ----- | ----- |  
	 | m2    | 11.00 |  9.97 | 0.018 | 0.22 | 0.004 | 0.017 |  
	 | k1    | 10.19 | 10.50 | 0.019 | 0.05 | 0.001 | 0.021 |  
	-----------------------------------------------------------
 
Calculate hsal and beta: 
 1. for m2: done (CPU: 5.1032, Wall: 3.267)
 2. for k1: done (CPU: 4.4493, Wall: 2.638)
  Welcome to calc_dhat: Projecting: ******** done (CPU: 10.031, Wall: 10.074)
  Storing: ** done (CPU: 0.240, Wall: 0.242)
===>>> Total time spent on Iteration 5:  2:08.237 CPU, 34.936  Wall
==============
 Iteration 6
==============
 1. for m2: assembling the matrix and rhs, implementing b.c. 
   b) Factorization... done (1.8Gb).    c) Solve... done (CPU: 43.665, Wall: 5.861)
 2. for k1: assembling the matrix and rhs, implementing b.c. 
   b) Factorization... done (1.8Gb).    c) Solve... done (CPU: 44.992, Wall: 6.046)
	-----------------------------------------------------------
	 | Convg |  du  |  dv  |  duv% |  dh  | dhbar |  dh%  | 	
	 | ----- | ---- | ---- | ----- | ---- | ----- | ----- |  
	 | m2    | 5.61 | 4.55 | 0.009 | 0.11 | 0.002 | 0.008 |  
	 | k1    | 4.36 | 4.21 | 0.009 | 0.02 | 0.001 | 0.010 |  
	-----------------------------------------------------------
 
Calculate hsal and beta: 
 1. for m2: done (CPU: 4.7833, Wall: 3.321)
 2. for k1: done (CPU: 4.5803, Wall: 2.631)
  Welcome to calc_dhat: Projecting: ******** done (CPU: 10.029, Wall: 10.053)
  Storing: ** done (CPU: 0.241, Wall: 0.245)
===>>> Total time spent on Iteration 6:  2:04.053 CPU, 35.035  Wall
==============
 Iteration 7
==============
 1. for m2: assembling the matrix and rhs, implementing b.c. 
   b) Factorization... done (1.8Gb).    c) Solve... done (CPU: 43.365, Wall: 5.767)
 2. for k1: assembling the matrix and rhs, implementing b.c. 
   b) Factorization... done (1.8Gb).    c) Solve... done (CPU: 44.252, Wall: 5.929)
	-----------------------------------------------------------
	 | Convg |  du  |  dv  |  duv% |  dh  | dhbar |  dh%  | 	
	 | ----- | ---- | ---- | ----- | ---- | ----- | ----- |  
	 | m2    | 2.81 | 2.20 | 0.004 | 0.05 | 0.001 | 0.004 |  
	 | k1    | 1.92 | 2.46 | 0.005 | 0.01 | 0.000 | 0.005 |  
	-----------------------------------------------------------
 
Calculate hsal and beta: 
 1. for m2: done (CPU: 5.3322, Wall: 3.332)
 2. for k1: done (CPU: 4.5943, Wall: 2.638)
  Welcome to calc_dhat: Projecting: ******** done (CPU: 10.044, Wall: 10.086)
  Storing: ** done (CPU: 0.245, Wall: 0.247)
===>>> Total time spent on Iteration 7:  2:06.669 CPU, 35.034  Wall
========================================================================
========================================================================
 
===>>> Total time spent on solving the system: 15:08.314 CPU, 4:14.001  Wall
 
-----------------------------------------------------------------------------
m2:	KE = 183.7 PJ, PE = 157.3 PJ, D = 2.614 TW.
	D_BL = 0.890 TW, D_IT = 1.719 TW, D_SAL = 0.004 GW, D_f = -0.027 GW.
	---------------------------------------------------------------------
	 | **** | Total | Shallow |  Deep | Coastal |  Open | 	
	 | ---- | ----- | ------- | ----- | ------- | ----- |  
	 | D_BL | 0.890 |  0.884  | 0.006 |  0.878  | 0.012 |  
	 | D_IT | 1.719 |  0.626  | 1.093 |  1.015  | 0.704 |  
	 | D    | 2.609 |  1.510  | 1.100 |  1.893  | 0.717 |  
-----------------------------------------------------------------------------
k1:	KE = 40.1 PJ, PE = 23.7 PJ, D = 0.341 TW.
	D_BL = 0.171 TW, D_IT = 0.170 TW, D_SAL = 0.001 GW, D_f = -0.375 GW.
	---------------------------------------------------------------------
	 | **** | Total | Shallow |  Deep | Coastal |  Open | 	
	 | ---- | ----- | ------- | ----- | ------- | ----- |  
	 | D_BL | 0.171 |  0.169  | 0.002 |  0.158  | 0.013 |  
	 | D_IT | 0.170 |  0.012  | 0.158 |  0.115  | 0.055 |  
	 | D    | 0.341 |  0.181  | 0.160 |  0.273  | 0.068 |  
 
===>>> Calculation of domain integrals: 29.401 CPU, 29.441  Wall
Cleaning up temporary files 
[H[2JSaving data as 2013_01_24__00_29
Loading topography file: /home/amt6/amtvl/Desktop/scratch/Tides/data/LAG/baro_fd/in/topo/nocs/topo_rot_2.0min_pole_15_-40.dat 
Interpolating topo to 15.00 min resolution global grid:  done.
****** Ocean is in the first/last tau index of H_hg. Removed ******
Removing bays and inlets: 1371 + 335 + 156 + 78 + 48 + 31 + 21 + 16 + 13 + 8 + 4 + 3 + 3 + 2 + 0.
Removing inland seas/lakes: found 26 connected components; removed 23 of size < 144 cells.
Smoothing topography for the linear ITD scheme: Loading topography file: /home/amt6/amtvl/Desktop/scratch/Tides/data/LAG/baro_fd/in/topo/nocs/smoothed_t1_trunc1440_topo_rot_2.0min_pole_15_-40.dat 
done (CPU: 0.396, Wall: 0.399)
Allocating grid points: 679779 for u, 683462 for v, 675152  for h.
Making vectors: tau, H, evaluating on the u-, v-, h-grid (CPU: 0.1s, Wall:0.1s)
Making matrices:
 - d/dph and 1 for h-grid functions, evaluating on the u-grid (CPU: 0.1s, Wall:0.1s)
 - d/dta and 1 for h grid functions, evaluating on the v-grid (CPU: 0.1s, Wall:0.1s)
 - d/dph and 1 for u-grid functions, evaluating on the h-grid (CPU: 0.1s, Wall:0.1s)
 - d/dta and 1 for v-grid functions, evaluating on the h-grid (CPU: 0.1s, Wall:0.1s)
 - v & fv,     			     evaluating on the u-grid (CPU: 0.5s, Wall:0.5s)
 - u & fu,     			     evaluating on the v-grid (CPU: 0.5s, Wall:0.5s)
Saving matrices: done.
Preparing matrices: GHU, GHV, KU, KV, v2uf, u2vf, Linear BBL, Linear ITD (1 matrix per constituent), b.c. DONE
====================================
Welcome to baro_solver (nonlinear)
====================================
==============
 Iteration 1
==============
Have [2.04E+06 x 2.04E+06] sparse matrix (nnz = 1.28E+07). Solve with pardiso.
 1. for m2: assembling the matrix and rhs, implementing b.c. 
   a) Reordering... done (peak-1.5Gb; permanent-1.2Gb) 
      Size of matrix factors 1.7Gb < 15.0Gb RAM+Swap. Running in-core with peak memory usage: 3.0Gb.
   b) Factorization... done (1.7Gb).    c) Solve... done (CPU: 1:04.288, Wall: 12.708)
 2. for k1: assembling the matrix and rhs, implementing b.c. 
   b) Factorization... done (1.7Gb).    c) Solve... done (CPU: 41.736, Wall: 5.604)
	-----------------------------------------------------------
	 | Convg |   du   |   dv   |  duv%  |  dh  | dhbar |  dh%  | 	
	 | ----- | ------ | ------ | ------ | ---- | ----- | ----- |  
	 | m2    | 577.00 | 421.76 | 47.797 | 6.24 | 0.345 | 0.345 |  
	 | k1    | 771.13 | 676.96 | 14.909 | 3.05 | 0.109 | 0.109 |  
	-----------------------------------------------------------
 
Calculate hsal and beta: 
 1. for m2: done (CPU: 9.6725, Wall: 7.967)
 2. for k1: done (CPU: 4.6683, Wall: 2.641)
  Welcome to calc_dhat: Projecting: ******** done (CPU: 10.042, Wall: 10.045)
  Storing: ** done (CPU: 0.259, Wall: 0.260)
===>>> Total time spent on Iteration 1:  2:27.681 CPU, 46.143  Wall
==============
 Iteration 2
==============
 1. for m2: assembling the matrix and rhs, implementing b.c. 
   b) Factorization... done (1.7Gb).    c) Solve... done (CPU: 43.800, Wall: 5.914)
 2. for k1: assembling the matrix and rhs, implementing b.c. 
   b) Factorization... done (1.7Gb).    c) Solve... done (CPU: 42.186, Wall: 5.643)
	-----------------------------------------------------------
	 | Convg |   du   |   dv   |  duv% |  dh  | dhbar |  dh%  | 	
	 | ----- | ------ | ------ | ----- | ---- | ----- | ----- |  
	 | m2    |  80.89 | 140.27 | 0.258 | 2.69 | 0.046 | 0.243 |  
	 | k1    | 274.13 | 240.12 | 0.338 | 0.67 | 0.016 | 0.257 |  
	-----------------------------------------------------------
 
Calculate hsal and beta: 
 1. for m2: done (CPU: 5.2822, Wall: 3.356)
 2. for k1: done (CPU: 4.6293, Wall: 2.668)
  Welcome to calc_dhat: Projecting: ******** done (CPU: 10.000, Wall: 10.005)
  Storing: ** done (CPU: 0.239, Wall: 0.240)
===>>> Total time spent on Iteration 2:  2:01.575 CPU, 34.611  Wall
==============
 Iteration 3
==============
 1. for m2: assembling the matrix and rhs, implementing b.c. 
   b) Factorization... done (1.7Gb).    c) Solve... done (CPU: 41.427, Wall: 5.535)
 2. for k1: assembling the matrix and rhs, implementing b.c. 
   b) Factorization... done (1.7Gb).    c) Solve... done (CPU: 42.021, Wall: 5.635)
	-----------------------------------------------------------
	 | Convg |   du  |   dv  |  duv% |  dh  | dhbar |  dh%  | 	
	 | ----- | ----- | ----- | ----- | ---- | ----- | ----- |  
	 | m2    | 37.21 | 58.85 | 0.084 | 0.93 | 0.018 | 0.075 |  
	 | k1    | 86.34 | 75.46 | 0.095 | 0.27 | 0.007 | 0.105 |  
	-----------------------------------------------------------
 
Calculate hsal and beta: 
 1. for m2: done (CPU: 5.2692, Wall: 3.276)
 2. for k1: done (CPU: 4.5393, Wall: 2.661)
  Welcome to calc_dhat: Projecting: ******** done (CPU: 10.049, Wall: 10.050)
  Storing: ** done (CPU: 0.245, Wall: 0.245)
===>>> Total time spent on Iteration 3:  2:01.026 CPU, 34.269  Wall
==============
 Iteration 4
==============
 1. for m2: assembling the matrix and rhs, implementing b.c. 
   b) Factorization... done (1.7Gb).    c) Solve... done (CPU: 41.488, Wall: 5.578)
 2. for k1: assembling the matrix and rhs, implementing b.c. 
   b) Factorization... done (1.7Gb).    c) Solve... done (CPU: 42.009, Wall: 5.670)
	-----------------------------------------------------------
	 | Convg |   du  |   dv  |  duv% |  dh  | dhbar |  dh%  | 	
	 | ----- | ----- | ----- | ----- | ---- | ----- | ----- |  
	 | m2    | 20.80 | 24.53 | 0.038 | 0.43 | 0.008 | 0.035 |  
	 | k1    | 26.76 | 23.27 | 0.042 | 0.11 | 0.003 | 0.046 |  
	-----------------------------------------------------------
 
Calculate hsal and beta: 
 1. for m2: done (CPU: 5.2842, Wall: 3.291)
 2. for k1: done (CPU: 4.1653, Wall: 2.577)
  Welcome to calc_dhat: Projecting: ******** done (CPU: 10.010, Wall: 10.015)
  Storing: ** done (CPU: 0.239, Wall: 0.240)
===>>> Total time spent on Iteration 4:  2:02.235 CPU, 34.134  Wall
==============
 Iteration 5
==============
 1. for m2: assembling the matrix and rhs, implementing b.c. 
   b) Factorization... done (1.7Gb).    c) Solve... done (CPU: 41.722, Wall: 5.581)
 2. for k1: assembling the matrix and rhs, implementing b.c. 
   b) Factorization... done (1.7Gb).    c) Solve... done (CPU: 41.724, Wall: 5.632)
	-----------------------------------------------------------
	 | Convg |   du  |   dv  |  duv% |  dh  | dhbar |  dh%  | 	
	 | ----- | ----- | ----- | ----- | ---- | ----- | ----- |  
	 | m2    | 11.00 |  9.97 | 0.018 | 0.22 | 0.004 | 0.017 |  
	 | k1    | 10.19 | 10.50 | 0.019 | 0.05 | 0.001 | 0.021 |  
	-----------------------------------------------------------
 
Calculate hsal and beta: 
 1. for m2: done (CPU: 5.2452, Wall: 3.325)
 2. for k1: done (CPU: 4.2433, Wall: 2.64)
  Welcome to calc_dhat: Projecting: ******** done (CPU: 10.017, Wall: 10.034)
  Storing: ** done (CPU: 0.239, Wall: 0.240)
===>>> Total time spent on Iteration 5:  2:02.134 CPU, 34.277  Wall
==============
 Iteration 6
==============
 1. for m2: assembling the matrix and rhs, implementing b.c. 
   b) Factorization... done (1.7Gb).    c) Solve... done (CPU: 43.830, Wall: 5.872)
 2. for k1: assembling the matrix and rhs, implementing b.c. 
   b) Factorization... done (1.7Gb).    c) Solve... done (CPU: 43.640, Wall: 5.797)
	-----------------------------------------------------------
	 | Convg |  du  |  dv  |  duv% |  dh  | dhbar |  dh%  | 	
	 | ----- | ---- | ---- | ----- | ---- | ----- | ----- |  
	 | m2    | 5.61 | 4.55 | 0.009 | 0.11 | 0.002 | 0.008 |  
	 | k1    | 4.36 | 4.21 | 0.009 | 0.02 | 0.001 | 0.010 |  
	-----------------------------------------------------------
 
Calculate hsal and beta: 
 1. for m2: done (CPU: 5.2692, Wall: 3.305)
 2. for k1: done (CPU: 4.5894, Wall: 2.652)
  Welcome to calc_dhat: Projecting: ******** done (CPU: 10.037, Wall: 10.038)
  Storing: ** done (CPU: 0.243, Wall: 0.244)
===>>> Total time spent on Iteration 6:  2:06.537 CPU, 34.898  Wall
==============
 Iteration 7
==============
 1. for m2: assembling the matrix and rhs, implementing b.c. 
   b) Factorization... done (1.7Gb).    c) Solve... done (CPU: 41.805, Wall: 5.586)
 2. for k1: assembling the matrix and rhs, implementing b.c. 
   b) Factorization... done (1.7Gb).    c) Solve... done (CPU: 42.147, Wall: 5.669)
	-----------------------------------------------------------
	 | Convg |  du  |  dv  |  duv% |  dh  | dhbar |  dh%  | 	
	 | ----- | ---- | ---- | ----- | ---- | ----- | ----- |  
	 | m2    | 2.81 | 2.20 | 0.004 | 0.05 | 0.001 | 0.004 |  
	 | k1    | 1.92 | 2.46 | 0.005 | 0.01 | 0.000 | 0.005 |  
	-----------------------------------------------------------
 
Calculate hsal and beta: 
 1. for m2: done (CPU: 5.1252, Wall: 3.303)
 2. for k1: done (CPU: 4.6203, Wall: 2.657)
  Welcome to calc_dhat: Projecting: ******** done (CPU: 10.033, Wall: 10.041)
  Storing: ** done (CPU: 0.240, Wall: 0.241)
===>>> Total time spent on Iteration 7:  2:05.516 CPU, 34.432  Wall
========================================================================
========================================================================
 
===>>> Total time spent on solving the system: 14:46.721 CPU, 4:12.781  Wall
 
-----------------------------------------------------------------------------
m2:	KE = 183.7 PJ, PE = 157.3 PJ, D = 2.614 TW.
	D_BL = 0.890 TW, D_IT = 1.719 TW, D_SAL = 0.004 GW, D_f = -0.027 GW.
	---------------------------------------------------------------------
	 | **** | Total | Shallow |  Deep | Coastal |  Open | 	
	 | ---- | ----- | ------- | ----- | ------- | ----- |  
	 | D_BL | 0.890 |  0.884  | 0.006 |  0.878  | 0.012 |  
	 | D_IT | 1.719 |  0.626  | 1.093 |  1.015  | 0.704 |  
	 | D    | 2.609 |  1.510  | 1.100 |  1.893  | 0.717 |  
-----------------------------------------------------------------------------
k1:	KE = 40.1 PJ, PE = 23.7 PJ, D = 0.341 TW.
	D_BL = 0.171 TW, D_IT = 0.170 TW, D_SAL = 0.001 GW, D_f = -0.375 GW.
	---------------------------------------------------------------------
	 | **** | Total | Shallow |  Deep | Coastal |  Open | 	
	 | ---- | ----- | ------- | ----- | ------- | ----- |  
	 | D_BL | 0.171 |  0.169  | 0.002 |  0.158  | 0.013 |  
	 | D_IT | 0.170 |  0.012  | 0.158 |  0.115  | 0.055 |  
	 | D    | 0.341 |  0.181  | 0.160 |  0.273  | 0.068 |  
 
===>>> Calculation of domain integrals: 29.436 CPU, 29.447  Wall
Cleaning up temporary files 
[H[2JSaving data as 2013_01_24__16_19
Loading topography file: /home/amt6/amtvl/Desktop/scratch/Tides/data/LAG/baro_fd/in/topo/nocs/topo_rot_2.0min_pole_15_-40.dat 
Interpolating topo to 15.00 min resolution global grid:  done.
****** Ocean is in the first/last tau index of H_hg. Removed ******
Removing bays and inlets: 1371 + 335 + 156 + 78 + 48 + 31 + 21 + 16 + 13 + 8 + 4 + 3 + 3 + 2 + 0.
Removing inland seas/lakes: found 26 connected components; removed 23 of size < 144 cells.
Smoothing topography for the linear ITD scheme: Loading topography file: /home/amt6/amtvl/Desktop/scratch/Tides/data/LAG/baro_fd/in/topo/nocs/smoothed_t1_trunc1440_topo_rot_2.0min_pole_15_-40.dat 
done (CPU: 0.394, Wall: 0.395)
Allocating grid points: 679779 for u, 683462 for v, 675152  for h.
Making vectors: tau, H, evaluating on the u-, v-, h-grid (CPU: 0.1s, Wall:0.1s)
Making matrices:
 - d/dph and 1 for h-grid functions, evaluating on the u-grid (CPU: 0.1s, Wall:0.1s)
 - d/dta and 1 for h grid functions, evaluating on the v-grid (CPU: 0.1s, Wall:0.1s)
 - d/dph and 1 for u-grid functions, evaluating on the h-grid (CPU: 0.1s, Wall:0.1s)
 - d/dta and 1 for v-grid functions, evaluating on the h-grid (CPU: 0.1s, Wall:0.1s)
 - v & fv,     			     evaluating on the u-grid (CPU: 0.5s, Wall:0.5s)
 - u & fu,     			     evaluating on the v-grid (CPU: 0.5s, Wall:0.5s)
Saving matrices: done.
Preparing matrices: GHU, GHV, KU, KV, v2uf, u2vf, Linear BBL, Linear ITD (1 matrix per constituent), b.c. DONE
====================================
Welcome to baro_solver (nonlinear)
====================================
==============
 Iteration 1
==============
Have [2.04E+06 x 2.04E+06] sparse matrix (nnz = 1.28E+07). Solve with pardiso.
 1. for m2: assembling the matrix and rhs, implementing b.c. 
   a) Reordering... done (peak-1.5Gb; permanent-1.2Gb) 
      Size of matrix factors 1.7Gb < 15.0Gb RAM+Swap. Running in-core with peak memory usage: 3.0Gb.
   b) Factorization... done (1.7Gb).    c) Solve... done (CPU: 1:02.948, Wall: 12.505)
 2. for k1: assembling the matrix and rhs, implementing b.c. 
   b) Factorization... done (1.7Gb).    c) Solve... done (CPU: 40.661, Wall: 5.464)
	-----------------------------------------------------------
	 | Convg |   du   |   dv   |  duv%  |  dh  | dhbar |  dh%  | 	
	 | ----- | ------ | ------ | ------ | ---- | ----- | ----- |  
	 | m2    | 728.30 | 469.49 | 54.379 | 8.22 | 0.402 | 0.402 |  
	 | k1    | 816.53 | 683.90 | 15.293 | 3.07 | 0.112 | 0.112 |  
	-----------------------------------------------------------
 
Calculate hsal and beta: 
 1. for m2: done (CPU: 9.4236, Wall: 7.902)
 2. for k1: done (CPU: 4.4873, Wall: 2.612)
  Welcome to calc_dhat: Projecting: ******** done (CPU: 10.053, Wall: 10.100)
  Storing: ** done (CPU: 0.258, Wall: 0.260)
===>>> Total time spent on Iteration 1:  2:21.301 CPU, 45.756  Wall
==============
 Iteration 2
==============
 1. for m2: assembling the matrix and rhs, implementing b.c. 
   b) Factorization... done (1.7Gb).    c) Solve... done (CPU: 41.892, Wall: 5.618)
 2. for k1: assembling the matrix and rhs, implementing b.c. 
   b) Factorization... done (1.7Gb).    c) Solve... done (CPU: 41.572, Wall: 5.640)
	-----------------------------------------------------------
	 | Convg |   du   |   dv   |  duv% |  dh  | dhbar |  dh%  | 	
	 | ----- | ------ | ------ | ----- | ---- | ----- | ----- |  
	 | m2    | 106.08 | 154.77 | 0.282 | 2.98 | 0.059 | 0.256 |  
	 | k1    | 297.52 | 246.62 | 0.314 | 0.64 | 0.016 | 0.259 |  
	-----------------------------------------------------------
 
Calculate hsal and beta: 
 1. for m2: done (CPU: 5.3502, Wall: 3.384)
 2. for k1: done (CPU: 4.8693, Wall: 2.703)
  Welcome to calc_dhat: Projecting: ******** done (CPU: 10.000, Wall: 10.006)
  Storing: ** done (CPU: 0.238, Wall: 0.239)
===>>> Total time spent on Iteration 2:  2:00.731 CPU, 35.101  Wall
==============
 Iteration 3
==============
 1. for m2: assembling the matrix and rhs, implementing b.c. 
   b) Factorization... done (1.7Gb).    c) Solve... done (CPU: 39.799, Wall: 5.303)
 2. for k1: assembling the matrix and rhs, implementing b.c. 
   b) Factorization... done (1.7Gb).    c) Solve... done (CPU: 39.848, Wall: 5.395)
	-----------------------------------------------------------
	 | Convg |   du  |   dv  |  duv% |  dh  | dhbar |  dh%  | 	
	 | ----- | ----- | ----- | ----- | ---- | ----- | ----- |  
	 | m2    | 47.15 | 67.63 | 0.091 | 1.07 | 0.023 | 0.083 |  
	 | k1    | 90.27 | 79.33 | 0.088 | 0.26 | 0.007 | 0.094 |  
	-----------------------------------------------------------
 
Calculate hsal and beta: 
 1. for m2: done (CPU: 5.0842, Wall: 3.281)
 2. for k1: done (CPU: 4.5363, Wall: 2.649)
  Welcome to calc_dhat: Projecting: ******** done (CPU: 10.029, Wall: 10.036)
  Storing: ** done (CPU: 0.241, Wall: 0.242)
===>>> Total time spent on Iteration 3:  1:55.671 CPU, 33.811  Wall
==============
 Iteration 4
==============
 1. for m2: assembling the matrix and rhs, implementing b.c. 
   b) Factorization... done (1.7Gb).    c) Solve... done (CPU: 40.003, Wall: 5.331)
 2. for k1: assembling the matrix and rhs, implementing b.c. 
   b) Factorization... done (1.7Gb).    c) Solve... done (CPU: 41.006, Wall: 5.528)
	-----------------------------------------------------------
	 | Convg |   du  |   dv  |  duv% |  dh  | dhbar |  dh%  | 	
	 | ----- | ----- | ----- | ----- | ---- | ----- | ----- |  
	 | m2    | 24.86 | 27.54 | 0.041 | 0.53 | 0.010 | 0.038 |  
	 | k1    | 28.75 | 25.11 | 0.038 | 0.12 | 0.003 | 0.040 |  
	-----------------------------------------------------------
 
Calculate hsal and beta: 
 1. for m2: done (CPU: 5.5712, Wall: 3.319)
 2. for k1: done (CPU: 4.3543, Wall: 2.609)
  Welcome to calc_dhat: Projecting: ******** done (CPU: 10.036, Wall: 10.045)
  Storing: ** done (CPU: 0.241, Wall: 0.242)
===>>> Total time spent on Iteration 4:  1:56.739 CPU, 33.923  Wall
==============
 Iteration 5
==============
 1. for m2: assembling the matrix and rhs, implementing b.c. 
   b) Factorization... done (1.7Gb).    c) Solve... done (CPU: 41.009, Wall: 5.500)
 2. for k1: assembling the matrix and rhs, implementing b.c. 
   b) Factorization... done (1.7Gb).    c) Solve... done (CPU: 39.631, Wall: 5.316)
	-----------------------------------------------------------
	 | Convg |   du  |   dv  |  duv% |  dh  | dhbar |  dh%  | 	
	 | ----- | ----- | ----- | ----- | ---- | ----- | ----- |  
	 | m2    | 12.86 | 10.83 | 0.019 | 0.27 | 0.005 | 0.018 |  
	 | k1    | 11.17 | 10.91 | 0.018 | 0.05 | 0.001 | 0.019 |  
	-----------------------------------------------------------
 
Calculate hsal and beta: 
 1. for m2: done (CPU: 4.5853, Wall: 3.21)
 2. for k1: done (CPU: 4.5443, Wall: 2.613)
  Welcome to calc_dhat: Projecting: ******** done (CPU: 9.994, Wall: 9.996)
  Storing: ** done (CPU: 0.240, Wall: 0.241)
===>>> Total time spent on Iteration 5:  1:59.046 CPU, 33.902  Wall
==============
 Iteration 6
==============
 1. for m2: assembling the matrix and rhs, implementing b.c. 
   b) Factorization... done (1.7Gb).    c) Solve... done (CPU: 39.888, Wall: 5.346)
 2. for k1: assembling the matrix and rhs, implementing b.c. 
   b) Factorization... done (1.7Gb).    c) Solve... done (CPU: 40.069, Wall: 5.372)
	-----------------------------------------------------------
	 | Convg |  du  |  dv  |  duv% |  dh  | dhbar |  dh%  | 	
	 | ----- | ---- | ---- | ----- | ---- | ----- | ----- |  
	 | m2    | 6.56 | 5.01 | 0.009 | 0.13 | 0.002 | 0.008 |  
	 | k1    | 4.88 | 4.64 | 0.009 | 0.02 | 0.001 | 0.009 |  
	-----------------------------------------------------------
 
Calculate hsal and beta: 
 1. for m2: done (CPU: 4.9592, Wall: 3.267)
 2. for k1: done (CPU: 4.7013, Wall: 2.687)
  Welcome to calc_dhat: Projecting: ******** done (CPU: 10.065, Wall: 10.097)
  Storing: ** done (CPU: 0.244, Wall: 0.245)
===>>> Total time spent on Iteration 6:  1:57.189 CPU, 33.941  Wall
==============
 Iteration 7
==============
 1. for m2: assembling the matrix and rhs, implementing b.c. 
   b) Factorization... done (1.7Gb).    c) Solve... done (CPU: 41.481, Wall: 5.625)
 2. for k1: assembling the matrix and rhs, implementing b.c. 
   b) Factorization... done (1.7Gb).    c) Solve... done (CPU: 39.761, Wall: 5.300)
	-----------------------------------------------------------
	 | Convg |  du  |  dv  |  duv% |  dh  | dhbar |  dh%  | 	
	 | ----- | ---- | ---- | ----- | ---- | ----- | ----- |  
	 | m2    | 3.33 | 2.49 | 0.004 | 0.06 | 0.001 | 0.004 |  
	 | k1    | 2.18 | 2.41 | 0.004 | 0.01 | 0.000 | 0.005 |  
	-----------------------------------------------------------
 
Calculate hsal and beta: 
 1. for m2: done (CPU: 5.0703, Wall: 3.273)
 2. for k1: done (CPU: 4.0114, Wall: 2.632)
  Welcome to calc_dhat: Projecting: ******** done (CPU: 10.004, Wall: 10.010)
  Storing: ** done (CPU: 0.239, Wall: 0.240)
===>>> Total time spent on Iteration 7:  2:01.659 CPU, 34.034  Wall
========================================================================
========================================================================
 
===>>> Total time spent on solving the system: 14:12.352 CPU, 4:10.483  Wall
 
-----------------------------------------------------------------------------
m2:	KE = 240.7 PJ, PE = 210.8 PJ, D = 2.776 TW.
	D_BL = 1.458 TW, D_IT = 1.312 TW, D_SAL = 0.003 GW, D_f = -0.049 GW.
	---------------------------------------------------------------------
	 | **** | Total | Shallow |  Deep | Coastal |  Open | 	
	 | ---- | ----- | ------- | ----- | ------- | ----- |  
	 | D_BL | 1.458 |  1.449  | 0.009 |  1.439  | 0.019 |  
	 | D_IT | 1.312 |  0.551  | 0.761 |  0.821  | 0.491 |  
	 | D    | 2.770 |  2.000  | 0.770 |  2.260  | 0.510 |  
-----------------------------------------------------------------------------
k1:	KE = 41.2 PJ, PE = 24.2 PJ, D = 0.322 TW.
	D_BL = 0.193 TW, D_IT = 0.129 TW, D_SAL = 0.001 GW, D_f = -0.413 GW.
	---------------------------------------------------------------------
	 | **** | Total | Shallow |  Deep | Coastal |  Open | 	
	 | ---- | ----- | ------- | ----- | ------- | ----- |  
	 | D_BL | 0.193 |  0.190  | 0.003 |  0.178  | 0.014 |  
	 | D_IT | 0.129 |  0.030  | 0.099 |  0.097  | 0.032 |  
	 | D    | 0.322 |  0.220  | 0.102 |  0.276  | 0.046 |  
 
===>>> Calculation of domain integrals: 29.452 CPU, 29.489  Wall
Cleaning up temporary files 
[H[2JSaving data as 2013_01_25__00_57
Loading topography file: /home/amt6/amtvl/Desktop/scratch/Tides/data/LAG/baro_fd/in/topo/nocs/topo_rot_2.0min_pole_15_-40.dat 
Interpolating topo to 15.00 min resolution global grid:  done.
****** Ocean is in the first/last tau index of H_hg. Removed ******
Removing bays and inlets: 1371 + 335 + 156 + 78 + 48 + 31 + 21 + 16 + 13 + 8 + 4 + 3 + 3 + 2 + 0.
Removing inland seas/lakes: found 26 connected components; removed 23 of size < 144 cells.
Smoothing topography for the linear ITD scheme: Loading topography file: /home/amt6/amtvl/Desktop/scratch/Tides/data/LAG/baro_fd/in/topo/nocs/smoothed_t1_trunc1440_topo_rot_2.0min_pole_15_-40.dat 
done (CPU: 0.394, Wall: 0.394)
Allocating grid points: 679779 for u, 683462 for v, 675152  for h.
Making vectors: tau, H, evaluating on the u-, v-, h-grid (CPU: 0.1s, Wall:0.1s)
Making matrices:
 - d/dph and 1 for h-grid functions, evaluating on the u-grid (CPU: 0.1s, Wall:0.1s)
 - d/dta and 1 for h grid functions, evaluating on the v-grid (CPU: 0.1s, Wall:0.1s)
 - d/dph and 1 for u-grid functions, evaluating on the h-grid (CPU: 0.1s, Wall:0.1s)
 - d/dta and 1 for v-grid functions, evaluating on the h-grid (CPU: 0.1s, Wall:0.1s)
 - v & fv,     			     evaluating on the u-grid (CPU: 0.5s, Wall:0.5s)
 - u & fu,     			     evaluating on the v-grid (CPU: 0.5s, Wall:0.5s)
Saving matrices: done.
Preparing matrices: GHU, GHV, KU, KV, v2uf, u2vf, Linear BBL, Linear ITD (1 matrix per constituent), b.c. DONE
====================================
Welcome to baro_solver (nonlinear)
====================================
==============
 Iteration 1
==============
Have [2.04E+06 x 2.04E+06] sparse matrix (nnz = 1.28E+07). Solve with pardiso.
 1. for m2: assembling the matrix and rhs, implementing b.c. 
   a) Reordering... done (peak-1.5Gb; permanent-1.2Gb) 
      Size of matrix factors 1.7Gb < 15.0Gb RAM+Swap. Running in-core with peak memory usage: 3.0Gb.
   b) Factorization... done (1.7Gb).    c) Solve... done (CPU: 1:04.544, Wall: 12.621)
 2. for k1: assembling the matrix and rhs, implementing b.c. 
   b) Factorization... done (1.7Gb).    c) Solve... done (CPU: 41.777, Wall: 5.598)
	-----------------------------------------------------------
	 | Convg |   du   |   dv   |  duv%  |  dh  | dhbar |  dh%  | 	
	 | ----- | ------ | ------ | ------ | ---- | ----- | ----- |  
	 | m2    | 715.72 | 461.23 | 53.755 | 8.02 | 0.397 | 0.397 |  
	 | k1    | 812.45 | 683.44 | 15.256 | 3.07 | 0.112 | 0.112 |  
	-----------------------------------------------------------
 
Calculate hsal and beta: 
 1. for m2: done (CPU: 9.7855, Wall: 7.882)
 2. for k1: done (CPU: 4.6073, Wall: 2.688)
  Welcome to calc_dhat: Projecting: ******** done (CPU: 10.045, Wall: 10.069)
  Storing: ** done (CPU: 0.257, Wall: 0.260)
===>>> Total time spent on Iteration 1:  2:32.830 CPU, 46.095  Wall
==============
 Iteration 2
==============
 1. for m2: assembling the matrix and rhs, implementing b.c. 
   b) Factorization... done (1.7Gb).    c) Solve... done (CPU: 40.871, Wall: 5.475)
 2. for k1: assembling the matrix and rhs, implementing b.c. 
   b) Factorization... done (1.7Gb).    c) Solve... done (CPU: 41.364, Wall: 5.506)
	-----------------------------------------------------------
	 | Convg |   du   |   dv   |  duv% |  dh  | dhbar |  dh%  | 	
	 | ----- | ------ | ------ | ----- | ---- | ----- | ----- |  
	 | m2    | 104.56 | 153.75 | 0.280 | 2.96 | 0.057 | 0.254 |  
	 | k1    | 295.42 | 245.96 | 0.316 | 0.64 | 0.016 | 0.257 |  
	-----------------------------------------------------------
 
Calculate hsal and beta: 
 1. for m2: done (CPU: 5.0492, Wall: 3.263)
 2. for k1: done (CPU: 4.4333, Wall: 2.648)
  Welcome to calc_dhat: Projecting: ******** done (CPU: 10.052, Wall: 10.064)
  Storing: ** done (CPU: 0.239, Wall: 0.242)
===>>> Total time spent on Iteration 2:  2:01.634 CPU, 34.067  Wall
==============
 Iteration 3
==============
 1. for m2: assembling the matrix and rhs, implementing b.c. 
   b) Factorization... done (1.7Gb).    c) Solve... done (CPU: 40.794, Wall: 5.445)
 2. for k1: assembling the matrix and rhs, implementing b.c. 
   b) Factorization... done (1.7Gb).    c) Solve... done (CPU: 41.233, Wall: 5.500)
	-----------------------------------------------------------
	 | Convg |   du  |   dv  |  duv% |  dh  | dhbar |  dh%  | 	
	 | ----- | ----- | ----- | ----- | ---- | ----- | ----- |  
	 | m2    | 46.33 | 67.01 | 0.090 | 1.06 | 0.022 | 0.082 |  
	 | k1    | 89.86 | 78.93 | 0.088 | 0.26 | 0.007 | 0.095 |  
	-----------------------------------------------------------
 
Calculate hsal and beta: 
 1. for m2: done (CPU: 4.9742, Wall: 3.219)
 2. for k1: done (CPU: 4.6303, Wall: 2.638)
  Welcome to calc_dhat: Projecting: ******** done (CPU: 10.043, Wall: 10.045)
  Storing: ** done (CPU: 0.242, Wall: 0.243)
===>>> Total time spent on Iteration 3:  1:56.229 CPU, 33.992  Wall
==============
 Iteration 4
==============
 1. for m2: assembling the matrix and rhs, implementing b.c. 
   b) Factorization... done (1.7Gb).    c) Solve... done (CPU: 41.036, Wall: 5.488)
 2. for k1: assembling the matrix and rhs, implementing b.c. 
   b) Factorization... done (1.7Gb).    c) Solve... done (CPU: 40.349, Wall: 5.492)
	-----------------------------------------------------------
	 | Convg |   du  |   dv  |  duv% |  dh  | dhbar |  dh%  | 	
	 | ----- | ----- | ----- | ----- | ---- | ----- | ----- |  
	 | m2    | 24.53 | 27.36 | 0.041 | 0.52 | 0.010 | 0.039 |  
	 | k1    | 28.55 | 24.93 | 0.038 | 0.11 | 0.003 | 0.041 |  
	-----------------------------------------------------------
 
Calculate hsal and beta: 
 1. for m2: done (CPU: 5.0372, Wall: 3.223)
 2. for k1: done (CPU: 4.6073, Wall: 2.634)
  Welcome to calc_dhat: Projecting: ******** done (CPU: 10.044, Wall: 10.092)
  Storing: ** done (CPU: 0.242, Wall: 0.243)
===>>> Total time spent on Iteration 4:  1:56.824 CPU, 34.069  Wall
==============
 Iteration 5
==============
 1. for m2: assembling the matrix and rhs, implementing b.c. 
   b) Factorization... done (1.7Gb).    c) Solve... done (CPU: 40.499, Wall: 5.413)
 2. for k1: assembling the matrix and rhs, implementing b.c. 
   b) Factorization... done (1.7Gb).    c) Solve... done (CPU: 41.587, Wall: 5.586)
	-----------------------------------------------------------
	 | Convg |   du  |   dv  |  duv% |  dh  | dhbar |  dh%  | 	
	 | ----- | ----- | ----- | ----- | ---- | ----- | ----- |  
	 | m2    | 12.71 | 10.78 | 0.019 | 0.27 | 0.005 | 0.018 |  
	 | k1    | 11.07 | 10.88 | 0.018 | 0.05 | 0.001 | 0.019 |  
	-----------------------------------------------------------
 
Calculate hsal and beta: 
 1. for m2: done (CPU: 5.2602, Wall: 3.29)
 2. for k1: done (CPU: 4.5383, Wall: 2.564)
  Welcome to calc_dhat: Projecting: ******** done (CPU: 10.037, Wall: 10.053)
  Storing: ** done (CPU: 0.241, Wall: 0.242)
===>>> Total time spent on Iteration 5:  1:59.519 CPU, 34.018  Wall
==============
 Iteration 6
==============
 1. for m2: assembling the matrix and rhs, implementing b.c. 
   b) Factorization... done (1.7Gb).    c) Solve... done (CPU: 40.607, Wall: 5.537)
 2. for k1: assembling the matrix and rhs, implementing b.c. 
   b) Factorization... done (1.7Gb).    c) Solve... done (CPU: 40.927, Wall: 5.501)
	-----------------------------------------------------------
	 | Convg |  du  |  dv  |  duv% |  dh  | dhbar |  dh%  | 	
	 | ----- | ---- | ---- | ----- | ---- | ----- | ----- |  
	 | m2    | 6.49 | 4.98 | 0.009 | 0.13 | 0.002 | 0.008 |  
	 | k1    | 4.83 | 4.48 | 0.009 | 0.02 | 0.001 | 0.009 |  
	-----------------------------------------------------------
 
Calculate hsal and beta: 
 1. for m2: done (CPU: 5.0212, Wall: 3.215)
 2. for k1: done (CPU: 4.4953, Wall: 2.62)
  Welcome to calc_dhat: Projecting: ******** done (CPU: 10.003, Wall: 10.005)
  Storing: ** done (CPU: 0.241, Wall: 0.362)
===>>> Total time spent on Iteration 6:  1:58.230 CPU, 34.055  Wall
==============
 Iteration 7
==============
 1. for m2: assembling the matrix and rhs, implementing b.c. 
   b) Factorization... done (1.7Gb).    c) Solve... done (CPU: 41.278, Wall: 5.487)
 2. for k1: assembling the matrix and rhs, implementing b.c. 
   b) Factorization... done (1.7Gb).    c) Solve... done (CPU: 40.505, Wall: 5.401)
	-----------------------------------------------------------
	 | Convg |  du  |  dv  |  duv% |  dh  | dhbar |  dh%  | 	
	 | ----- | ---- | ---- | ----- | ---- | ----- | ----- |  
	 | m2    | 3.29 | 2.47 | 0.004 | 0.06 | 0.001 | 0.004 |  
	 | k1    | 2.15 | 2.31 | 0.004 | 0.01 | 0.000 | 0.005 |  
	-----------------------------------------------------------
 
Calculate hsal and beta: 
 1. for m2: done (CPU: 5.1322, Wall: 3.226)
 2. for k1: done (CPU: 4.3524, Wall: 2.546)
  Welcome to calc_dhat: Projecting: ******** done (CPU: 10.035, Wall: 10.092)
  Storing: ** done (CPU: 0.240, Wall: 0.242)
===>>> Total time spent on Iteration 7:  1:57.239 CPU, 33.823  Wall
========================================================================
========================================================================
 
===>>> Total time spent on solving the system: 14:22.521 CPU, 4:10.132  Wall
 
-----------------------------------------------------------------------------
m2:	KE = 235.0 PJ, PE = 205.4 PJ, D = 2.762 TW.
	D_BL = 1.398 TW, D_IT = 1.358 TW, D_SAL = 0.003 GW, D_f = -0.047 GW.
	---------------------------------------------------------------------
	 | **** | Total | Shallow |  Deep | Coastal |  Open | 	
	 | ---- | ----- | ------- | ----- | ------- | ----- |  
	 | D_BL | 1.398 |  1.390  | 0.009 |  1.380  | 0.018 |  
	 | D_IT | 1.358 |  0.563  | 0.795 |  0.846  | 0.512 |  
	 | D    | 2.756 |  1.953  | 0.803 |  2.226  | 0.531 |  
-----------------------------------------------------------------------------
k1:	KE = 41.1 PJ, PE = 24.2 PJ, D = 0.324 TW.
	D_BL = 0.190 TW, D_IT = 0.133 TW, D_SAL = 0.001 GW, D_f = -0.409 GW.
	---------------------------------------------------------------------
	 | **** | Total | Shallow |  Deep | Coastal |  Open | 	
	 | ---- | ----- | ------- | ----- | ------- | ----- |  
	 | D_BL | 0.190 |  0.188  | 0.003 |  0.176  | 0.014 |  
	 | D_IT | 0.133 |  0.029  | 0.105 |  0.100  | 0.034 |  
	 | D    | 0.324 |  0.216  | 0.107 |  0.276  | 0.048 |  
 
===>>> Calculation of domain integrals: 29.401 CPU, 29.423  Wall
Cleaning up temporary files 
[H[2JSaving data as 2013_01_26__00_54
Loading topography file: /home/amt6/amtvl/Desktop/scratch/Tides/data/LAG/baro_fd/in/topo/nocs/topo_rot_2.0min_pole_15_-40.dat 
Interpolating topo to 15.00 min resolution global grid:  done.
****** Ocean is in the first/last tau index of H_hg. Removed ******
Removing bays and inlets: 1371 + 335 + 156 + 78 + 48 + 31 + 21 + 16 + 13 + 8 + 4 + 3 + 3 + 2 + 0.
Removing inland seas/lakes: found 26 connected components; removed 23 of size < 144 cells.
Smoothing topography for the linear ITD scheme: Loading topography file: /home/amt6/amtvl/Desktop/scratch/Tides/data/LAG/baro_fd/in/topo/nocs/smoothed_t1_trunc1440_topo_rot_2.0min_pole_15_-40.dat 
done (CPU: 0.399, Wall: 0.400)
Allocating grid points: 679779 for u, 683462 for v, 675152  for h.
Making vectors: tau, H, evaluating on the u-, v-, h-grid (CPU: 0.1s, Wall:0.1s)
Making matrices:
 - d/dph and 1 for h-grid functions, evaluating on the u-grid (CPU: 0.1s, Wall:0.1s)
 - d/dta and 1 for h grid functions, evaluating on the v-grid (CPU: 0.1s, Wall:0.1s)
 - d/dph and 1 for u-grid functions, evaluating on the h-grid (CPU: 0.1s, Wall:0.1s)
 - d/dta and 1 for v-grid functions, evaluating on the h-grid (CPU: 0.1s, Wall:0.1s)
 - v & fv,     			     evaluating on the u-grid (CPU: 0.5s, Wall:0.5s)
 - u & fu,     			     evaluating on the v-grid (CPU: 0.5s, Wall:0.5s)
Saving matrices: done.
Preparing matrices: GHU, GHV, KU, KV, v2uf, u2vf, Linear BBL, Linear ITD (1 matrix per constituent), b.c. DONE
====================================
Welcome to baro_solver (nonlinear)
====================================
==============
 Iteration 1
==============
Have [2.04E+06 x 2.04E+06] sparse matrix (nnz = 1.28E+07). Solve with pardiso.
 1. for m2: assembling the matrix and rhs, implementing b.c. 
   a) Reordering... done (peak-1.5Gb; permanent-1.2Gb) 
      Size of matrix factors 1.7Gb < 15.0Gb RAM+Swap. Running in-core with peak memory usage: 3.0Gb.
   b) Factorization... done (1.7Gb).    c) Solve... done (CPU: 1:04.284, Wall: 12.437)
 2. for k1: assembling the matrix and rhs, implementing b.c. 
   b) Factorization... done (1.7Gb).    c) Solve... done (CPU: 40.394, Wall: 5.298)
	-----------------------------------------------------------
	 | Convg |   du   |   dv   |  duv%  |  dh  | dhbar |  dh%  | 	
	 | ----- | ------ | ------ | ------ | ---- | ----- | ----- |  
	 | m2    | 679.91 | 438.15 | 52.067 | 7.50 | 0.382 | 0.382 |  
	 | k1    | 801.16 | 682.06 | 15.157 | 3.06 | 0.111 | 0.111 |  
	-----------------------------------------------------------
 
Calculate hsal and beta: 
 1. for m2: done (CPU: 10.038, Wall: 8.38)
 2. for k1: done (CPU: 4.2144, Wall: 2.621)
  Welcome to calc_dhat: Projecting: ******** done (CPU: 10.011, Wall: 10.012)
  Storing: ** done (CPU: 0.257, Wall: 0.259)
===>>> Total time spent on Iteration 1:  2:29.298 CPU, 48.231  Wall
==============
 Iteration 2
==============
 1. for m2: assembling the matrix and rhs, implementing b.c. 
   b) Factorization... done (1.7Gb).    c) Solve... done (CPU: 40.488, Wall: 5.355)
 2. for k1: assembling the matrix and rhs, implementing b.c. 
   b) Factorization... done (1.7Gb).    c) Solve... done (CPU: 41.055, Wall: 5.469)
	-----------------------------------------------------------
	 | Convg |   du   |   dv   |  duv% |  dh  | dhbar |  dh%  | 	
	 | ----- | ------ | ------ | ----- | ---- | ----- | ----- |  
	 | m2    |  99.57 | 150.65 | 0.274 | 2.90 | 0.054 | 0.251 |  
	 | k1    | 289.61 | 244.26 | 0.322 | 0.65 | 0.016 | 0.254 |  
	-----------------------------------------------------------
 
Calculate hsal and beta: 
 1. for m2: done (CPU: 4.7203, Wall: 3.358)
 2. for k1: done (CPU: 4.4073, Wall: 2.714)
  Welcome to calc_dhat: Projecting: ******** done (CPU: 10.093, Wall: 10.093)
  Storing: ** done (CPU: 0.242, Wall: 0.244)
===>>> Total time spent on Iteration 2:  1:57.818 CPU, 34.049  Wall
==============
 Iteration 3
==============
 1. for m2: assembling the matrix and rhs, implementing b.c. 
   b) Factorization... done (1.7Gb).    c) Solve... done (CPU: 40.154, Wall: 5.346)
 2. for k1: assembling the matrix and rhs, implementing b.c. 
   b) Factorization... done (1.7Gb).    c) Solve... done (CPU: 40.323, Wall: 5.314)
	-----------------------------------------------------------
	 | Convg |   du  |   dv  |  duv% |  dh  | dhbar |  dh%  | 	
	 | ----- | ----- | ----- | ----- | ---- | ----- | ----- |  
	 | m2    | 43.98 | 65.10 | 0.089 | 1.03 | 0.021 | 0.085 |  
	 | k1    | 88.81 | 77.89 | 0.090 | 0.27 | 0.007 | 0.097 |  
	-----------------------------------------------------------
 
Calculate hsal and beta: 
 1. for m2: done (CPU: 4.6883, Wall: 3.27)
 2. for k1: done (CPU: 4.3583, Wall: 2.594)
  Welcome to calc_dhat: Projecting: ******** done (CPU: 9.967, Wall: 9.968)
  Storing: ** done (CPU: 0.241, Wall: 0.241)
===>>> Total time spent on Iteration 3:  1:59.252 CPU, 34.172  Wall
==============
 Iteration 4
==============
 1. for m2: assembling the matrix and rhs, implementing b.c. 
   b) Factorization... done (1.7Gb).    c) Solve... done (CPU: 40.566, Wall: 5.336)
 2. for k1: assembling the matrix and rhs, implementing b.c. 
   b) Factorization... done (1.7Gb).    c) Solve... done (CPU: 40.241, Wall: 5.317)
	-----------------------------------------------------------
	 | Convg |   du  |   dv  |  duv% |  dh  | dhbar |  dh%  | 	
	 | ----- | ----- | ----- | ----- | ---- | ----- | ----- |  
	 | m2    | 23.58 | 26.75 | 0.041 | 0.50 | 0.010 | 0.038 |  
	 | k1    | 28.01 | 24.45 | 0.039 | 0.11 | 0.003 | 0.043 |  
	-----------------------------------------------------------
 
Calculate hsal and beta: 
 1. for m2: done (CPU: 4.8833, Wall: 3.26)
 2. for k1: done (CPU: 4.0944, Wall: 2.628)
  Welcome to calc_dhat: Projecting: ******** done (CPU: 9.968, Wall: 9.970)
  Storing: ** done (CPU: 0.238, Wall: 0.239)
===>>> Total time spent on Iteration 4:  2:02.367 CPU, 33.539  Wall
==============
 Iteration 5
==============
 1. for m2: assembling the matrix and rhs, implementing b.c. 
   b) Factorization... done (1.7Gb).    c) Solve... done (CPU: 40.291, Wall: 5.311)
 2. for k1: assembling the matrix and rhs, implementing b.c. 
   b) Factorization... done (1.7Gb).    c) Solve... done (CPU: 40.427, Wall: 5.297)
	-----------------------------------------------------------
	 | Convg |   du  |   dv  |  duv% |  dh  | dhbar |  dh%  | 	
	 | ----- | ----- | ----- | ----- | ---- | ----- | ----- |  
	 | m2    | 12.29 | 10.62 | 0.019 | 0.26 | 0.004 | 0.017 |  
	 | k1    | 10.81 | 10.78 | 0.018 | 0.05 | 0.001 | 0.020 |  
	-----------------------------------------------------------
 
Calculate hsal and beta: 
 1. for m2: done (CPU: 4.9232, Wall: 3.233)
 2. for k1: done (CPU: 4.5303, Wall: 2.631)
  Welcome to calc_dhat: Projecting: ******** done (CPU: 9.970, Wall: 9.972)
  Storing: ** done (CPU: 0.241, Wall: 0.241)
===>>> Total time spent on Iteration 5:  1:56.320 CPU, 33.470  Wall
==============
 Iteration 6
==============
 1. for m2: assembling the matrix and rhs, implementing b.c. 
   b) Factorization... done (1.7Gb).    c) Solve... done (CPU: 40.302, Wall: 5.288)
 2. for k1: assembling the matrix and rhs, implementing b.c. 
   b) Factorization... done (1.7Gb).    c) Solve... done (CPU: 40.429, Wall: 5.333)
	-----------------------------------------------------------
	 | Convg |  du  |  dv  |  duv% |  dh  | dhbar |  dh%  | 	
	 | ----- | ---- | ---- | ----- | ---- | ----- | ----- |  
	 | m2    | 6.27 | 4.88 | 0.009 | 0.12 | 0.002 | 0.008 |  
	 | k1    | 4.68 | 4.29 | 0.009 | 0.02 | 0.001 | 0.010 |  
	-----------------------------------------------------------
 
Calculate hsal and beta: 
 1. for m2: done (CPU: 5.2482, Wall: 3.297)
 2. for k1: done (CPU: 4.2593, Wall: 2.631)
  Welcome to calc_dhat: Projecting: ******** done (CPU: 10.008, Wall: 10.012)
  Storing: ** done (CPU: 0.240, Wall: 0.242)
===>>> Total time spent on Iteration 6:  1:55.492 CPU, 33.583  Wall
==============
 Iteration 7
==============
 1. for m2: assembling the matrix and rhs, implementing b.c. 
   b) Factorization... done (1.7Gb).    c) Solve... done (CPU: 40.232, Wall: 5.303)
 2. for k1: assembling the matrix and rhs, implementing b.c. 
   b) Factorization... done (1.7Gb).    c) Solve... done (CPU: 40.630, Wall: 5.372)
	-----------------------------------------------------------
	 | Convg |  du  |  dv  |  duv% |  dh  | dhbar |  dh%  | 	
	 | ----- | ---- | ---- | ----- | ---- | ----- | ----- |  
	 | m2    | 3.17 | 2.40 | 0.004 | 0.06 | 0.001 | 0.004 |  
	 | k1    | 2.07 | 2.13 | 0.004 | 0.01 | 0.000 | 0.005 |  
	-----------------------------------------------------------
 
Calculate hsal and beta: 
 1. for m2: done (CPU: 5.2412, Wall: 3.289)
 2. for k1: done (CPU: 4.3964, Wall: 2.68)
  Welcome to calc_dhat: Projecting: ******** done (CPU: 9.973, Wall: 9.977)
  Storing: ** done (CPU: 0.240, Wall: 0.241)
===>>> Total time spent on Iteration 7:  1:54.658 CPU, 33.596  Wall
========================================================================
========================================================================
 
===>>> Total time spent on solving the system: 14:15.222 CPU, 4:10.654  Wall
 
-----------------------------------------------------------------------------
m2:	KE = 219.8 PJ, PE = 191.0 PJ, D = 2.722 TW.
	D_BL = 1.243 TW, D_IT = 1.473 TW, D_SAL = 0.003 GW, D_f = -0.041 GW.
	---------------------------------------------------------------------
	 | **** | Total | Shallow |  Deep | Coastal |  Open | 	
	 | ---- | ----- | ------- | ----- | ------- | ----- |  
	 | D_BL | 1.243 |  1.235  | 0.008 |  1.227  | 0.016 |  
	 | D_IT | 1.473 |  0.590  | 0.883 |  0.905  | 0.569 |  
	 | D    | 2.716 |  1.825  | 0.891 |  2.131  | 0.585 |  
-----------------------------------------------------------------------------
k1:	KE = 40.9 PJ, PE = 24.1 PJ, D = 0.329 TW.
	D_BL = 0.185 TW, D_IT = 0.145 TW, D_SAL = 0.001 GW, D_f = -0.400 GW.
	---------------------------------------------------------------------
	 | **** | Total | Shallow |  Deep | Coastal |  Open | 	
	 | ---- | ----- | ------- | ----- | ------- | ----- |  
	 | D_BL | 0.185 |  0.182  | 0.002 |  0.171  | 0.014 |  
	 | D_IT | 0.145 |  0.025  | 0.119 |  0.106  | 0.039 |  
	 | D    | 0.329 |  0.208  | 0.122 |  0.277  | 0.053 |  
 
===>>> Calculation of domain integrals: 29.388 CPU, 29.392  Wall
Cleaning up temporary files 
[H[2JSaving data as 2013_01_26__17_10
Loading topography file: /home/amt6/amtvl/Desktop/scratch/Tides/data/LAG/baro_fd/in/topo/nocs/topo_rot_2.0min_pole_15_-40.dat 
Interpolating topo to 15.00 min resolution global grid:  done.
****** Ocean is in the first/last tau index of H_hg. Removed ******
Removing bays and inlets: 1371 + 335 + 156 + 78 + 48 + 31 + 21 + 16 + 13 + 8 + 4 + 3 + 3 + 2 + 0.
Removing inland seas/lakes: found 26 connected components; removed 23 of size < 144 cells.
Smoothing topography for the linear ITD scheme: Loading topography file: /home/amt6/amtvl/Desktop/scratch/Tides/data/LAG/baro_fd/in/topo/nocs/smoothed_t1_trunc720_topo_rot_2.0min_pole_15_-40.dat 
done (CPU: 0.399, Wall: 0.400)
Allocating grid points: 679779 for u, 683462 for v, 675152  for h.
Making vectors: tau, H, evaluating on the u-, v-, h-grid (CPU: 0.1s, Wall:0.1s)
Making matrices:
 - d/dph and 1 for h-grid functions, evaluating on the u-grid (CPU: 0.1s, Wall:0.1s)
 - d/dta and 1 for h grid functions, evaluating on the v-grid (CPU: 0.1s, Wall:0.1s)
 - d/dph and 1 for u-grid functions, evaluating on the h-grid (CPU: 0.1s, Wall:0.1s)
 - d/dta and 1 for v-grid functions, evaluating on the h-grid (CPU: 0.1s, Wall:0.1s)
 - v & fv,     			     evaluating on the u-grid (CPU: 0.5s, Wall:0.5s)
 - u & fu,     			     evaluating on the v-grid (CPU: 0.5s, Wall:0.5s)
Saving matrices: done.
Preparing matrices: GHU, GHV, KU, KV, v2uf, u2vf, Linear BBL, Linear ITD (1 matrix per constituent), b.c. DONE
====================================
Welcome to baro_solver (nonlinear)
====================================
==============
 Iteration 1
==============
Have [2.04E+06 x 2.04E+06] sparse matrix (nnz = 1.28E+07). Solve with pardiso.
 1. for m2: assembling the matrix and rhs, implementing b.c. 
   a) Reordering... done (peak-1.5Gb; permanent-1.2Gb) 
      Size of matrix factors 1.7Gb < 20.0Gb RAM+Swap. Running in-core with peak memory usage: 3.0Gb.
   b) Factorization... done (1.7Gb).    c) Solve... done (CPU: 1:03.129, Wall: 12.211)
 2. for k1: assembling the matrix and rhs, implementing b.c. 
   b) Factorization... done (1.7Gb).    c) Solve... done (CPU: 39.512, Wall: 5.217)
	-----------------------------------------------------------
	 | Convg |   du   |   dv   |  duv%  |  dh  | dhbar |  dh%  | 	
	 | ----- | ------ | ------ | ------ | ---- | ----- | ----- |  
	 | m2    | 582.92 | 403.02 | 47.473 | 6.70 | 0.347 | 0.347 |  
	 | k1    | 751.92 | 647.88 | 14.170 | 2.93 | 0.101 | 0.101 |  
	-----------------------------------------------------------
  Welcome to calc_dhat: Projecting: ******** done (CPU: 9.984, Wall: 9.986)
  Storing: ** done (CPU: 0.258, Wall: 0.259)
===>>> Total time spent on Iteration 1:  2:01.916 CPU, 31.965  Wall
==============
 Iteration 2
==============
 1. for m2: assembling the matrix and rhs, implementing b.c. 
   b) Factorization... done (1.7Gb).    c) Solve... done (CPU: 39.936, Wall: 5.321)
 2. for k1: assembling the matrix and rhs, implementing b.c. 
   b) Factorization... done (1.7Gb).    c) Solve... done (CPU: 40.794, Wall: 5.409)
	-----------------------------------------------------------
	 | Convg |   du   |   dv   |  duv% |  dh  | dhbar |  dh%  | 	
	 | ----- | ------ | ------ | ----- | ---- | ----- | ----- |  
	 | m2    |  98.70 | 170.24 | 0.233 | 2.39 | 0.029 | 0.200 |  
	 | k1    | 246.73 | 224.21 | 0.232 | 0.62 | 0.008 | 0.144 |  
	-----------------------------------------------------------
  Welcome to calc_dhat: Projecting: ******** done (CPU: 9.983, Wall: 9.984)
  Storing: ** done (CPU: 0.239, Wall: 0.240)
===>>> Total time spent on Iteration 2:  1:40.516 CPU, 25.031  Wall
==============
 Iteration 3
==============
 1. for m2: assembling the matrix and rhs, implementing b.c. 
   b) Factorization... done (1.7Gb).    c) Solve... done (CPU: 40.016, Wall: 5.296)
 2. for k1: assembling the matrix and rhs, implementing b.c. 
   b) Factorization... done (1.7Gb).    c) Solve... done (CPU: 39.736, Wall: 5.243)
	-----------------------------------------------------------
	 | Convg |   du  |   dv  |  duv% |  dh  | dhbar |  dh%  | 	
	 | ----- | ----- | ----- | ----- | ---- | ----- | ----- |  
	 | m2    | 22.78 | 45.59 | 0.040 | 0.65 | 0.009 | 0.036 |  
	 | k1    | 77.69 | 68.78 | 0.047 | 0.16 | 0.002 | 0.042 |  
	-----------------------------------------------------------
  Welcome to calc_dhat: Projecting: ******** done (CPU: 9.968, Wall: 9.972)
  Storing: ** done (CPU: 0.240, Wall: 0.241)
===>>> Total time spent on Iteration 3:  1:37.851 CPU, 24.871  Wall
==============
 Iteration 4
==============
 1. for m2: assembling the matrix and rhs, implementing b.c. 
   b) Factorization... done (1.7Gb).    c) Solve... done (CPU: 39.874, Wall: 5.236)
 2. for k1: assembling the matrix and rhs, implementing b.c. 
   b) Factorization... done (1.7Gb).    c) Solve... done (CPU: 39.467, Wall: 5.216)
	-----------------------------------------------------------
	 | Convg |   du  |   dv  |  duv% |  dh  | dhbar |  dh%  | 	
	 | ----- | ----- | ----- | ----- | ---- | ----- | ----- |  
	 | m2    | 10.15 | 15.78 | 0.019 | 0.34 | 0.004 | 0.017 |  
	 | k1    | 26.48 | 23.66 | 0.018 | 0.05 | 0.001 | 0.015 |  
	-----------------------------------------------------------
  Welcome to calc_dhat: Projecting: ******** done (CPU: 10.014, Wall: 10.015)
  Storing: ** done (CPU: 0.240, Wall: 0.242)
===>>> Total time spent on Iteration 4:  1:38.358 CPU, 24.791  Wall
==============
 Iteration 5
==============
 1. for m2: assembling the matrix and rhs, implementing b.c. 
   b) Factorization... done (1.7Gb).    c) Solve... done (CPU: 39.694, Wall: 5.236)
 2. for k1: assembling the matrix and rhs, implementing b.c. 
   b) Factorization... done (1.7Gb).    c) Solve... done (CPU: 39.959, Wall: 5.238)
	-----------------------------------------------------------
	 | Convg |   du  |  dv  |  duv% |  dh  | dhbar |  dh%  | 	
	 | ----- | ----- | ---- | ----- | ---- | ----- | ----- |  
	 | m2    |  4.67 | 7.21 | 0.009 | 0.17 | 0.002 | 0.008 |  
	 | k1    | 10.92 | 9.99 | 0.008 | 0.03 | 0.000 | 0.006 |  
	-----------------------------------------------------------
  Welcome to calc_dhat: Projecting: ******** done (CPU: 9.974, Wall: 9.975)
  Storing: ** done (CPU: 0.239, Wall: 0.240)
===>>> Total time spent on Iteration 5:  1:39.708 CPU, 24.750  Wall
==============
 Iteration 6
==============
 1. for m2: assembling the matrix and rhs, implementing b.c. 
   b) Factorization... done (1.7Gb).    c) Solve... done (CPU: 39.252, Wall: 5.166)
 2. for k1: assembling the matrix and rhs, implementing b.c. 
   b) Factorization... done (1.7Gb).    c) Solve... done (CPU: 39.615, Wall: 5.252)
	-----------------------------------------------------------
	 | Convg |  du  |  dv  |  duv% |  dh  | dhbar |  dh%  | 	
	 | ----- | ---- | ---- | ----- | ---- | ----- | ----- |  
	 | m2    | 2.31 | 3.61 | 0.004 | 0.08 | 0.001 | 0.004 |  
	 | k1    | 4.85 | 4.52 | 0.004 | 0.02 | 0.000 | 0.002 |  
	-----------------------------------------------------------
  Welcome to calc_dhat: Projecting: ******** done (CPU: 9.976, Wall: 9.977)
  Storing: ** done (CPU: 0.240, Wall: 0.240)
===>>> Total time spent on Iteration 6:  1:38.692 CPU, 24.745  Wall
========================================================================
========================================================================
 
===>>> Total time spent on solving the system: 10:17.054 CPU, 2:36.167  Wall
 
-----------------------------------------------------------------------------
m2:	KE = 217.0 PJ, PE = 192.1 PJ, D = 3.255 TW.
	D_BL = 1.174 TW, D_IT = 2.075 TW, D_SAL = 0.000 GW, D_f = -0.031 GW.
	---------------------------------------------------------------------
	 | **** | Total | Shallow |  Deep | Coastal |  Open | 	
	 | ---- | ----- | ------- | ----- | ------- | ----- |  
	 | D_BL | 1.174 |  1.166  | 0.008 |  1.159  | 0.015 |  
	 | D_IT | 2.075 |  0.483  | 1.592 |  1.065  | 1.010 |  
	 | D    | 3.249 |  1.649  | 1.599 |  2.223  | 1.025 |  
-----------------------------------------------------------------------------
k1:	KE = 38.0 PJ, PE = 20.4 PJ, D = 0.351 TW.
	D_BL = 0.172 TW, D_IT = 0.180 TW, D_SAL = -0.000 GW, D_f = -0.440 GW.
	---------------------------------------------------------------------
	 | **** | Total | Shallow |  Deep | Coastal |  Open | 	
	 | ---- | ----- | ------- | ----- | ------- | ----- |  
	 | D_BL | 0.172 |  0.169  | 0.002 |  0.158  | 0.014 |  
	 | D_IT | 0.180 |  0.025  | 0.155 |  0.092  | 0.088 |  
	 | D    | 0.351 |  0.194  | 0.157 |  0.250  | 0.101 |  
 
===>>> Calculation of domain integrals: 29.402 CPU, 29.406  Wall
Cleaning up temporary files 
